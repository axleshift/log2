import{h as F,i as G,r,j as e,L as i,p as b}from"./index-DEmdhtkv.js";import{u as U,c as _}from"./index.esm-DrYYHZ6f.js";import{C as N}from"./index.esm-PQ4dROIH.js";import{F as V,j as q,k as D}from"./index-Dkr2Hnkf.js";import{R as W,V as z}from"./config-b0sta0FD.js";import{a as B,b as c}from"./CContainer-l_OEV5c6.js";import{C as h,a as t}from"./CRow-fCwqIY5j.js";import{C as Y}from"./CCardGroup-Cfpwbv_a.js";import{C as $,a as H}from"./CCardBody-D_V14yWh.js";import{C as J}from"./CAlert-DFda796J.js";import{C as K}from"./CForm-BvvF_kaV.js";import{C as S,a as R}from"./CInputGroupText-DGEqc-XL.js";import{c as M}from"./cil-user-Ddrdy7PS.js";import{C as L}from"./CFormInput-_fbGxJYO.js";import"./CCloseButton-B-4_Krdy.js";import"./CFormControlWrapper-CnvfyOx9.js";const ue=()=>{const k="https://backend-log2.axleshift.com/api/v1/auth",{register:f,handleSubmit:P,formState:{errors:a},reset:T}=U(),g=F(),{login:v}=G(),l=r.useRef(null),m=r.useRef(null),[o,j]=r.useState(!1),[d,n]=r.useState({message:"",type:""}),[y,E]=r.useState(!1);r.useEffect(()=>{l.current&&l.current.focus()},[]);const I=async p=>{j(!0),n({message:"",type:""});try{const u=await m.current.executeAsync();m.current.reset();const C=await fetch(`${k}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...p,recaptcha_ref:u})}),x=await C.json();if(console.log("Response Data:",x),!C.ok)throw new Error(x.message||"Login failed");const{accessToken:w,refreshToken:O,user:s}=x;v(s,w),b.set("token",w,{expires:1,secure:!0,sameSite:"Strict"}),b.set("refreshToken",O,{expires:30,secure:!0,sameSite:"Strict"}),n({message:"Welcome back! Redirecting to your dashboard...",type:"success"}),T(),s.role==="admin"||s.role==="super admin"?g("/dashboard"):s.role==="staff"||s.role==="buyer"||s.role==="staff"||s.role==="user"?g("/inventory"):n({message:"Unauthorized. You do not have admin access.",type:"danger"})}catch(u){n({message:u.message,type:"danger"})}finally{j(!1)}},A=()=>{E(p=>!p)};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsxs(B,{children:[e.jsx(W,{ref:m,size:"invisible",sitekey:z}),e.jsxs(h,{className:"justify-content-center",children:[e.jsxs(t,{md:4,className:"d-flex flex-column align-items-center justify-content-center bg-primary text-white",children:[e.jsx("h2",{children:"LOGIN PORTAL"}),e.jsx("p",{children:"Logistic Management System"}),e.jsx(i,{to:"/VendorLogin",className:"text-white",children:"Vendor Portal →"}),e.jsx(i,{to:"/",className:"text-white",children:"Landing Page →"})]}),e.jsx(t,{md:5,children:e.jsx(Y,{children:e.jsx($,{className:"p-4",children:e.jsxs(H,{children:[d.message&&e.jsx(J,{color:d.type,dismissible:!0,children:d.message}),e.jsxs(K,{onSubmit:P(I),children:[e.jsx("h1",{children:"Login"}),e.jsx("p",{className:"text-body-secondary",children:"Sign In to your account"}),e.jsxs(S,{className:"mb-3",children:[e.jsx(R,{children:e.jsx(N,{icon:M})}),e.jsx(L,{ref:l,type:"text",placeholder:"Username",autoComplete:"username",...f("username",{required:"Username is required"})})]}),a.username&&e.jsx("p",{className:"text-danger",children:a.username.message}),e.jsxs(S,{className:"mb-4",children:[e.jsx(R,{children:e.jsx(N,{icon:_})}),e.jsx(L,{type:y?"text":"password",placeholder:"Password",autoComplete:"current-password",...f("password",{required:"Password is required"})}),e.jsx(c,{color:"secondary",variant:"outline",onClick:A,type:"button",children:e.jsx(V,{icon:y?q:D})})]}),a.password&&e.jsx("p",{className:"text-danger",children:a.password.message}),e.jsxs(h,{children:[e.jsx(t,{sm:5,children:e.jsx(c,{color:"success",variant:"outline",className:"px-4",type:"submit",disabled:o,children:o?"Logging in...":"LOGIN"})}),e.jsx(t,{xs:"auto",className:"me-auto",children:e.jsx(i,{to:"/forgotPass",children:e.jsx(c,{color:"danger",variant:"outline",className:"px-4",disabled:o,children:o?"Processing...":"FORGOT PASSWORD"})})})]}),e.jsx(h,{className:"mt-3",children:e.jsx(t,{xs:12,className:"text-center",children:e.jsx(i,{to:"/register",children:e.jsx(c,{color:"link",className:"px-0",children:"Register Now!"})})})})]})]})})})})]})]})})};export{ue as default};
