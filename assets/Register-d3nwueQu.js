import{f as R,r as h,j as e}from"./index-DIuMn50O.js";import{u as P,c as g}from"./index.esm-CegFSc_L.js";import{p as d}from"./purify.es-CCJo14B2.js";import{C as p}from"./index.esm-C__UGevs.js";import{a as f}from"./js.cookie-CRA5wM0A.js";import{C as q,a as S}from"./CContainer-BB4SI4Be.js";import{C as U,a as A}from"./CRow-ptA_khgd.js";import{C as k,a as E}from"./CCardBody-WtYlQYQD.js";import{C as I}from"./CAlert-CpEiJNxq.js";import{C as L}from"./CForm-tcAnQ6iK.js";import{C as i,a as n}from"./CInputGroupText-BQ5MQS7t.js";import{c as T}from"./cil-user-Ddrdy7PS.js";import{C as m}from"./CFormInput-aTtMhUOR.js";import"./Transition-DtCpV_C4.js";function V(){const j="undefined/api/v1/auth",{register:t,handleSubmit:C,formState:{errors:a},watch:w,reset:y}=P(),b=R(),[u,x]=h.useState(!1),[c,l]=h.useState({message:"",type:""}),N=async s=>{const r=await fetch(`${j}/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!r.ok){const o=await r.json();throw new Error(o.message||"Registration failed. Please try again.")}return r.json()},v=async s=>{x(!0),l({message:"",type:""});try{const r={username:d.sanitize(s.username),email:d.sanitize(s.email),password:d.sanitize(s.password)},o=await N(r);f.set("token",o.accessToken,{expires:1}),f.set("refreshToken",o.refreshToken,{expires:1}),l({message:"Registration Successful! Redirecting...",type:"success"}),y(),setTimeout(()=>b("/login"),2e3)}catch(r){l({message:r.message,type:"danger"}),console.error("Registration Error:",r.message)}finally{x(!1)}};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(q,{children:e.jsx(U,{className:"justify-content-center",children:e.jsx(A,{md:9,lg:7,xl:6,children:e.jsx(k,{className:"mx-4",children:e.jsxs(E,{className:"p-4",children:[c.message&&e.jsx(I,{color:c.type,dismissible:!0,children:c.message}),e.jsxs(L,{onSubmit:C(v),children:[e.jsx("h1",{children:"Register"}),e.jsx("p",{className:"text-body-secondary",children:"Create your account"}),e.jsxs(i,{className:"mb-3",children:[e.jsx(n,{children:e.jsx(p,{icon:T})}),e.jsx(m,{type:"text",placeholder:"Username",autoComplete:"username",...t("username",{required:"Username is required",minLength:{value:3,message:"Username must be at least 3 characters"},maxLength:{value:20,message:"Username must not exceed 20 characters"},pattern:{value:/^[a-zA-Z0-9._-]+$/,message:"Invalid username format"}})})]}),a.username&&e.jsx("p",{className:"text-danger",children:a.username.message}),e.jsxs(i,{className:"mb-3",children:[e.jsx(n,{children:"@"}),e.jsx(m,{type:"email",placeholder:"Email",autoComplete:"email",...t("email",{required:"Email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Invalid email format"}})})]}),a.email&&e.jsx("p",{className:"text-danger",children:a.email.message}),e.jsxs(i,{className:"mb-3",children:[e.jsx(n,{children:e.jsx(p,{icon:g})}),e.jsx(m,{type:"password",placeholder:"Password",autoComplete:"new-password",...t("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"},validate:{hasUpperCase:s=>/[A-Z]/.test(s)||"At least one uppercase letter required",hasNumber:s=>/[0-9]/.test(s)||"At least one number required"}})})]}),a.password&&e.jsx("p",{className:"text-danger",children:a.password.message}),e.jsxs(i,{className:"mb-4",children:[e.jsx(n,{children:e.jsx(p,{icon:g})}),e.jsx(m,{type:"password",placeholder:"Repeat password",autoComplete:"new-password",...t("confirmPassword",{required:"Confirm Password is required",validate:s=>s===w("password")||"Passwords do not match"})})]}),a.confirmPassword&&e.jsx("p",{className:"text-danger",children:a.confirmPassword.message}),e.jsx("div",{className:"d-grid",children:e.jsx(S,{color:"success",type:"submit",disabled:u,children:u?"Creating Account...":"Create Account"})})]})]})})})})})})}export{V as default};
