import{r as l,_ as ue,a as o,j as H,F as X,b as $,c as T,P as u,u as me,R as e,C as he}from"./index-bZPy-u_X.js";import{a as C}from"./index-xsH4HHeE.js";import{C as pe,a as fe}from"./CCardBody-CLmlzVkW.js";import{C as ve}from"./CCardHeader-UqyFnKLe.js";import{C as Ee,a as ye}from"./CInputGroupText-QQ-FKc3l.js";import{C as p,c as ne,a as q}from"./CFormInput-R_GTD__T.js";import{c as g}from"./CRow-BsnqlO1m.js";import{g as be,h as ke,j as Q,k as S,l as Ce,m as E,c as Z,d as ee,n as te,e as ae,f as re}from"./CTable-CevkEJfF.js";import{u as ge}from"./CCloseButton-DSMc3Ee6.js";import{C as Se}from"./CForm-gky2dSTb.js";import{C as D}from"./CFormSelect-DJE4-La2.js";var U=l.forwardRef(function(r,B){var N=r.className,c=r.button,I=r.feedback,w=r.feedbackInvalid,M=r.feedbackValid,P=r.floatingLabel,O=r.tooltipFeedback,A=r.hitArea,f=r.id,y=r.indeterminate,V=r.inline,v=r.invalid,b=r.label,j=r.reverse,F=r.type,R=F===void 0?"checkbox":F,d=r.valid,L=ue(r,["className","button","feedback","feedbackInvalid","feedbackValid","floatingLabel","tooltipFeedback","hitArea","id","indeterminate","inline","invalid","label","reverse","type","valid"]),m=l.useRef(null),z=ge(B,m);l.useEffect(function(){m.current&&y&&(m.current.indeterminate=y)},[y,m.current]);var h=function(){return o("input",{...$({type:R,className:T(c?"btn-check":"form-check-input",{"is-invalid":v,"is-valid":d,"me-2":A}),id:f},L,{ref:z})})},a=function(){return o(ne,{describedby:L["aria-describedby"],feedback:I,feedbackInvalid:w,feedbackValid:M,floatingLabel:P,invalid:v,tooltipFeedback:O,valid:d})},s=function(){var x;return o(p,{...$({customClassName:T(c?T("btn",c.variant?"btn-".concat(c.variant,"-").concat(c.color):"btn-".concat(c.color),(x={},x["btn-".concat(c.size)]=c.size,x),"".concat(c.shape)):"form-check-label")},f&&{htmlFor:f}),children:b})},_=function(){return c?H(X,{children:[o(h,{}),b&&o(s,{}),o(a,{})]}):b?A?H(X,{children:[o(h,{}),o(p,{...$({customClassName:T("form-check-label stretched-link",N)},f&&{htmlFor:f}),children:b}),o(a,{})]}):H("div",{className:T("form-check",{"form-check-inline":V,"form-check-reverse":j,"is-invalid":v,"is-valid":d},N),children:[o(h,{}),o(s,{}),o(a,{})]}):o(h,{})};return o(_,{})});U.propTypes=$({button:u.object,className:u.string,hitArea:u.oneOf(["full"]),id:u.string,indeterminate:u.bool,inline:u.bool,label:u.oneOfType([u.string,u.node]),reverse:u.bool,type:u.oneOf(["checkbox","radio"])},ne.propTypes);U.displayName="CFormCheck";const G="https://backend-log2.axleshift.com",K=`${G}/api/v1/inventory`,Ne=`${G}/api/v1/shipment`,Ie=`${G}/api/v1/product`,we="https://backend-log1.axleshift.com/api/v1/warehouseLoc/locations",Ue=()=>{const{accessToken:r}=me(),[B,N]=l.useState(!1),[c,I]=l.useState(new Set),[w,M]=l.useState([]),[P,O]=l.useState([]),[A,f]=l.useState([]),[y,V]=l.useState([]),[v,b]=l.useState(""),[j,F]=l.useState(!1),[R,d]=l.useState(""),[L,m]=l.useState(!1),[z,h]=l.useState(!1),[a,s]=l.useState({shipment:"",warehouse_id:"",product:"",sku:"",quantity:"",stock_level:"",status:"In Stock"});l.useEffect(()=>{_(),x(),le(),ce()},[]);const _=async()=>{F(!0);try{const t=await C.get(K,{headers:{Authorization:`Bearer ${r}`}});M(Array.isArray(t.data)?t.data:[])}catch{d("Error fetching inventory data.")}finally{F(!1)}},x=async()=>{var t;try{const n=await C.get(Ne,{headers:{Authorization:`Bearer ${r}`}});O(((t=n.data)==null?void 0:t.shipments)||[])}catch{console.error("Failed to fetch shipments")}},le=async()=>{try{const t=await C.get(Ie,{headers:{Authorization:`Bearer ${r}`}});f(t.data||[])}catch{console.error("Failed to fetch products")}},ce=async()=>{var t;try{const n=await C.get(we,{headers:{"Content-Type":"application/json","x-api-key":"0ad3f5c013c42d2d0537672a260978c71dcd5a7d508019d748f991deee3d65665a477e3523c6bbc83fd6a51a71dd5003"}});V(((t=n.data)==null?void 0:t.data)||[])}catch(n){console.error("Failed to fetch warehouses",n)}},Y=l.useMemo(()=>w.filter(t=>{var n;return(((n=t.shipment)==null?void 0:n.tracking_id)||"").toLowerCase().includes(v.toLowerCase())}),[w,v]),oe=t=>{const n=t.target.checked;N(n),I(n?new Set(w.map(i=>i._id)):new Set)},se=(t,n)=>{const i=new Set(c);t.target.checked?i.add(n):i.delete(n),I(i)},ie=async()=>{if(!c.size)return d("Please select items to delete.");try{await Promise.all(Array.from(c).map(t=>C.delete(`${K}/${t}`,{headers:{Authorization:`Bearer ${r}`}}))),d("Selected items deleted successfully."),I(new Set),N(!1),_()}catch{d("Error deleting selected items.")}finally{m(!1)}},de=async t=>{var k,J;t.preventDefault();const n=W=>/^[a-f\d]{24}$/i.test(W);if(!n(a.shipment)||!n(a.product)||!n(a.warehouse_id))return d("Shipment, Product, and Warehouse must be valid ObjectIDs.");const i={...a,quantity:Number(a.quantity),stock_level:Number(a.stock_level)};try{await C.post(K,i,{headers:{Authorization:`Bearer ${r}`}}),d("New inventory item created."),s({shipment:"",warehouse_id:"",product:"",sku:"",quantity:"",stock_level:"",status:"In Stock"}),h(!1),_()}catch(W){d(((J=(k=W.response)==null?void 0:k.data)==null?void 0:J.error)||"Failed to create item.")}};return e.createElement(pe,null,e.createElement(ve,{className:"text-center py-3"},"Warehouse Inventory"),e.createElement(fe,null,R&&e.createElement("div",{className:"alert alert-info"},R),e.createElement("div",{className:"d-flex justify-content-between align-items-center mb-4"},e.createElement(Ee,{style:{maxWidth:"400px"}},e.createElement(ye,null,"Search"),e.createElement(q,{type:"text",placeholder:"Search by Tracking ID",value:v,onChange:t=>b(t.target.value)})),e.createElement("div",{className:"d-flex gap-2"},e.createElement(g,{color:"success",onClick:()=>{const i=`${`In-${Date.now()}`}-SKU`;s(k=>({...k,sku:i})),h(!0)}},"+ New Item"),e.createElement(g,{color:"danger",onClick:()=>m(!0)},"Delete"))),j?e.createElement("div",{className:"text-center py-5"},e.createElement(he,{color:"primary"})):e.createElement(be,{striped:!0,hover:!0,responsive:!0},e.createElement(ke,null,e.createElement(Q,null,e.createElement(S,null,e.createElement(U,{checked:B,onChange:oe})),e.createElement(S,null,"Tracking ID"),e.createElement(S,null,"Product"),e.createElement(S,null,"SKU"),e.createElement(S,null,"Quantity"),e.createElement(S,null,"Stock Level"))),e.createElement(Ce,null,Y.length>0?Y.map(t=>{var n,i;return e.createElement(Q,{key:t._id},e.createElement(E,null,e.createElement(U,{checked:c.has(t._id),onChange:k=>se(k,t._id)})),e.createElement(E,null,((n=t.shipment)==null?void 0:n.tracking_id)||"N/A"),e.createElement(E,null,((i=t.product)==null?void 0:i.name)||"N/A"),e.createElement(E,null,t.sku),e.createElement(E,null,t.quantity),e.createElement(E,null,t.stock_level))}):e.createElement(Q,null,e.createElement(E,{colSpan:"6",className:"text-center"},"No inventory records found."))))),e.createElement(Z,{visible:z,onClose:()=>h(!1)},e.createElement(ee,null,e.createElement(te,null,"New Inventory Item")),e.createElement(Se,{onSubmit:de},e.createElement(ae,null,e.createElement("div",{className:"mb-3"},e.createElement(p,null,"Shipment"),e.createElement(D,{value:a.shipment,onChange:t=>s({...a,shipment:t.target.value}),required:!0},e.createElement("option",{value:""},"Select Shipment"),Array.isArray(P)&&P.map(t=>e.createElement("option",{key:t._id,value:t._id},t.tracking_id||"Unnamed Shipment")))),e.createElement("div",{className:"mb-3"},e.createElement(p,null,"Product"),e.createElement(D,{value:a.product,onChange:t=>s({...a,product:t.target.value}),required:!0},e.createElement("option",{value:""},"Select Product"),Array.isArray(A)&&A.map(t=>e.createElement("option",{key:t._id,value:t._id},t.name||"Unnamed Product")))),e.createElement("div",{className:"mb-3"},e.createElement(p,null,"Warehouse"),e.createElement(D,{value:a.warehouse_id,onChange:t=>s({...a,warehouse_id:t.target.value}),required:!0},e.createElement("option",{value:""},"Select Warehouse"),Array.isArray(y)&&y.map(t=>e.createElement("option",{key:t._id,value:t._id},t.warehouseName," - ",t.address," ")))),e.createElement("div",{className:"mb-3"},e.createElement(p,null,"SKU"),e.createElement(q,{value:a.sku,onChange:t=>s({...a,sku:t.target.value}),required:!0})),e.createElement("div",{className:"mb-3"},e.createElement(p,null,"Quantity"),e.createElement(q,{type:"number",value:a.quantity,onChange:t=>s({...a,quantity:t.target.value}),required:!0})),e.createElement("div",{className:"mb-3"},e.createElement(p,null,"Stock Level"),e.createElement(q,{type:"number",value:a.stock_level,onChange:t=>s({...a,stock_level:t.target.value}),required:!0})),e.createElement("div",{className:`
              mb-3`},e.createElement(p,null,"Status"),e.createElement(D,{value:a.status,onChange:t=>s({...a,status:t.target.value})},e.createElement("option",{value:"In Stock"},"In Stock"),e.createElement("option",{value:"Out of Stock"},"Out of Stock")))),e.createElement(re,null,e.createElement(g,{color:"secondary",onClick:()=>h(!1)},"Cancel"),e.createElement(g,{color:"primary",type:"submit"},"Create")))),e.createElement(Z,{visible:L,onClose:()=>m(!1)},e.createElement(ee,null,e.createElement(te,null,"Confirm Deletion")),e.createElement(ae,null,"Are you sure you want to delete selected inventory items?"),e.createElement(re,null,e.createElement(g,{color:"secondary",onClick:()=>m(!1)},"Cancel"),e.createElement(g,{color:"danger",onClick:ie},"Delete"))))};export{Ue as default};
