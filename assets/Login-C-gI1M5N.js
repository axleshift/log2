import{i as F,k as G,r as a,R as e,L as c,q as b}from"./index-DQP8N3_v.js";import{u as U,c as _}from"./index.esm-CMTIqdlf.js";import{C as N}from"./index.esm-QyN5VXAl.js";import{F as V,q as j,r as D}from"./index-tOFcNw6a.js";import{R as W,V as z}from"./config-CwiX7Hiv.js";import{a as B,b as m}from"./CContainer-B5X986nK.js";import{C as g,a as s}from"./CRow-DRxYPhhI.js";import{C as Y}from"./CCardGroup-Dzn3TLo3.js";import{C as $,a as H}from"./CCardBody-DhxhUCKr.js";import{C as J}from"./CAlert-k6EoeMSe.js";import{C as K}from"./CForm-BS51HygJ.js";import{C as S,a as R}from"./CInputGroupText-BCgXY7_G.js";import{c as M}from"./cil-user-Ddrdy7PS.js";import{C as L}from"./CFormInput-DYRaArhy.js";import"./hoist-non-react-statics.cjs-DgYtMdXq.js";import"./CCloseButton-B0Lgjfr_.js";import"./CFormControlWrapper-BVBkIMxJ.js";const fe=()=>{const k="https://backend-log2.axleshift.com/api/v1/auth",{register:E,handleSubmit:P,formState:{errors:r},reset:T}=U(),y=F(),{login:v}=G(),l=a.useRef(null),i=a.useRef(null),[o,C]=a.useState(!1),[u,n]=a.useState({message:"",type:""}),[h,I]=a.useState(!1);a.useEffect(()=>{l.current&&l.current.focus()},[]);const A=async p=>{C(!0),n({message:"",type:""});try{const d=await i.current.executeAsync();i.current.reset();const x=await fetch(`${k}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...p,recaptcha_ref:d})}),f=await x.json();if(console.log("Response Data:",f),!x.ok)throw new Error(f.message||"Login failed");const{accessToken:w,refreshToken:q,user:t}=f;v(t,w),b.set("token",w,{expires:1,secure:!0,sameSite:"Strict"}),b.set("refreshToken",q,{expires:30,secure:!0,sameSite:"Strict"}),n({message:"Welcome back! Redirecting to your dashboard...",type:"success"}),T(),t.role==="admin"||t.role==="super admin"?y("/dashboard"):t.role==="staff"||t.role==="buyer"||t.role==="staff"||t.role==="user"?y("/inventory"):n({message:"Unauthorized. You do not have admin access.",type:"danger"})}catch(d){n({message:d.message,type:"danger"})}finally{C(!1)}},O=()=>{I(p=>!p)};return e.createElement("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center"},e.createElement(B,null,e.createElement(W,{ref:i,size:"invisible",sitekey:z}),e.createElement(g,{className:"justify-content-center"},e.createElement(s,{md:4,className:"d-flex flex-column align-items-center justify-content-center bg-primary text-white"},e.createElement("h2",null,"LOGIN PORTAL"),e.createElement("p",null,"Logistic Management System"),e.createElement(c,{to:"/VendorLogin",className:"text-white"},"Vendor Portal →"),e.createElement(c,{to:"/",className:"text-white"},"Landing Page →")),e.createElement(s,{md:5},e.createElement(Y,null,e.createElement($,{className:"p-4"},e.createElement(H,null,u.message&&e.createElement(J,{color:u.type,dismissible:!0},u.message),e.createElement(K,{onSubmit:P(A)},e.createElement("h1",null,"Login"),e.createElement("p",{className:"text-body-secondary"},"Sign In to your account"),e.createElement(S,{className:"mb-3"},e.createElement(R,null,e.createElement(N,{icon:M})),e.createElement(L,{ref:l,type:"text",placeholder:"Username",autoComplete:"username",...E("username",{required:"Username is required"})})),r.username&&e.createElement("p",{className:"text-danger"},r.username.message),e.createElement(S,{className:"mb-4"},e.createElement(R,null,e.createElement(N,{icon:_})),e.createElement(L,{type:h?"text":"password",placeholder:"Password",autoComplete:"current-password",...E("password",{required:"Password is required"})}),e.createElement(m,{color:"secondary",variant:"outline",onClick:O,type:"button"},e.createElement(V,{icon:h?j:D}))),r.password&&e.createElement("p",{className:"text-danger"},r.password.message),e.createElement(g,null,e.createElement(s,{sm:5},e.createElement(m,{color:"success",variant:"outline",className:"px-4",type:"submit",disabled:o},o?"Logging in...":"LOGIN")),e.createElement(s,{xs:"auto",className:"me-auto"},e.createElement(c,{to:"/forgotPass"},e.createElement(m,{color:"danger",variant:"outline",className:"px-4",disabled:o},o?"Processing...":"FORGOT PASSWORD")))),e.createElement(g,{className:"mt-3"},e.createElement(s,{xs:12,className:"text-center"},e.createElement(c,{to:"/register"},e.createElement(m,{color:"link",className:"px-0"},"Register Now!"))))))))))))};export{fe as default};
