import{k as v,r as c,R as e}from"./index-CQ5bThOo.js";import{C as A,a as b}from"./CRow-JJupQ2Xr.js";import{C as U,a as $}from"./CCardBody-40k0tZjq.js";import{C as k,a as w,b as p,c as l,d as _,e as n}from"./CTable-CF2NB-O5.js";import{b as f}from"./CContainer-ezbfUEXV.js";const u="https://backend-log2.axleshift.com/api/v1/auth",N=()=>{const{accessToken:r}=v(),[d,i]=c.useState([]),[C,g]=c.useState(!0),[E,o]=c.useState(null);c.useEffect(()=>{if(!r)return;(async()=>{try{const a=await fetch(`${u}/users`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}});if(!a.ok)throw new Error(`HTTP error! Status: ${a.status}`);const s=await a.json();i(Array.isArray(s.users)?s.users:[])}catch(a){console.error("Error fetching users:",a),i([])}finally{g(!1)}})()},[r]);const h=(t,a)=>{i(s=>s.map(m=>m._id===t?{...m,status:a}:m))},y=async t=>{if(r){o(t);try{const a=await fetch(`${u}/approve/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}});a.ok?h(t,"Approved"):console.error("Error approving user",a.statusText)}catch(a){console.error("Error approving user:",a)}finally{o(null)}}},T=async t=>{if(r){o(t);try{const a=await fetch(`${u}/cancel-approval/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}});a.ok?h(t,"Pending"):console.error("Error canceling approval:",a.statusText)}catch(a){console.error("Error canceling approval:",a)}finally{o(null)}}};return e.createElement(e.Fragment,null,e.createElement(A,null,e.createElement(b,{xs:"12"},e.createElement(U,null,e.createElement($,null,e.createElement("h4",null,"User Management"),C?e.createElement("div",null,"Loading..."):e.createElement(k,{striped:!0,bordered:!0,hover:!0,responsive:!0},e.createElement(w,null,e.createElement(p,null,e.createElement(l,null,"User ID"),e.createElement(l,null,"Role"),e.createElement(l,null,"Email"),e.createElement(l,null,"Status"),e.createElement(l,null,"Actions"))),e.createElement(_,null,d.length>0?d.map(t=>e.createElement(p,{key:t._id},e.createElement(n,null,t._id),e.createElement(n,null,(t==null?void 0:t.role)||"N/A"),e.createElement(n,null,t.email),e.createElement(n,null,t.status),e.createElement(n,null,t.status==="Approved"?e.createElement(f,{color:"warning",onClick:()=>T(t._id),className:"ml-2",disabled:E===t._id},"Cancel Approval"):e.createElement(f,{color:"success",onClick:()=>y(t._id),className:"ml-2",disabled:E===t._id},"Approve")))):e.createElement(p,null,e.createElement(n,{colSpan:"5",className:"text-center"},"No users found.")))))))))};export{N as default};
