import{l as G,u as U,r as a,R as e,L as c,v as b}from"./index-4l8YDPMt.js";import{u as _,c as q}from"./index.esm-Bxh7esc4.js";import{C as N}from"./index.esm-CTaOn0oS.js";import{F as V,q as j,r as D}from"./index-Cl-k4Ybk.js";import{R as W,V as z}from"./config-PxV-qocK.js";import{d as B,a as g,b as s,c as l}from"./CRow-Dstcvhhn.js";import{C as Y}from"./CCardGroup-C-WqGLnF.js";import{C as $,a as H}from"./CCardBody-DYN-5Bvl.js";import{C as J}from"./CAlert-D1awv8uF.js";import{C as K}from"./CForm-BlATjbC-.js";import{C as S,a as R}from"./CInputGroupText-B1u8TW26.js";import{c as M}from"./cil-user-Ddrdy7PS.js";import{a as L}from"./CFormInput-5eZtoBd3.js";import"./hoist-non-react-statics.cjs-Cr8gcv_S.js";import"./CCloseButton-CN5zlj3N.js";const pe=()=>{const k="https://backend-log2.axleshift.com/api/v1/auth",{register:E,handleSubmit:P,formState:{errors:r},reset:v}=_(),y=G(),{login:T}=U(),m=a.useRef(null),i=a.useRef(null),[o,h]=a.useState(!1),[u,n]=a.useState({message:"",type:""}),[C,I]=a.useState(!1);a.useEffect(()=>{m.current&&m.current.focus()},[]);const A=async p=>{h(!0),n({message:"",type:""});try{const d=await i.current.executeAsync();i.current.reset();const x=await fetch(`${k}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...p,recaptcha_ref:d})}),f=await x.json();if(console.log("Response Data:",f),!x.ok)throw new Error(f.message||"Login failed");const{accessToken:w,refreshToken:F,user:t}=f;T(t,w),b.set("token",w,{expires:1,secure:!0,sameSite:"Strict"}),b.set("refreshToken",F,{expires:30,secure:!0,sameSite:"Strict"}),n({message:"Welcome back! Redirecting to your dashboard...",type:"success"}),v(),t.role==="admin"||t.role==="super admin"?y("/dashboard"):t.role==="staff"||t.role==="buyer"||t.role==="staff"||t.role==="user"?y("/inventory"):n({message:"Unauthorized. You do not have admin access.",type:"danger"})}catch(d){n({message:d.message,type:"danger"})}finally{h(!1)}},O=()=>{I(p=>!p)};return e.createElement("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center"},e.createElement(B,null,e.createElement(W,{ref:i,size:"invisible",sitekey:z}),e.createElement(g,{className:"justify-content-center"},e.createElement(s,{md:4,className:"d-flex flex-column align-items-center justify-content-center bg-primary text-white"},e.createElement("h2",null,"LOGIN PORTAL"),e.createElement("p",null,"Logistic Management System"),e.createElement(c,{to:"/VendorLogin",className:"text-white"},"Vendor Portal →"),e.createElement(c,{to:"/",className:"text-white"},"Landing Page →")),e.createElement(s,{md:5},e.createElement(Y,null,e.createElement($,{className:"p-4"},e.createElement(H,null,u.message&&e.createElement(J,{color:u.type,dismissible:!0},u.message),e.createElement(K,{onSubmit:P(A)},e.createElement("h1",null,"Login"),e.createElement("p",{className:"text-body-secondary"},"Sign In to your account"),e.createElement(S,{className:"mb-3"},e.createElement(R,null,e.createElement(N,{icon:M})),e.createElement(L,{ref:m,type:"text",placeholder:"Username",autoComplete:"username",...E("username",{required:"Username is required"})})),r.username&&e.createElement("p",{className:"text-danger"},r.username.message),e.createElement(S,{className:"mb-4"},e.createElement(R,null,e.createElement(N,{icon:q})),e.createElement(L,{type:C?"text":"password",placeholder:"Password",autoComplete:"current-password",...E("password",{required:"Password is required"})}),e.createElement(l,{color:"secondary",variant:"outline",onClick:O,type:"button"},e.createElement(V,{icon:C?j:D}))),r.password&&e.createElement("p",{className:"text-danger"},r.password.message),e.createElement(g,null,e.createElement(s,{sm:5},e.createElement(l,{color:"success",variant:"outline",className:"px-4",type:"submit",disabled:o},o?"Logging in...":"LOGIN")),e.createElement(s,{xs:"auto",className:"me-auto"},e.createElement(c,{to:"/forgotPass"},e.createElement(l,{color:"danger",variant:"outline",className:"px-4",disabled:o},o?"Processing...":"FORGOT PASSWORD")))),e.createElement(g,{className:"mt-3"},e.createElement(s,{xs:12,className:"text-center"},e.createElement(c,{to:"/register"},e.createElement(l,{color:"link",className:"px-0"},"Register Now!"))))))))))))};export{pe as default};
