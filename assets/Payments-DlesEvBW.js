import{r,j as e,C as M}from"./index-B9rQ-kmE.js";import{C as h,a as m}from"./CCardBody-Dywmzwhl.js";import{C as x}from"./CCardHeader-C6ZKMTzh.js";import{C as D}from"./CTable-DFh1XnVU.js";import{b as a}from"./CContainer-DdWdpS7d.js";import{f,g as C,j as v,k as b}from"./CNavItem-DMaIUZz7.js";import{C as F}from"./CForm-Bi1jMJNo.js";import{C as l}from"./CFormInput-DeJQvQXs.js";import"./CCloseButton-r9Y6HIOX.js";import"./CFormControlWrapper-Bjgrupxp.js";const U=()=>{const[g,j]=r.useState([]),[P,S]=r.useState(!0),[u,p]=r.useState(null),[w,c]=r.useState(!1),[E,d]=r.useState(!1),[t,i]=r.useState(null);r.useEffect(()=>{(async()=>{try{const n=await fetch("https://backend-log2.axleshift.com/api/v1/payments");if(!n.ok)throw new Error("Failed to fetch payments");const o=await n.json();j(o)}catch(n){p(n.message)}finally{S(!1)}})()},[]);const N=s=>{i(s),c(!0)},V=s=>{i(s),d(!0)},k=async s=>{s.preventDefault();try{const n=await fetch(`https://backend-log2.axleshift.com/api/v1/payments/${t._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({paymentId:t.paymentId,amount:t.amount,status:t.status})});if(!n.ok)throw new Error("Failed to update payment");const o=await n.json();j(I=>I.map(y=>y._id===o._id?o:y)),d(!1)}catch(n){p(n.message)}};return P?e.jsxs(h,{children:[e.jsx(x,{children:"Payments"}),e.jsxs(m,{className:"text-center",children:[e.jsx(M,{color:"primary"}),e.jsx("p",{children:"Loading payments..."})]})]}):u?e.jsxs(h,{children:[e.jsx(x,{children:"Payments"}),e.jsx(m,{className:"text-center text-danger",children:e.jsxs("p",{children:["Error: ",u]})})]}):e.jsxs(h,{children:[e.jsx(x,{children:"Payments"}),e.jsx(m,{children:e.jsxs(D,{bordered:!0,hover:!0,responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Payment ID"}),e.jsx("th",{children:"Amount"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Vendor"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:g.map((s,n)=>e.jsxs("tr",{children:[e.jsx("td",{children:n+1}),e.jsx("td",{children:s.paymentId}),e.jsxs("td",{children:["$",s.amount]}),e.jsx("td",{children:s.status}),e.jsx("td",{children:s.vendor?s.vendor.name:"No vendor assigned"}),e.jsxs("td",{children:[e.jsx(a,{color:"info",onClick:()=>N(s),children:"View"}),e.jsx(a,{color:"warning",className:"ms-2",onClick:()=>V(s),children:"Edit"})]})]},s._id))})]})}),e.jsxs(f,{visible:w,onClose:()=>c(!1),children:[e.jsx(C,{children:"Payment Details"}),e.jsx(v,{children:t&&e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Payment ID:"})," ",t.paymentId]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Amount:"})," $",t.amount]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",t.status]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Vendor:"})," ",t.vendor?t.vendor.name:"No vendor assigned"]})," "]})}),e.jsx(b,{children:e.jsx(a,{color:"secondary",onClick:()=>c(!1),children:"Close"})})]}),e.jsxs(f,{visible:E,onClose:()=>d(!1),children:[e.jsx(C,{children:"Edit Payment"}),e.jsx(v,{children:t&&e.jsxs(F,{onSubmit:k,children:[e.jsx("div",{className:"mb-3",children:e.jsx(l,{type:"text",label:"Payment ID",value:t.paymentId,disabled:!0})}),e.jsx("div",{className:"mb-3",children:e.jsx(l,{type:"number",label:"Amount",value:t.amount,onChange:s=>i({...t,amount:s.target.value})})}),e.jsx("div",{className:"mb-3",children:e.jsx(l,{type:"text",label:"Status",value:t.status,onChange:s=>i({...t,status:s.target.value})})}),e.jsx("div",{className:"mb-3",children:e.jsx(l,{type:"text",label:"Vendor",value:t.vendor?t.vendor.name:"No vendor assigned",disabled:!0})}),e.jsxs(b,{children:[e.jsx(a,{color:"secondary",onClick:()=>d(!1),children:"Cancel"}),e.jsx(a,{type:"submit",color:"primary",children:"Save Changes"})]})]})})]})]})};export{U as default};
