import{f as A,r as s,j as e,L as p,g as j}from"./index-yeD2k8LS.js";import{u as F,c as O}from"./index.esm-LYHXrFLs.js";import{C}from"./index.esm-BMN100-7.js";import{F as _,d as G,e as U}from"./index-CfiUF4Nh.js";import{R as q,V}from"./config-pAWTZbkP.js";import{C as D,a as u}from"./CContainer-Cc_TBAJl.js";import{C as y,a}from"./CRow-zcBxoxhf.js";import{C as W}from"./CCardGroup-CjA-H70s.js";import{C as B,a as $}from"./CCardBody-PxKnXAH0.js";import{C as z}from"./CAlert-Wo6FvfzX.js";import{C as H}from"./CForm-_anPUM5P.js";import{C as w,a as b}from"./CInputGroupText-B8TA-x7u.js";import{c as J}from"./cil-user-Ddrdy7PS.js";import{C as S}from"./CFormInput-Ci4Lz4ea.js";import"./CCloseButton-Z9Co6YUO.js";import"./Transition-D4-jAIgO.js";const me=()=>{const N="https://backend-log2.axleshift.com/api/v1/auth",{register:x,handleSubmit:R,formState:{errors:r},reset:P}=F(),k=A(),o=s.useRef(null),n=s.useRef(null),[t,h]=s.useState(!1),[i,c]=s.useState({message:"",type:""}),[f,L]=s.useState(!1);s.useEffect(()=>{o.current&&o.current.focus()},[]);const T=async l=>{h(!0),c({message:"",type:""});try{const m=await n.current.executeAsync();n.current.reset();const g=await fetch(`${N}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...l,recaptcha_ref:m})}),d=await g.json();if(console.log("Response Data:",d),!g.ok)throw new Error(d.message||"Login failed");const{accessToken:I,refreshToken:v}=d;j.set("token",I,{expires:1,secure:!0,sameSite:"Strict"}),j.set("refreshToken",v,{expires:30,secure:!0}),c({message:"Welcome back! Redirecting to your dashboard...",type:"success"}),P(),setTimeout(()=>k("/dashboard"),2e3)}catch(m){c({message:m.message,type:"danger"})}finally{h(!1)}},E=()=>{L(l=>!l)};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsxs(D,{children:[e.jsx(q,{ref:n,size:"invisible",sitekey:V}),e.jsxs(y,{className:"justify-content-center",children:[e.jsxs(a,{md:4,className:"d-flex flex-column align-items-center justify-content-center bg-primary text-white",children:[e.jsx("h2",{children:"Vendor Portal"}),e.jsx("p",{children:"Logistic Management System"}),e.jsx(p,{to:"/supplierslogin",className:"text-white",children:"Supplier Page →"}),e.jsx(p,{to:"/",className:"text-white",children:"Landing Page →"})]}),e.jsx(a,{md:5,children:e.jsx(W,{children:e.jsx(B,{className:"p-4",children:e.jsxs($,{children:[i.message&&e.jsx(z,{color:i.type,dismissible:!0,children:i.message}),e.jsxs(H,{onSubmit:R(T),children:[e.jsx("h1",{children:"Login"}),e.jsx("p",{className:"text-body-secondary",children:"Sign In to your account"}),e.jsxs(w,{className:"mb-3",children:[e.jsx(b,{children:e.jsx(C,{icon:J})}),e.jsx(S,{ref:o,type:"text",placeholder:"Username",autoComplete:"username",...x("username",{required:"Username is required"})})]}),r.username&&e.jsx("p",{className:"text-danger",children:r.username.message}),e.jsxs(w,{className:"mb-4",children:[e.jsx(b,{children:e.jsx(C,{icon:O})}),e.jsx(S,{type:f?"text":"password",placeholder:"Password",autoComplete:"current-password",...x("password",{required:"Password is required"})}),e.jsx(u,{color:"secondary",variant:"outline",onClick:E,type:"button",children:e.jsx(_,{icon:f?G:U})})]}),r.password&&e.jsx("p",{className:"text-danger",children:r.password.message}),e.jsxs(y,{children:[e.jsx(a,{sm:5,children:e.jsx(u,{color:"success",variant:"outline",className:"px-4",type:"submit",disabled:t,children:t?"Logging in...":"LOGIN"})}),e.jsx(a,{xs:"auto",className:"me-auto",children:e.jsx(p,{to:"/forgotPass",children:e.jsx(u,{color:"danger",variant:"outline",className:"px-4",disabled:t,children:t?"Processing...":"FORGOT PASSWORD"})})})]})]})]})})})})]})]})})};export{me as default};
