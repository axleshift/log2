import{u as q,r as l,R as e,C as M,L as $}from"./index-BuyPBthV.js";import{a as g}from"./index-xsH4HHeE.js";import{C as H,a as V}from"./CCardBody-DIlEFv7M.js";import{C as P}from"./CCardHeader-2ZxsisFQ.js";import{C as F}from"./CAlert-84ht7EJA.js";import{g as U,h as z,j as T,k as o,l as j,m as i,c as O,d as W,e as Y,f as G}from"./CTable-JDSNWlXE.js";import{c as u,a as Q,b as d}from"./CRow-DtAWSn5d.js";import{C as R,a as J}from"./CFormInput-CSoJADs1.js";import{C as K}from"./CFormTextarea-DPO3OWN6.js";import{a as X,b as Z,c as ee,d as te}from"./DefaultLayout-CV3HAylT.js";import"./CCloseButton-CxYk9sGR.js";import"./CFormSelect-QU3Ik6FC.js";import"./CForm-Dno9JkwL.js";import"./index.esm-DJigi3oJ.js";import"./cil-user-Ddrdy7PS.js";import"./index-LnCWbWn0.js";const S="https://backend-log2.axleshift.com",ae=`${S}/api/v1/rfq`,re=`${S}/api/v1/vendor-quotes`,ge=()=>{var y;const{accessToken:n}=q(),[p,v]=l.useState([]),[w,N]=l.useState(!0),[E,x]=l.useState(null),[A,C]=l.useState([]),[D,c]=l.useState(!1),[m,f]=l.useState({price:"",details:""}),[s,k]=l.useState(null),b=(t,r="success")=>{C(a=>[...a,{id:Date.now(),message:t,color:r}]),setTimeout(()=>C(a=>a.slice(1)),4e3)},B=async()=>{var t,r;try{const a=await g.get(`${ae}/vendor/rfqs`,{headers:{Authorization:`Bearer ${n}`}});v(a.data.rfqs||[]),console.log("Fetched RFQs:",a.data.rfqs)}catch(a){console.error("Failed to fetch RFQs:",a),x(((r=(t=a.response)==null?void 0:t.data)==null?void 0:r.message)||"Failed to load RFQs.")}finally{N(!1)}};l.useEffect(()=>{n&&B()},[n]);const L=t=>{k(t),f({price:"",details:""}),c(!0)},h=t=>{const{name:r,value:a}=t.target;f(I=>({...I,[r]:a}))},_=async t=>{if(t.preventDefault(),!!s)try{await g.post(re,{rfqId:s._id,price:m.price,details:m.details},{headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}}),c(!1),b("Quote submitted!")}catch(r){console.error(r),b("Failed to submit quote","danger")}};return e.createElement(H,{className:"shadow-sm"},e.createElement(P,{className:"bg-primary text-white fw-bold"},"Your RFQs"),e.createElement(V,null,w?e.createElement("div",{className:"text-center my-3"},e.createElement(M,{color:"primary"})):E?e.createElement(F,{color:"danger",className:"text-center"},E):p.length===0?e.createElement(F,{color:"warning",className:"text-center"},"No RFQs available."):e.createElement(U,{striped:!0,hover:!0,responsive:!0},e.createElement(z,{color:"light"},e.createElement(T,null,e.createElement(o,null,"#"),e.createElement(o,null,"Title"),e.createElement(o,null,"Due Date"),e.createElement(o,null,"Action"))),e.createElement(j,null,p.map((t,r)=>{var a;return e.createElement(T,{key:t._id},e.createElement(o,null,r+1),e.createElement(i,null,((a=t.procurementId)==null?void 0:a.title)||"N/A"),e.createElement(i,null,t.deadline?new Date(t.deadline).toLocaleDateString():"N/A"),e.createElement(i,null,e.createElement($,{to:`/vendor/rfqs/${t._id}`,className:"btn btn-sm btn-primary me-2"},"View Details"),e.createElement(u,{color:"success",size:"sm",onClick:()=>L(t)},"Submit Quote")))})))),e.createElement(O,{visible:D,onClose:()=>c(!1)},e.createElement(W,null,"Submit Quote for ",((y=s==null?void 0:s.procurementId)==null?void 0:y.title)||"RFQ"),e.createElement(Y,null,e.createElement("form",{onSubmit:_},e.createElement(Q,{className:"mb-3"},e.createElement(d,{md:6},e.createElement(R,null,"Price"),e.createElement(J,{name:"price",type:"number",value:m.price,onChange:h,required:!0})),e.createElement(d,{md:6},e.createElement(R,null,"Details"),e.createElement(K,{name:"details",value:m.details,onChange:h}))),e.createElement(Q,{className:"text-center"},e.createElement(d,null,e.createElement(u,{color:"primary",type:"submit"},"Submit Quote"))))),e.createElement(G,null,e.createElement(u,{color:"secondary",onClick:()=>c(!1)},"Cancel"))),e.createElement(X,{placement:"top-end"},A.map(t=>e.createElement(Z,{key:t.id,autohide:!0,visible:!0,color:t.color},e.createElement(ee,{closeButton:!0},t.color==="success"?"âœ… Success":"ðŸš¨ Error"),e.createElement(te,null,t.message)))))};export{ge as default};
