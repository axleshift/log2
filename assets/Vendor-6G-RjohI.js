import{i as U,r as a,j as e,P as V}from"./index-DEmdhtkv.js";import{C as S,a as R}from"./CRow-fCwqIY5j.js";import{C as v,a as y}from"./CCardBody-D_V14yWh.js";import{C as _,a as B,b as u,c as h,d as F,e as c}from"./CTable-DNInGac6.js";import{b as l,a as D}from"./CContainer-l_OEV5c6.js";import{f as L,g as H,h as z,j as q,k as G}from"./CNavItem-8rHQpnzQ.js";import{C as $}from"./CCardHeader-DibV801G.js";import{C as w}from"./CForm-BvvF_kaV.js";import{C as A}from"./CFormControlWrapper-CnvfyOx9.js";import{C as I}from"./CFormInput-_fbGxJYO.js";import"./CCloseButton-B-4_Krdy.js";const g="https://backend-log2.axleshift.com/api/v1/auth",J=()=>{const{accessToken:n}=U(),[o,d]=a.useState([]),[x,j]=a.useState(!0),[C,t]=a.useState(!1),[i,E]=a.useState(null),[b,p]=a.useState(null);a.useEffect(()=>{if(!n)return;(async()=>{try{const s=await fetch(`${g}/users`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}});if(!s.ok)throw new Error(`HTTP error! Status: ${s.status}`);const m=await s.json();d(Array.isArray(m.users)?m.users:[])}catch(s){console.error("Error fetching users:",s),d([])}finally{j(!1)}})()},[n]);const T=(r,s)=>{d(m=>m.map(f=>f._id===r?{...f,status:s}:f))},M=async r=>{if(n){p(r);try{const s=await fetch(`${g}/approve/${r}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}});s.ok?T(r,"Approved"):console.error("Error approving user",s.statusText)}catch(s){console.error("Error approving user:",s)}finally{p(null)}}},N=async r=>{if(n){p(r);try{const s=await fetch(`${g}/cancel-approval/${r}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}});s.ok?T(r,"Pending"):console.error("Error canceling approval:",s.statusText)}catch(s){console.error("Error canceling approval:",s)}finally{p(null)}}},P=r=>{E(r),t(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(S,{children:e.jsx(R,{xs:"12",children:e.jsx(v,{children:e.jsxs(y,{children:[e.jsx("h4",{children:"Vendor Management"}),x?e.jsx("div",{children:"Loading..."}):e.jsxs(_,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[e.jsx(B,{children:e.jsxs(u,{children:[e.jsx(h,{children:"User ID"}),e.jsx(h,{children:"Name"}),e.jsx(h,{children:"Email"}),e.jsx(h,{children:"Status"}),e.jsx(h,{children:"Actions"})]})}),e.jsx(F,{children:o.length>0?o.map(r=>e.jsxs(u,{children:[e.jsx(c,{children:r._id}),e.jsx(c,{children:(r==null?void 0:r.name)||"N/A"}),e.jsx(c,{children:r.email}),e.jsx(c,{children:r.status}),e.jsxs(c,{children:[e.jsx(l,{color:"info",onClick:()=>P(r),children:"View Details"}),r.status==="Approved"?e.jsx(l,{color:"warning",onClick:()=>N(r._id),className:"ml-2",disabled:b===r._id,children:"Cancel Approval"}):e.jsx(l,{color:"success",onClick:()=>M(r._id),className:"ml-2",disabled:b===r._id,children:"Approve"})]})]},r._id)):e.jsx(u,{children:e.jsx(c,{colSpan:"5",className:"text-center",children:"No users found."})})})]})]})})})}),e.jsxs(L,{visible:C,onClose:()=>t(!1),children:[e.jsx(H,{onClose:()=>t(!1),children:e.jsx(z,{children:"User Details"})}),e.jsx(q,{children:i&&e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"User ID:"})," ",i._id]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",(i==null?void 0:i.name)||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",i.email]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",i.status]})]})}),e.jsx(G,{children:e.jsx(l,{color:"secondary",onClick:()=>t(!1),children:"Close"})})]})]})},k=({vendorId:n})=>{const[o,d]=a.useState(""),[x,j]=a.useState(""),C=()=>{console.log(`Rating for vendor ${n}: ${o}`),console.log(`Review for vendor ${n}: ${x}`)};return e.jsxs(v,{children:[e.jsx($,{children:"Vendor Profile"}),e.jsxs(y,{children:[e.jsxs(w,{children:[e.jsx(A,{htmlFor:"rating",children:"Rating"}),e.jsx(I,{type:"number",id:"rating",value:o,onChange:t=>d(t.target.value),min:"1",max:"5"})]}),e.jsxs(w,{children:[e.jsx(A,{htmlFor:"review",children:"Review"}),e.jsx("textarea",{id:"review",rows:"4",value:x,onChange:t=>j(t.target.value),className:"form-control"})]}),e.jsx(l,{color:"primary",onClick:C,children:"Submit Rating & Review"})]})]})};k.propTypes={vendorId:V.string.isRequired};const ae=()=>{const[n,o]=a.useState("vendorManagement");return e.jsx(D,{children:e.jsx(S,{className:"mb-3",children:e.jsx(R,{children:e.jsxs(v,{children:[e.jsxs($,{children:[e.jsx(l,{color:n==="vendorManagement"?"primary":"secondary",onClick:()=>o("vendorManagement"),className:"ms-2",children:"Vendor Management"}),e.jsx(l,{color:n==="vendorProfile"?"primary":"secondary",onClick:()=>o("vendorProfile"),className:"ms-2",children:"Vendor Profile"})]}),e.jsx(y,{children:n==="vendorManagement"?e.jsx(J,{}):e.jsx(k,{})})]})})})})};export{ae as default};
