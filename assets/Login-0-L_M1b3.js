import{f as F,r,j as e,L as c}from"./index-B8kCwtGV.js";import{u as O,c as G}from"./index.esm-mFx59yxY.js";import{C as j}from"./index.esm-4b7MesSj.js";import{F as U,d as q,e as H}from"./index-BY-m-lGQ.js";import{a as C}from"./js.cookie-CjXG54Hc.js";import{C as B,a as l}from"./CContainer-v_4zzpW7.js";import{C as y,a as t}from"./CRow-C3rkp-Ap.js";import{C as D}from"./CCardGroup-Cj1pwTyl.js";import{C as V,a as W}from"./CCardBody-2rm0LrJz.js";import{C as _}from"./CAlert-OE-PsB_q.js";import{C as $}from"./CForm-ChgHawWX.js";import{C as w,a as b}from"./CInputGroupText-xMj50WpP.js";import{c as J}from"./cil-user-Ddrdy7PS.js";import{C as N}from"./CFormInput-DTfERUsz.js";import"./Transition-S4DeDhou.js";function ce(){const S="undefined/api/v1/auth",{register:u,handleSubmit:k,formState:{errors:o},reset:P}=O(),L=F(),x=r.useRef(null),[n,d]=r.useState(!1),[m,i]=r.useState({message:"",type:""}),[h,T]=r.useState(!1),[p,g]=r.useState(null),f=r.useCallback(async()=>{try{const s=await window.grecaptcha.execute(void 0,{action:"login"});g(s)}catch(s){console.error("Error executing reCAPTCHA:",s)}},[]);r.useEffect(()=>{var s;window.grecaptcha?window.grecaptcha.ready(()=>{f()}):console.error("reCAPTCHA is not loaded properly."),(s=x.current)==null||s.focus()},[f]);const R=async s=>{if(d(!0),i({message:"",type:""}),!p){i({message:"Please complete the reCAPTCHA",type:"danger"}),d(!1);return}try{const a=await fetch(`${S}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...s,recaptchaToken:p})});if(!a.ok){const I=await a.json();throw new Error(I.message||"Login failed")}const{accessToken:v,refreshToken:E}=await a.json();C.set("token",v,{expires:1,secure:!0}),C.set("refreshToken",E,{expires:1,secure:!0}),i({message:"Welcome back! Redirecting to your dashboard...",type:"success"}),P(),setTimeout(()=>L("/dashboard"),2e3)}catch(a){i({message:a.message,type:"danger"})}finally{d(!1),g(null)}},A=()=>{T(s=>!s)};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(B,{children:e.jsxs(y,{className:"justify-content-center",children:[e.jsxs(t,{md:4,className:"d-flex flex-column align-items-center justify-content-center bg-primary text-white",children:[e.jsx("h2",{children:"Vendor Portal"}),e.jsx("p",{children:"Logistic Management System"}),e.jsx(c,{to:"/",className:"text-white",children:"Landing page →"}),e.jsx(c,{to:"/supplierslogin",className:"text-white",children:"Supplier Login →"})]}),e.jsx(t,{md:5,children:e.jsx(D,{children:e.jsx(V,{className:"p-4",children:e.jsxs(W,{children:[m.message&&e.jsx(_,{color:m.type,dismissible:!0,children:m.message}),e.jsxs($,{onSubmit:k(R),children:[e.jsx("h1",{children:"Login"}),e.jsx("p",{className:"text-body-secondary",children:"Sign In to your account"}),e.jsxs(w,{className:"mb-3",children:[e.jsx(b,{children:e.jsx(j,{icon:J})}),e.jsx(N,{ref:x,type:"text",placeholder:"Username",autoComplete:"username",...u("username",{required:"Username is required"})})]}),o.username&&e.jsx("p",{className:"text-danger",children:o.username.message}),e.jsxs(w,{className:"mb-4",children:[e.jsx(b,{children:e.jsx(j,{icon:G})}),e.jsx(N,{type:h?"text":"password",placeholder:"Password",autoComplete:"current-password",...u("password",{required:"Password is required"})}),e.jsx(l,{color:"secondary",variant:"outline",onClick:A,type:"button",children:e.jsx(U,{icon:h?q:H})})]}),o.password&&e.jsx("p",{className:"text-danger",children:o.password.message}),e.jsxs(y,{children:[e.jsx(t,{sm:5,children:e.jsx(l,{color:"success",variant:"outline",className:"px-4",type:"submit",disabled:n||!p,children:n?"Logging in...":"LOGIN"})}),e.jsx(t,{xs:"auto",className:"me-auto",children:e.jsx(c,{to:"/forgotPass",children:e.jsx(l,{color:"danger",variant:"outline",className:"px-4",disabled:n,children:n?"Processing...":"FORGOT PASSWORD"})})}),e.jsx(t,{xs:4,children:e.jsx(c,{to:"/register",children:e.jsx(l,{color:"link",className:"px-0",children:"Register Now!"})})})]})]})]})})})})]})})})}export{ce as default};
