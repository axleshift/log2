import{i as _,r as a,j as e,C as B,P as F}from"./index-B9rQ-kmE.js";import{C as N,a as R}from"./CRow-BN1XSdcy.js";import{C as g,a as v}from"./CCardBody-Dywmzwhl.js";import{C as D,a as H,b as u,c as m,d as L,e as c}from"./CTable-DFh1XnVU.js";import{b as i,a as z}from"./CContainer-DdWdpS7d.js";import{f as q,g as G,h as I,j as J,k as K}from"./CNavItem-DMaIUZz7.js";import{C as A}from"./CCardHeader-C6ZKMTzh.js";import{C as T}from"./CForm-Bi1jMJNo.js";import{C as S}from"./CFormControlWrapper-Bjgrupxp.js";import{C as O}from"./CFormInput-DeJQvQXs.js";import"./CCloseButton-r9Y6HIOX.js";const f="https://backend-log2.axleshift.com/api/v1/auth",Q=()=>{const{accessToken:n}=_(),[o,d]=a.useState([]),[x,j]=a.useState(!0),[C,t]=a.useState(!1),[l,k]=a.useState(null),[y,p]=a.useState(null);a.useEffect(()=>{if(!n)return;(async()=>{try{const r=await fetch(`${f}/users`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}});if(!r.ok)throw new Error(`HTTP error! Status: ${r.status}`);const h=(await r.json()).users.filter(U=>U.role==="vendor");d(h)}catch(r){console.error("Error fetching users:",r),d([])}finally{j(!1)}})()},[n]);const b=(s,r)=>{d(w=>w.map(h=>h._id===s?{...h,status:r}:h))},E=async s=>{if(n){p(s);try{const r=await fetch(`${f}/approve/${s}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}});r.ok?b(s,"Approved"):console.error("Error approving user",r.statusText)}catch(r){console.error("Error approving user:",r)}finally{p(null)}}},M=async s=>{if(n){p(s);try{const r=await fetch(`${f}/cancel-approval/${s}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}});r.ok?b(s,"Pending"):console.error("Error canceling approval:",r.statusText)}catch(r){console.error("Error canceling approval:",r)}finally{p(null)}}},P=s=>{k(s),t(!0)},V=s=>{switch(s){case"Approved":return"success";case"Pending":return"warning";default:return"secondary"}};return e.jsxs(e.Fragment,{children:[e.jsx(N,{children:e.jsx(R,{xs:"12",children:e.jsx(g,{className:"shadow-lg",children:e.jsxs(v,{children:[e.jsx("h4",{className:"text-primary",children:"Vendor Management"}),x?e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(B,{color:"primary"})}):e.jsxs(D,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[e.jsx(H,{className:"bg-light",children:e.jsxs(u,{children:[e.jsx(m,{children:"User ID"}),e.jsx(m,{children:"Email"}),e.jsx(m,{children:"Status"}),e.jsx(m,{children:"Role"}),e.jsx(m,{children:"Actions"})]})}),e.jsx(L,{children:o.length>0?o.map(s=>e.jsxs(u,{className:"text-center",children:[e.jsx(c,{children:s._id}),e.jsx(c,{children:s.email}),e.jsx(c,{children:e.jsx(i,{color:V(s.status),className:"mr-2",children:s.status})}),e.jsx(c,{children:s.role}),e.jsxs(c,{children:[e.jsx(i,{color:"info",onClick:()=>P(s),className:"mr-2",children:"View Details"}),s.status==="Approved"?e.jsx(i,{color:"warning",onClick:()=>M(s._id),className:"ml-2",disabled:y===s._id,children:"Cancel Approval"}):e.jsx(i,{color:"success",onClick:()=>E(s._id),className:"ml-2",disabled:y===s._id,children:"Approve"})]})]},s._id)):e.jsx(u,{children:e.jsx(c,{colSpan:"5",className:"text-center",children:"No vendors found."})})})]})]})})})}),e.jsxs(q,{visible:C,onClose:()=>t(!1),className:"bg-light",children:[e.jsx(G,{onClose:()=>t(!1),children:e.jsx(I,{children:"User Details"})}),e.jsx(J,{children:l&&e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"User ID:"})," ",l._id]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",(l==null?void 0:l.name)||"N/A"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",l.email]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",l.status]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Role:"})," ",l.role]})]})}),e.jsx(K,{children:e.jsx(i,{color:"secondary",onClick:()=>t(!1),children:"Close"})})]})]})},$=({vendorId:n})=>{const[o,d]=a.useState(""),[x,j]=a.useState(""),C=()=>{console.log(`Rating for vendor ${n}: ${o}`),console.log(`Review for vendor ${n}: ${x}`)};return e.jsxs(g,{children:[e.jsx(A,{children:"Vendor Profile"}),e.jsxs(v,{children:[e.jsxs(T,{children:[e.jsx(S,{htmlFor:"rating",children:"Rating"}),e.jsx(O,{type:"number",id:"rating",value:o,onChange:t=>d(t.target.value),min:"1",max:"5"})]}),e.jsxs(T,{children:[e.jsx(S,{htmlFor:"review",children:"Review"}),e.jsx("textarea",{id:"review",rows:"4",value:x,onChange:t=>j(t.target.value),className:"form-control"})]}),e.jsx(i,{color:"primary",onClick:C,children:"Submit Rating & Review"})]})]})};$.propTypes={vendorId:F.string.isRequired};const le=()=>{const[n,o]=a.useState("vendorManagement");return e.jsx(z,{children:e.jsx(N,{className:"mb-3",children:e.jsx(R,{children:e.jsxs(g,{children:[e.jsxs(A,{children:[e.jsx(i,{color:n==="vendorManagement"?"primary":"secondary",onClick:()=>o("vendorManagement"),className:"ms-2",children:"Vendor Management"}),e.jsx(i,{color:n==="vendorProfile"?"primary":"secondary",onClick:()=>o("vendorProfile"),className:"ms-2",children:"Vendor Profile"})]}),e.jsx(v,{children:n==="vendorManagement"?e.jsx(Q,{}):e.jsx($,{})})]})})})})};export{le as default};
