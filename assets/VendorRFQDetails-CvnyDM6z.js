import{R as e,P as l,y as z,k as H,r as m,z as O,C as w}from"./index-CQ5bThOo.js";import{a as F}from"./index-C88pvD_q.js";import{C as V,a as j,b as Y,c as _}from"./CModalHeader-BjwXGJ0z.js";import{C as G}from"./CModalTitle-Bz2Qne-t.js";import{C as J}from"./CForm-CgwFVwc3.js";import{C as E}from"./CFormInput-C2PVtSjy.js";import{C as K}from"./CFormTextarea-zLRXAeMj.js";import{b}from"./CContainer-ezbfUEXV.js";import{C as W,a as X}from"./CCardBody-40k0tZjq.js";import{C as Z}from"./CCardHeader-o14WNGm5.js";import{C as x}from"./CAlert-BpDF-SVL.js";import{C as D}from"./DefaultLayout-Ce1NCKt0.js";import{C as P,a as k,b as u,c as n,d as A,e as r}from"./CTable-CF2NB-O5.js";import"./CCloseButton-Bt_Fn3tX.js";import"./CNavItem-8e7SXcnn.js";import"./CFormControlWrapper-BsUibFdB.js";import"./index.esm-RoxhmY7x.js";import"./cil-user-Ddrdy7PS.js";import"./index-DUVNt038.js";const U=({visible:d,onClose:s,quote:t,onChange:o,onSubmit:p})=>e.createElement(V,{visible:d,onClose:s},e.createElement(j,null,e.createElement(G,null,"Submit Your Quote")),e.createElement(Y,null,e.createElement(J,null,e.createElement(E,{type:"number",label:"Total Price",name:"totalPrice",value:t.totalPrice,onChange:o,placeholder:"Enter the total price",required:!0}),e.createElement(E,{type:"number",label:"Quantity",name:"quantity",value:t.quantity,onChange:o,placeholder:"Enter the quantity",required:!0}),e.createElement(E,{type:"text",label:"Lead Time",name:"leadTime",value:t.leadTime,onChange:o,placeholder:"Enter lead time (e.g., 3 days, 1 week)",required:!0}),e.createElement(K,{label:"Terms",name:"terms",value:t.terms,onChange:o,rows:"3",placeholder:"Enter terms and conditions (optional)"}),e.createElement(E,{type:"date",label:"Valid Until",name:"validUntil",value:t.validUntil,onChange:o,placeholder:"Enter validity date"}))),e.createElement(_,null,e.createElement(b,{color:"secondary",onClick:s},"Cancel"),e.createElement(b,{color:"primary",onClick:p},"Submit Quote")));U.propTypes={visible:l.bool.isRequired,onClose:l.func.isRequired,quote:l.shape({totalPrice:l.oneOfType([l.string,l.number]).isRequired,quantity:l.oneOfType([l.string,l.number]).isRequired,leadTime:l.string.isRequired,terms:l.string,validUntil:l.string}).isRequired,onChange:l.func.isRequired,onSubmit:l.func.isRequired};const ge=()=>{var T,N,q,Q,R,S;const{id:d}=z(),{accessToken:s}=H(),[t,o]=m.useState(null),[p,g]=m.useState(!0),[h,y]=m.useState(!1),[v,B]=m.useState(null),{showToast:C}=O(),[M,f]=m.useState(!1),[c,L]=m.useState({totalPrice:"",quantity:"",leadTime:"",terms:"",validUntil:"",status:"Pending"});m.useEffect(()=>{s&&(async()=>{g(!0);try{const i=await F.get(`https://backend-log2.axleshift.com/api/v1/rfq/vendor/rfqs/${d}`,{headers:{Authorization:`Bearer ${s}`}});o(i.data)}catch{B("Failed to load RFQ details.")}finally{g(!1)}})()},[d,s]);const I=a=>{L({...c,[a.target.name]:a.target.value})},$=async()=>{if(!c.totalPrice||!c.quantity||!c.leadTime){C("Please fill in all required fields.","warning");return}try{y(!0),await F.post(`https://backend-log2.axleshift.com/api/v1/rfq/vendor/rfqs/${d}/submit-quote`,{...c,quoteDate:new Date},{headers:{Authorization:`Bearer ${s}`}}),f(!1),y(!1),C("Quote submitted successfully!","success")}catch{y(!1),C("Failed to submit quote.","error")}};return e.createElement(W,{className:"shadow-sm"},e.createElement(Z,{className:"bg-primary text-white fw-bold"},"RFQ Details"),e.createElement(X,null,p?e.createElement("div",{className:"text-center my-3"},e.createElement(w,{color:"primary"})):v?e.createElement(x,{color:"danger",className:"text-center"},v):t?e.createElement(e.Fragment,null,e.createElement("div",{className:"row mb-3"},e.createElement("div",{className:"col-md-6"},e.createElement("strong",null,"RFQ ID:")," ",t._id),e.createElement("div",{className:"col-md-6"},e.createElement("strong",null,"Title:")," ",((T=t.procurementId)==null?void 0:T.title)||"N/A"),e.createElement("div",{className:"col-md-6"},e.createElement("strong",null,"Description:")," ",((N=t.procurementId)==null?void 0:N.description)||"No description available"),e.createElement("div",{className:"col-md-6"},e.createElement("strong",null,"Status:"),e.createElement(D,{color:t.status==="Open"?"success":t.status==="Closed"?"danger":"warning"},t.status)),e.createElement("div",{className:"col-md-6"},e.createElement("strong",null,"Requested By:")," ",((q=t==null?void 0:t.requestedBy)==null?void 0:q.email)||((R=(Q=t==null?void 0:t.procurementId)==null?void 0:Q.requestedBy)==null?void 0:R.email)||"Unknown"),e.createElement("div",{className:"col-md-6"},e.createElement("strong",null,"Created At:")," ",new Date(t.createdAt).toLocaleDateString())),e.createElement("hr",null),e.createElement("h6",null,e.createElement("strong",null,"Items")),e.createElement(P,{hover:!0,responsive:!0,className:"text-center"},e.createElement(k,null,e.createElement(u,null,e.createElement(n,null,"Name"),e.createElement(n,null,"Quantity"),e.createElement(n,null,"Unit"))),e.createElement(A,null,((S=t.products)==null?void 0:S.length)>0?t.products.map((a,i)=>e.createElement(u,{key:i},e.createElement(r,null,a.name||"No name"),e.createElement(r,null,a.quantity||"N/A"),e.createElement(r,null,a.unit||"No Unit"))):e.createElement(u,null,e.createElement(r,{colSpan:"3",className:"text-center"},"No products listed")))),e.createElement("h6",null,e.createElement("strong",null,"Submitted Quotes")),e.createElement(P,{hover:!0,responsive:!0,className:"text-center"},e.createElement(k,null,e.createElement(u,null,e.createElement(n,null,"Total Price"),e.createElement(n,null,"Quantity"),e.createElement(n,null,"Lead Time"),e.createElement(n,null,"Terms"),e.createElement(n,null,"Valid Until"),e.createElement(n,null,"Status"))),e.createElement(A,null,t.quotes.length>0?t.quotes.map((a,i)=>e.createElement(u,{key:i},e.createElement(r,null,a.totalPrice),e.createElement(r,null,a.quantity),e.createElement(r,null,a.leadTime),e.createElement(r,null,a.terms||"N/A"),e.createElement(r,null,a.validUntil?new Date(a.validUntil).toLocaleDateString():"N/A"),e.createElement(r,null,e.createElement(D,{color:a.status==="Approved"?"success":a.status==="Rejected"?"danger":"warning"},a.status)))):e.createElement(u,null,e.createElement(r,{colSpan:"6"},"No quotes submitted yet.")))),e.createElement(b,{color:"primary",className:"mt-3",onClick:()=>f(!0),disabled:h},h?e.createElement(w,{size:"sm"}):"Submit Quote"),e.createElement(U,{visible:M,onClose:()=>f(!1),quote:c,onChange:I,onSubmit:$})):e.createElement(x,{color:"warning",className:"text-center"},"RFQ not found.")))};export{ge as default};
