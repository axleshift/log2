import{f as I,r,j as e,L as c}from"./index-B-y3a7i-.js";import{u as F,c as O}from"./index.esm-DD30oAf2.js";import{C as g}from"./index.esm-BBab7waK.js";import{F as G,d as U,e as q}from"./index-CzhDQk5V.js";import{a as f}from"./js.cookie-B56kYh2S.js";import{C as H,a as l}from"./CContainer-CDgFUBwA.js";import{C as j,a as t}from"./CRow-mlugrclD.js";import{C as B}from"./CCardGroup-_qgFgZkK.js";import{C as D,a as V}from"./CCardBody-6EWUojyx.js";import{C as W}from"./CAlert-DL3-M9ku.js";import{C as _}from"./CForm-VV7my2id.js";import{C,a as y}from"./CInputGroupText-BkGzxSm2.js";import{c as $}from"./cil-user-Ddrdy7PS.js";import{C as w}from"./CFormInput-Q9dl8uM-.js";import"./Transition-BcjTVNeL.js";function ie(){const N="undefined/api/v1/auth",{register:h,handleSubmit:b,formState:{errors:o},reset:S}=F(),k=I(),[n,d]=r.useState(!1),[m,i]=r.useState({message:"",type:""}),[x,P]=r.useState(!1),[p,u]=r.useState(null),L=async()=>{try{const s=await window.grecaptcha.execute(void 0,{action:"login"});u(s)}catch(s){console.error("Error executing reCAPTCHA:",s)}};r.useEffect(()=>{window.grecaptcha?window.grecaptcha.ready(()=>{window.grecaptcha.execute(void 0,{action:"login"}).then(L)}):console.error("reCAPTCHA is not loaded properly.")},[]);const T=async s=>{if(d(!0),i({message:"",type:""}),!p){i({message:"Please complete the reCAPTCHA",type:"danger"}),d(!1);return}try{const a=await fetch(`${N}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...s,recaptchaToken:p})});if(!a.ok){const E=await a.json();throw new Error(E.message||"Login failed")}const{accessToken:A,refreshToken:R}=await a.json();f.set("token",A,{expires:1}),f.set("refreshToken",R,{expires:1}),i({message:"Welcome back! Redirecting to your dashboard...",type:"success"}),S(),setTimeout(()=>k("/dashboard"),2e3)}catch(a){i({message:a.message,type:"danger"})}finally{d(!1),u(null)}},v=()=>{P(s=>!s)};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(H,{children:e.jsxs(j,{className:"justify-content-center",children:[e.jsxs(t,{md:4,className:"d-flex flex-column align-items-center justify-content-center bg-primary text-white",children:[e.jsx("h2",{children:"Vendor Portal"}),e.jsx("p",{children:"Logistic Management System"}),e.jsx(c,{to:"/",className:"text-white",children:"Landing page →"}),e.jsx(c,{to:"/supplierslogin",className:"text-white",children:"Supplier Login →"})]}),e.jsx(t,{md:5,children:e.jsx(B,{children:e.jsx(D,{className:"p-4",children:e.jsxs(V,{children:[m.message&&e.jsx(W,{color:m.type,dismissible:!0,children:m.message}),e.jsxs(_,{onSubmit:b(T),children:[e.jsx("h1",{children:"Login"}),e.jsx("p",{className:"text-body-secondary",children:"Sign In to your account"}),e.jsxs(C,{className:"mb-3",children:[e.jsx(y,{children:e.jsx(g,{icon:$})}),e.jsx(w,{type:"text",placeholder:"Username",autoComplete:"username",...h("username",{required:"Username is required"})})]}),o.username&&e.jsx("p",{className:"text-danger",children:o.username.message}),e.jsxs(C,{className:"mb-4",children:[e.jsx(y,{children:e.jsx(g,{icon:O})}),e.jsx(w,{type:x?"text":"password",placeholder:"Password",autoComplete:"current-password",...h("password",{required:"Password is required"})}),e.jsx(l,{color:"secondary",variant:"outline",onClick:v,type:"button",children:e.jsx(G,{icon:x?U:q})})]}),o.password&&e.jsx("p",{className:"text-danger",children:o.password.message}),e.jsx("div",{className:"mb-3",children:e.jsx("div",{className:"g-recaptcha","data-sitekey":void 0})}),e.jsxs(j,{children:[e.jsx(t,{sm:5,children:e.jsx(l,{color:"success",variant:"outline",className:"px-4",type:"submit",disabled:n||!p,children:n?"Logging in...":"LOGIN"})}),e.jsx(t,{xs:"auto",className:"me-auto",children:e.jsx(c,{to:"/forgotPass",children:e.jsx(l,{color:"danger",variant:"outline",className:"px-4",disabled:n,children:n?"Processing...":"FORGOT PASSWORD"})})}),e.jsx(t,{xs:4,children:e.jsx(c,{to:"/register",children:e.jsx(l,{color:"link",className:"px-0",children:"Register Now!"})})})]})]})]})})})})]})})})}export{ie as default};
