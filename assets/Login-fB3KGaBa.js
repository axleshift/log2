import{l as U,u as _,r as t,R as e,L as E,v as b}from"./index-DZfE5c-b.js";import{u as G,c as j}from"./index.esm-CPcD-Fb2.js";import{C as N}from"./index.esm-Bvm-VaJ5.js";import{F as q,o as D,p as V}from"./index-Tvh2umWT.js";import{R as W,V as z}from"./config-DMRjlg6e.js";import{d as B,a as g,b as s,c}from"./CRow-DcJW25wv.js";import{C as Y}from"./CCardGroup-mDRBUxyw.js";import{C as $,a as H}from"./CCardBody-CJbgDnbm.js";import{C as J}from"./CAlert-CA819VF8.js";import{C as K}from"./CForm-D8cqiWRb.js";import{C as S,a as R}from"./CInputGroupText-Da5vdMZu.js";import{c as M}from"./cil-user-Ddrdy7PS.js";import{a as k}from"./CFormInput-eY5Z5ntw.js";import"./hoist-non-react-statics.cjs-D4UjX0xW.js";import"./CCloseButton-BehUEh2q.js";const pe=()=>{const L="https://backend-log2.axleshift.com/api/v1/auth",{register:y,handleSubmit:v,formState:{errors:r},reset:P}=G(),l=U(),{login:T}=_(),m=t.useRef(null),i=t.useRef(null),[o,h]=t.useState(!1),[u,n]=t.useState({message:"",type:""}),[C,I]=t.useState(!1);t.useEffect(()=>{m.current&&m.current.focus()},[]);const A=async p=>{h(!0),n({message:"",type:""});try{const d=await i.current.executeAsync();i.current.reset();const x=await fetch(`${L}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...p,recaptcha_ref:d})}),f=await x.json();if(console.log("Response Data:",f),!x.ok)throw new Error(f.message||"Login failed");const{accessToken:w,refreshToken:F,user:a}=f;T(a,w),b.set("token",w,{expires:1,secure:!0,sameSite:"Strict"}),b.set("refreshToken",F,{expires:30,secure:!0,sameSite:"Strict"}),n({message:"Welcome back! Redirecting to your dashboard...",type:"success"}),P(),a.role==="admin"||a.role==="super admin"?l("/dashboard"):a.role==="staff"?l("/procurement"):a.role==="vendor"?l("/inventory"):n({message:"Unauthorized. You do not have admin access.",type:"danger"})}catch(d){n({message:d.message,type:"danger"})}finally{h(!1)}},O=()=>{I(p=>!p)};return e.createElement("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center"},e.createElement(B,null,e.createElement(W,{ref:i,size:"invisible",sitekey:z}),e.createElement(g,{className:"justify-content-center"},e.createElement(s,{md:4,className:"d-flex flex-column align-items-center justify-content-center bg-primary text-white"},e.createElement("h2",null,"VENDOR PORTAL"),e.createElement("p",null,"Logistic Management System"),e.createElement(E,{to:"/",className:"text-white"},"Landing Page â†’")),e.createElement(s,{md:5},e.createElement(Y,null,e.createElement($,{className:"p-4"},e.createElement(H,null,u.message&&e.createElement(J,{color:u.type,dismissible:!0},u.message),e.createElement(K,{onSubmit:v(A)},e.createElement("h1",null,"Login"),e.createElement("p",{className:"text-body-secondary"},"Sign In to your account"),e.createElement(S,{className:"mb-3"},e.createElement(R,null,e.createElement(N,{icon:M})),e.createElement(k,{ref:m,type:"text",placeholder:"Username",autoComplete:"username",...y("username",{required:"Username is required"})})),r.username&&e.createElement("p",{className:"text-danger"},r.username.message),e.createElement(S,{className:"mb-4"},e.createElement(R,null,e.createElement(N,{icon:j})),e.createElement(k,{type:C?"text":"password",placeholder:"Password",autoComplete:"current-password",...y("password",{required:"Password is required"})}),e.createElement(c,{color:"secondary",variant:"outline",onClick:O,type:"button"},e.createElement(q,{icon:C?D:V}))),r.password&&e.createElement("p",{className:"text-danger"},r.password.message),e.createElement(g,null,e.createElement(s,{sm:5},e.createElement(c,{color:"success",variant:"outline",className:"px-4",type:"submit",disabled:o},o?"Logging in...":"LOGIN")),e.createElement(s,{xs:"auto",className:"me-auto"},e.createElement(E,{to:"/forgotPass"},e.createElement(c,{color:"danger",variant:"outline",className:"px-4",disabled:o},o?"Processing...":"FORGOT PASSWORD")))),e.createElement(g,{className:"mt-3"},e.createElement(s,{xs:12,className:"text-center"},e.createElement(E,{to:"/register"},e.createElement(c,{color:"link",className:"px-0"},"Register Now!"))))))))))))};export{pe as default};
