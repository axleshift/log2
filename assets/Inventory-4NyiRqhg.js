import{u as ne,r as n,R as e,C as le}from"./index-CZbhyFiD.js";import{a as i}from"./index-xsH4HHeE.js";import{C as se,a as ce}from"./CCardBody-D6vwvdO3.js";import{C as oe}from"./CCardHeader-x-t8Qtni.js";import{C as ue,a as me}from"./CInputGroupText-Cogig_Dh.js";import{a as v,C as o}from"./CFormInput-Di6goj5o.js";import{c as d}from"./CRow-DAWJ6kQb.js";import{g as ie,h as de,j as w,k as h,l as he,m as u,c as L,d as U,n as B,e as F,f as M}from"./CTable-CR8nuKb2.js";import{C as W}from"./CFormCheck-BWxTSkeY.js";import{C as pe}from"./CForm-BM-D2erR.js";import{C as f}from"./CFormSelect-D4tEM1WW.js";import"./CCloseButton-BPwTVHYG.js";const A="https://backend-log2.axleshift.com",I=`${A}/api/v1/inventory`,Ee=`${A}/api/v1/shipment`,ye=`${A}/api/v1/product`,Ce="https://backend-log1.axleshift.com/api/v1/warehouseLoc/locations",qe=()=>{const{accessToken:p}=ne(),[O,N]=n.useState(!1),[E,S]=n.useState(new Set),[k,z]=n.useState([]),[P,H]=n.useState([]),[q,j]=n.useState([]),[x,Q]=n.useState([]),[g,V]=n.useState(""),[K,D]=n.useState(!1),[T,c]=n.useState(""),[G,y]=n.useState(!1),[Y,C]=n.useState(!1),[r,s]=n.useState({shipment:"",warehouse_id:"",product:"",sku:"",quantity:"",stock_level:"",status:"In Stock"});n.useEffect(()=>{b(),J(),X(),Z()},[]);const b=async()=>{D(!0);try{const t=await i.get(I,{headers:{Authorization:`Bearer ${p}`}});z(Array.isArray(t.data)?t.data:[])}catch{c("Error fetching inventory data.")}finally{D(!1)}},J=async()=>{var t;try{const a=await i.get(Ee,{headers:{Authorization:`Bearer ${p}`}});H(((t=a.data)==null?void 0:t.shipments)||[])}catch{console.error("Failed to fetch shipments")}},X=async()=>{try{const t=await i.get(ye,{headers:{Authorization:`Bearer ${p}`}});j(t.data||[])}catch{console.error("Failed to fetch products")}},Z=async()=>{var t;try{const a=await i.get(Ce,{headers:{"Content-Type":"application/json","x-api-key":"0ad3f5c013c42d2d0537672a260978c71dcd5a7d508019d748f991deee3d65665a477e3523c6bbc83fd6a51a71dd5003"}});Q(((t=a.data)==null?void 0:t.data)||[])}catch(a){console.error("Failed to fetch warehouses",a)}},R=n.useMemo(()=>k.filter(t=>{var a;return(((a=t.shipment)==null?void 0:a.tracking_id)||"").toLowerCase().includes(g.toLowerCase())}),[k,g]),ee=t=>{const a=t.target.checked;N(a),S(a?new Set(k.map(l=>l._id)):new Set)},te=(t,a)=>{const l=new Set(E);t.target.checked?l.add(a):l.delete(a),S(l)},ae=async()=>{if(!E.size)return c("Please select items to delete.");try{await Promise.all(Array.from(E).map(t=>i.delete(`${I}/${t}`,{headers:{Authorization:`Bearer ${p}`}}))),c("Selected items deleted successfully."),S(new Set),N(!1),b()}catch{c("Error deleting selected items.")}finally{y(!1)}},re=async t=>{var m,$;t.preventDefault();const a=_=>/^[a-f\d]{24}$/i.test(_);if(!a(r.shipment)||!a(r.product)||!a(r.warehouse_id))return c("Shipment, Product, and Warehouse must be valid ObjectIDs.");const l={...r,quantity:Number(r.quantity),stock_level:Number(r.stock_level)};try{await i.post(I,l,{headers:{Authorization:`Bearer ${p}`}}),c("New inventory item created."),s({shipment:"",warehouse_id:"",product:"",sku:"",quantity:"",stock_level:"",status:"In Stock"}),C(!1),b()}catch(_){c((($=(m=_.response)==null?void 0:m.data)==null?void 0:$.error)||"Failed to create item.")}};return e.createElement(se,null,e.createElement(oe,{className:"text-center py-3"},"Warehouse Inventory"),e.createElement(ce,null,T&&e.createElement("div",{className:"alert alert-info"},T),e.createElement("div",{className:"d-flex justify-content-between align-items-center mb-4"},e.createElement(ue,{style:{maxWidth:"400px"}},e.createElement(me,null,"Search"),e.createElement(v,{type:"text",placeholder:"Search by Tracking ID",value:g,onChange:t=>V(t.target.value)})),e.createElement("div",{className:"d-flex gap-2"},e.createElement(d,{color:"success",onClick:()=>{const l=`${`In-${Date.now()}`}-SKU`;s(m=>({...m,sku:l})),C(!0)}},"+ New Item"),e.createElement(d,{color:"danger",onClick:()=>y(!0)},"Delete"))),K?e.createElement("div",{className:"text-center py-5"},e.createElement(le,{color:"primary"})):e.createElement(ie,{striped:!0,hover:!0,responsive:!0},e.createElement(de,null,e.createElement(w,null,e.createElement(h,null,e.createElement(W,{checked:O,onChange:ee})),e.createElement(h,null,"Tracking ID"),e.createElement(h,null,"Product"),e.createElement(h,null,"SKU"),e.createElement(h,null,"Quantity"),e.createElement(h,null,"Stock Level"))),e.createElement(he,null,R.length>0?R.map(t=>{var a,l;return e.createElement(w,{key:t._id},e.createElement(u,null,e.createElement(W,{checked:E.has(t._id),onChange:m=>te(m,t._id)})),e.createElement(u,null,((a=t.shipment)==null?void 0:a.tracking_id)||"N/A"),e.createElement(u,null,((l=t.product)==null?void 0:l.name)||"N/A"),e.createElement(u,null,t.sku),e.createElement(u,null,t.quantity),e.createElement(u,null,t.stock_level))}):e.createElement(w,null,e.createElement(u,{colSpan:"6",className:"text-center"},"No inventory records found."))))),e.createElement(L,{visible:Y,onClose:()=>C(!1)},e.createElement(U,null,e.createElement(B,null,"New Inventory Item")),e.createElement(pe,{onSubmit:re},e.createElement(F,null,e.createElement("div",{className:"mb-3"},e.createElement(o,null,"Shipment"),e.createElement(f,{value:r.shipment,onChange:t=>s({...r,shipment:t.target.value}),required:!0},e.createElement("option",{value:""},"Select Shipment"),Array.isArray(P)&&P.map(t=>e.createElement("option",{key:t._id,value:t._id},t.tracking_id||"Unnamed Shipment")))),e.createElement("div",{className:"mb-3"},e.createElement(o,null,"Product"),e.createElement(f,{value:r.product,onChange:t=>s({...r,product:t.target.value}),required:!0},e.createElement("option",{value:""},"Select Product"),Array.isArray(q)&&q.map(t=>e.createElement("option",{key:t._id,value:t._id},t.name||"Unnamed Product")))),e.createElement("div",{className:"mb-3"},e.createElement(o,null,"Warehouse"),e.createElement(f,{value:r.warehouse_id,onChange:t=>s({...r,warehouse_id:t.target.value}),required:!0},e.createElement("option",{value:""},"Select Warehouse"),Array.isArray(x)&&x.map(t=>e.createElement("option",{key:t._id,value:t._id},t.warehouseName," - ",t.address," ")))),e.createElement("div",{className:"mb-3"},e.createElement(o,null,"SKU"),e.createElement(v,{value:r.sku,onChange:t=>s({...r,sku:t.target.value}),required:!0})),e.createElement("div",{className:"mb-3"},e.createElement(o,null,"Quantity"),e.createElement(v,{type:"number",value:r.quantity,onChange:t=>s({...r,quantity:t.target.value}),required:!0})),e.createElement("div",{className:"mb-3"},e.createElement(o,null,"Stock Level"),e.createElement(v,{type:"number",value:r.stock_level,onChange:t=>s({...r,stock_level:t.target.value}),required:!0})),e.createElement("div",{className:`
              mb-3`},e.createElement(o,null,"Status"),e.createElement(f,{value:r.status,onChange:t=>s({...r,status:t.target.value})},e.createElement("option",{value:"In Stock"},"In Stock"),e.createElement("option",{value:"Out of Stock"},"Out of Stock")))),e.createElement(M,null,e.createElement(d,{color:"secondary",onClick:()=>C(!1)},"Cancel"),e.createElement(d,{color:"primary",type:"submit"},"Create")))),e.createElement(L,{visible:G,onClose:()=>y(!1)},e.createElement(U,null,e.createElement(B,null,"Confirm Deletion")),e.createElement(F,null,"Are you sure you want to delete selected inventory items?"),e.createElement(M,null,e.createElement(d,{color:"secondary",onClick:()=>y(!1)},"Cancel"),e.createElement(d,{color:"danger",onClick:ae},"Delete"))))};export{qe as default};
