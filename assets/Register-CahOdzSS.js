import{r as i,R as e,P as N,n as B,C as M,v as V}from"./index-D8dcmZku.js";import{a as $,u as j,F as U,c as Y}from"./index.esm-DnZXbGtC.js";import{C as b}from"./index.esm-6habf-Ib.js";import{C as o}from"./CAlert-Cy-5J0qe.js";import{C as R}from"./CForm-DDSvdoeo.js";import{C as r,a}from"./CInputGroupText-8RzPaqbD.js";import{a as s}from"./CFormInput-DzoaQ3uG.js";import{c as L,d as _,a as z,b as G}from"./CRow-CaSEyrQu.js";import{c as x}from"./cil-user-Ddrdy7PS.js";import{C as q}from"./CFormSelect-CVuJbEUM.js";import{C as k}from"./CFormCheck-Ck0jcSAX.js";import{C as J,a as W}from"./CCardBody-BXDHfi6T.js";import"./CCloseButton-CIVrGVIc.js";var Q=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M16,112V496H496V112ZM236.8,341.6a32.167,32.167,0,0,0,38.4,0L298.667,324,464,448v16H48V448L213.333,324ZM256,316,48,160V144H464v16ZM48,200,186.667,304,48,408ZM464,408,325.333,304,464,200Z' class='ci-primary'/>"],K=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M256,16C123.452,16,16,123.452,16,256S123.452,496,256,496,496,388.548,496,256,388.548,16,256,16ZM175.047,447.667A208.26,208.26,0,0,1,64.333,175.047c1.018-2.408,2.092-4.785,3.2-7.145L120,215.126v63.235L197.1,360H236v49.047l-47.052,43.915Q181.926,450.568,175.047,447.667Zm228.031-44.589A207.253,207.253,0,0,1,256,464a210.4,210.4,0,0,1-29.722-2.107L268,422.953V328H210.9L152,265.639V200.874L83.7,139.408a209.259,209.259,0,0,1,91.343-75.075A207.793,207.793,0,0,1,371.3,82.839l-45.564,58.582,15.49,38.725-10.485,10.485-78.618-15.723L208,208v88H384l50.345,67.126A208.127,208.127,0,0,1,403.078,403.078ZM464,256a206.763,206.763,0,0,1-13.873,74.837L400,264H240V224l19.877-14.908,81.382,16.277,37.515-37.515-16.51-41.275,34.2-43.977q3.361,3.084,6.61,6.32A207.253,207.253,0,0,1,464,256Z' class='ci-primary'/>"],X=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M469.666,216.45,271.078,33.749a34,34,0,0,0-47.062.98L41.373,217.373,32,226.745V496H208V328h96V496H480V225.958ZM248.038,56.771c.282,0,.108.061-.013.18C247.9,56.832,247.756,56.771,248.038,56.771ZM448,464H336V328a32,32,0,0,0-32-32H208a32,32,0,0,0-32,32V464H64V240L248.038,57.356c.013-.012.014-.023.024-.035L448,240Z' class='ci-primary'/>"],ee=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M449.366,89.648l-.685-.428L362.088,46.559,268.625,171.176l43,57.337a88.529,88.529,0,0,1-83.115,83.114l-57.336-43L46.558,362.088l42.306,85.869.356.725.429.684a25.085,25.085,0,0,0,21.393,11.857h22.344A327.836,327.836,0,0,0,461.222,133.386V111.041A25.084,25.084,0,0,0,449.366,89.648Zm-20.144,43.738c0,163.125-132.712,295.837-295.836,295.837h-18.08L87,371.76l84.18-63.135,46.867,35.149h5.333a120.535,120.535,0,0,0,120.4-120.4v-5.333l-35.149-46.866L371.759,87l57.463,28.311Z' class='ci-primary'/>"];function I({email:t,setEmail:n,otpVerified:u,setOtpVerified:d,apiUrl:p}){const[T,P]=i.useState(!1),[y,C]=i.useState(""),[g,E]=i.useState(!1),[f,c]=i.useState({message:"",type:""}),A=async()=>{if(!t){c({message:"Please enter an email address.",type:"danger"});return}E(!0),c({message:"",type:""});try{const l=await fetch(`${p}/register/send-otp`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t})});if(l.ok)P(!0),c({message:"OTP sent to your email. Check your inbox.",type:"success"});else{const h=await l.json();c({message:h.message,type:"danger"})}}catch{c({message:"Network error. Please try again later.",type:"danger"})}finally{E(!1)}},v=async()=>{if(!y){c({message:"Please enter the OTP.",type:"danger"});return}E(!0),c({message:"",type:""});try{const l=await fetch(`${p}/register/verify-otp`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,otp:y})});if(l.ok)d(!0),c({message:"OTP verified successfully!",type:"success"});else{const h=await l.json();c({message:h.message,type:"danger"})}}catch{c({message:"Network error. Please try again later.",type:"danger"})}finally{E(!1)}};return e.createElement(e.Fragment,null,f.message&&e.createElement(o,{color:f.type},f.message),!T&&!u?e.createElement(R,{onSubmit:l=>{l.preventDefault(),A()}},e.createElement("h1",null,"Register"),e.createElement("p",{className:"text-body-secondary"},"Enter your email to receive an OTP"),e.createElement(r,{className:"mb-3"},e.createElement(a,null,"@"),e.createElement(s,{type:"email",placeholder:"Email",autoComplete:"email",value:t,onChange:l=>n(l.target.value)})),e.createElement("div",{className:"d-grid"},e.createElement(L,{color:"success",type:"submit",disabled:g||!t},g?"Sending OTP...":"Send OTP"))):!u&&e.createElement(R,{onSubmit:l=>{l.preventDefault(),v()}},e.createElement("h1",null,"Verify OTP"),e.createElement("p",{className:"text-body-secondary"},"Enter the OTP sent to your email"),e.createElement(r,{className:"mb-3"},e.createElement(a,null,"OTP"),e.createElement(s,{type:"text",placeholder:"Enter OTP",value:y,onChange:l=>C(l.target.value)})),e.createElement("div",{className:"d-grid"},e.createElement(L,{color:"success",type:"submit",disabled:g||!y},g?"Verifying OTP...":"Verify OTP"))))}I.propTypes={email:N.string.isRequired,setEmail:N.func.isRequired,otpVerified:N.bool.isRequired,setOtpVerified:N.func.isRequired,apiUrl:N.string.isRequired};function te(){const{register:t,formState:{errors:n}}=$(),u=["businessRegistrationCertificate","taxClearanceCertificate","financialStatements","insuranceCertificate","companyProfile","isoCertification","authorizationCertificate","complianceDeclaration","productCatalog"];return e.createElement("div",null,e.createElement("h5",{className:"mb-3"},"Vendor Details"),e.createElement(r,{className:"mb-3"},e.createElement(a,null,e.createElement(b,{icon:X})),e.createElement(s,{placeholder:"Business Name",...t("businessName",{required:"Business Name is required"})})),n.businessName&&e.createElement(o,{color:"danger"},n.businessName.message),e.createElement(r,{className:"mb-3"},e.createElement(a,null,e.createElement(b,{icon:x})),e.createElement(s,{placeholder:"Full Name",...t("fullName",{required:"Full Name is required"})})),n.fullName&&e.createElement(o,{color:"danger"},n.fullName.message),e.createElement(r,{className:"mb-3"},e.createElement(a,null,"Address"),e.createElement(s,{placeholder:"Business Address",...t("businessAddress",{required:"Business Address is required"})})),n.businessAddress&&e.createElement(o,{color:"danger"},n.businessAddress.message),e.createElement(r,{className:"mb-3"},e.createElement(a,null,e.createElement(b,{icon:ee})),e.createElement(s,{placeholder:"Contact Number",...t("contactNumber",{required:"Contact Number is required"})})),n.contactNumber&&e.createElement(o,{color:"danger"},n.contactNumber.message),e.createElement(r,{className:"mb-3"},e.createElement(a,null,e.createElement(b,{icon:Q})),e.createElement(s,{type:"email",placeholder:"Email",...t("email",{required:"Email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Invalid email address"}})})),n.email&&e.createElement(o,{color:"danger"},n.email.message),e.createElement(r,{className:"mb-3"},e.createElement(a,null,e.createElement(b,{icon:K})),e.createElement(s,{placeholder:"Website",...t("website")})),e.createElement(r,{className:"mb-3"},e.createElement(a,null,"Registration No."),e.createElement(s,{placeholder:"Registration Number",...t("businessRegistrationNumber")})),e.createElement(r,{className:"mb-3"},e.createElement(a,null,"Business Type"),e.createElement(q,{...t("businessType")},e.createElement("option",{value:""},"Select Type"),e.createElement("option",{value:"LLC"},"LLC"),e.createElement("option",{value:"Partnership"},"Partnership"),e.createElement("option",{value:"Sole Proprietorship"},"Sole Proprietorship"))),e.createElement(r,{className:"mb-3"},e.createElement(a,null,"Country"),e.createElement(s,{placeholder:"Country of Registration",...t("countryOfRegistration")})),e.createElement(r,{className:"mb-3"},e.createElement(a,null,"Year"),e.createElement(s,{type:"number",placeholder:"Year Established",...t("yearEstablished",{min:{value:1900,message:"Year must be 1900 or later"},max:{value:new Date().getFullYear(),message:"Invalid future year"}})})),n.yearEstablished&&e.createElement(o,{color:"danger"},n.yearEstablished.message),e.createElement(r,{className:"mb-3"},e.createElement(a,null,"Tax ID"),e.createElement(s,{placeholder:"Tax ID",...t("taxId")})),e.createElement(r,{className:"mb-3"},e.createElement(a,null,"VAT"),e.createElement(s,{placeholder:"VAT Number",...t("vatNumber")})),e.createElement(r,{className:"mb-3"},e.createElement(a,null,"Certifications"),e.createElement(s,{placeholder:"Comma-separated certifications",...t("certifications")})),e.createElement(r,{className:"mb-3"},e.createElement(a,null,"Categories"),e.createElement(s,{placeholder:"Comma-separated categories",...t("categories")})),e.createElement(k,{className:"mb-3",label:"Authorized Dealer",...t("authorizedDealer")}),e.createElement("h6",{className:"mt-4 mb-2"},"Banking Information"),e.createElement(r,{className:"mb-3"},e.createElement(a,null,"Bank"),e.createElement(s,{placeholder:"Bank Name",...t("bankingInfo.bankName")})),e.createElement(r,{className:"mb-3"},e.createElement(a,null,"Account #"),e.createElement(s,{placeholder:"Account Number",...t("bankingInfo.bankAccountNumber")})),e.createElement(r,{className:"mb-3"},e.createElement(a,null,"SWIFT"),e.createElement(s,{placeholder:"SWIFT Code",...t("bankingInfo.bankSwiftCode")})),e.createElement(r,{className:"mb-3"},e.createElement(a,null,"Bank Country"),e.createElement(s,{placeholder:"Bank Country",...t("bankingInfo.bankCountry")})),e.createElement("h6",{className:"mt-4 mb-2"},"Documents (URLs)"),u.map(d=>e.createElement(r,{className:"mb-2",key:d},e.createElement(a,null,d.replace(/([A-Z])/g," $1")),e.createElement(s,{placeholder:`URL for ${d}`,...t(`documents.${d}`)}))),e.createElement("div",{className:"mb-3 mt-4"},e.createElement(k,{label:e.createElement(e.Fragment,null,"I agree to the"," ",e.createElement("a",{href:"/terms",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline"},"Terms and Conditions")),...t("acceptTerms",{required:"You must agree to the Terms and Conditions"})}),n.acceptTerms&&e.createElement(o,{color:"danger"},n.acceptTerms.message)),e.createElement("div",{className:"mb-3"},e.createElement(k,{label:e.createElement(e.Fragment,null,"I accept the"," ",e.createElement("a",{href:"/nda",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline"},"Non-Disclosure Agreement (NDA)")),...t("acceptNDA",{required:"You must accept the NDA"})}),n.acceptNDA&&e.createElement(o,{color:"danger"},n.acceptNDA.message)))}function ge(){const t="https://backend-log2.axleshift.com/api/v1/auth",n=j(),{register:u,handleSubmit:d,formState:{errors:p},watch:T,reset:P}=n,y=B(),[C,g]=i.useState(!1),[E,f]=i.useState({message:"",type:""}),[c,A]=i.useState(""),[v,l]=i.useState(!0),[h,D]=i.useState(!1),F=T("role","user"),Z=async m=>{g(!0),f({message:"",type:""});try{if(!c)throw new Error("Email verification is required.");const S={username:m.username,email:c,password:m.password,role:m.role||"user"};m.role==="vendor"&&(S.vendorDetails={businessName:m.businessName,fullName:m.fullName,businessAddress:m.businessAddress,contactNumber:m.contactNumber,certifications:m.certifications?m.certifications.split(","):[],taxId:m.taxId,email:c});const w=await fetch(`${t}/register/${m.role}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)});if(!w.ok){const H=await w.json();throw new Error(H.message||"Registration failed. Please try again.")}const O=await w.json();V.set("token",O.accessToken,{expires:1}),V.set("refreshToken",O.refreshToken,{expires:30}),f({message:"Registration Successful! Redirecting...",type:"success"}),P(),setTimeout(()=>y("/login"),2e3)}catch(S){f({message:S.message,type:"danger"})}finally{g(!1)}};return e.createElement("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center"},e.createElement(_,null,e.createElement(z,{className:"justify-content-center"},e.createElement(G,{md:9,lg:7,xl:6},e.createElement(J,{className:"mx-4"},e.createElement(W,{className:"p-4"},v?e.createElement(U,{...n},e.createElement(R,{onSubmit:d(Z)},e.createElement("h1",{className:"text-center mb-4"},"Complete Registration"),E.message&&e.createElement(o,{color:E.type},E.message),e.createElement(r,{className:`mb-3 ${p.username?"is-invalid":""}`},e.createElement(a,null,e.createElement(b,{icon:x})),e.createElement(s,{placeholder:"Username",...u("username",{required:"Username is required"})})),p.username&&e.createElement(o,{color:"danger"},p.username.message),e.createElement(r,{className:"mb-3"},e.createElement(a,null,e.createElement(b,{icon:Y})),e.createElement(s,{type:h?"text":"password",placeholder:"Password",...u("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}})}),e.createElement(a,{role:"button",onClick:()=>D(m=>!m),style:{cursor:"pointer"}},h?"🙈":"👁️")),p.password&&e.createElement(o,{color:"danger"},p.password.message),e.createElement(r,{className:"mb-3"},e.createElement(a,null,"Role"),e.createElement(q,{...u("role")},e.createElement("option",{value:"super admin"},"Super Admin"),e.createElement("option",{value:"admin"},"Admin"),e.createElement("option",{value:"vendor"},"Vendor"),e.createElement("option",{value:"staff"},"Staff"))),F==="vendor"&&e.createElement(te,null),e.createElement("div",{className:"d-grid"},e.createElement(L,{color:"primary",type:"submit",disabled:C},C?e.createElement(M,{color:"light"}):"Register")))):e.createElement(I,{email:c,setEmail:A,otpVerified:v,setOtpVerified:l,apiUrl:t})))))))}export{ge as default};
