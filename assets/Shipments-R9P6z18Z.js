import{r as l,R as e,C as ee}from"./index-u2Qs36p3.js";import{a as M}from"./index-xsH4HHeE.js";import{c as y,a as h,b as a,d as ce}from"./CRow-DtWFmLOc.js";import{c as me,d as le,n as oe,e as pe,g as de,h as _e,j as Z,k as E,l as he,m as b}from"./CTable-Bj2GUyx5.js";import{C as ue}from"./CForm-BtwIIebc.js";import{a as r}from"./CFormInput-BombTHvf.js";import{a as ge,b as Ee,c as be,d as ye}from"./DefaultLayout-BGq73zaZ.js";import{C as ne,a as te}from"./CCardBody-yjhI4cU3.js";import{C as ae}from"./CCardHeader-lU4oNxDI.js";import{C as Ce}from"./CAlert-BUqSYFh_.js";import"./CCloseButton-_40XTppL.js";import"./CFormTextarea-BaXxN6bT.js";import"./CFormSelect-CCrtQkoU.js";import"./index.esm-CMPwQNLq.js";import"./cil-user-Ddrdy7PS.js";import"./index-BSMPKgt7.js";const ve="https://backend-log2.axleshift.com",U=`${ve}/api/v1/shipment`,Se=()=>{const[o,v]=l.useState([]),[f,N]=l.useState(!1),[u,k]=l.useState({visible:!1,message:"",color:""}),[x,g]=l.useState(!1),[w,C]=l.useState(!1),[P,q]=l.useState("TR-123456"),[A,S]=l.useState(null),[p,F]=l.useState(1),d=5,D=()=>{const[n,s]=P.split("-");let m=String(parseInt(s)+1).padStart(5,"0"),c=`${n}-${m}`;for(;o.some(_=>_.tracking_id===c);)m=String(parseInt(m)+1).padStart(5,"0"),c=`${n}-${m}`;return q(c),S(c),c},[t,L]=l.useState({tracking_id:"",shipper_company_name:"",shipper_contact_name:"",shipper_contact_email_address:"",shipper_contact_phone_number:"",shipper_company_address:"",consignee_company_name:"",consignee_contact_name:"",consignee_contact_email_address:"",consignee_contact_phone_number:"",consignee_company_address:"",shipment_description:"",shipment_weight:"",shipment_dimension_length:"",shipment_dimension_width:"",shipment_dimension_height:"",receiveDate:"",isInWarehouse:!1,dispatch:"Pending",paid:"Unpaid",amount:"",type:"public"});l.useEffect(()=>{B()},[]);const B=async()=>{try{const n=await M.get(U);v(n.data.shipments||[])}catch(n){console.error("Failed to fetch shipments:",n)}},R=(n,s)=>{k({visible:!0,message:n,color:s}),setTimeout(()=>k({visible:!1,message:"",color:""}),4e3)},i=n=>{const{name:s,value:m}=n.target;L(c=>({...c,[s]:m}))},se=async n=>{n.preventDefault(),N(!0);try{const s=Number(t.shipment_dimension_length),m=Number(t.shipment_dimension_width),c=Number(t.shipment_dimension_height),_={tracking_id:t.tracking_id,shipper:{shipper_company_name:t.shipper_company_name,shipper_contact_name:t.shipper_contact_name,shipper_contact_email_address:t.shipper_contact_email_address,shipper_contact_phone_number:t.shipper_contact_phone_number,shipper_company_address:t.shipper_company_address},consignee:{consignee_company_name:t.consignee_company_name,consignee_contact_name:t.consignee_contact_name,consignee_contact_email_address:t.consignee_contact_email_address,consignee_contact_phone_number:t.consignee_contact_phone_number,consignee_company_address:t.consignee_company_address},shipment:{shipment_description:t.shipment_description,shipment_weight:Number(t.shipment_weight),shipment_dimension_length:s,shipment_dimension_width:m,shipment_dimension_height:c,shipment_volume:s*m*c,shipment_value:100,shipment_instructions:"N/A"},shipping:{shipping_type:"land",shipping_details:{land:{origin_address:"N/A",destination_address:"N/A"}}},receiveDate:t.receiveDate||null,isInWarehouse:t.isInWarehouse,dispatch:"Pending",paid:"Unpaid",amount:0,type:"public"};w?(await M.put(`${U}/${A}`,_),R("Shipment updated!","success")):(await M.post(U,_),R("Shipment created!","success")),B(),g(!1),H()}catch(s){console.error("Error:",s),R("Error occurred","danger")}finally{N(!1)}},H=()=>{L({tracking_id:"",shipper_company_name:"",shipper_contact_name:"",shipper_contact_email_address:"",shipper_contact_phone_number:"",shipper_company_address:"",consignee_company_name:"",consignee_contact_name:"",consignee_contact_email_address:"",consignee_contact_phone_number:"",consignee_company_address:"",shipment_description:"",shipment_weight:"",shipment_dimension_length:"",shipment_dimension_width:"",shipment_dimension_height:"",receiveDate:"",isInWarehouse:!1,dispatch:"Pending",paid:"Unpaid",amount:0,type:"public"})},re=n=>{var s,m,c,_,T,I,j,V,O,G,J,K,Q,X,Y;C(!0),S(n._id),L({tracking_id:n.tracking_id,shipper_company_name:((s=n.shipper)==null?void 0:s.shipper_company_name)||"",shipper_contact_name:((m=n.shipper)==null?void 0:m.shipper_contact_name)||"",shipper_contact_email_address:((c=n.shipper)==null?void 0:c.shipper_contact_email_address)||"",shipper_contact_phone_number:((_=n.shipper)==null?void 0:_.shipper_contact_phone_number)||"",shipper_company_address:((T=n.shipper)==null?void 0:T.shipper_company_address)||"",consignee_company_name:((I=n.consignee)==null?void 0:I.consignee_company_name)||"",consignee_contact_name:((j=n.consignee)==null?void 0:j.consignee_contact_name)||"",consignee_contact_email_address:((V=n.consignee)==null?void 0:V.consignee_contact_email_address)||"",consignee_contact_phone_number:((O=n.consignee)==null?void 0:O.consignee_contact_phone_number)||"",consignee_company_address:((G=n.consignee)==null?void 0:G.consignee_company_address)||"",shipment_description:((J=n.shipment)==null?void 0:J.shipment_description)||"",shipment_weight:((K=n.shipment)==null?void 0:K.shipment_weight)||"",shipment_dimension_length:((Q=n.shipment)==null?void 0:Q.shipment_dimension_length)||"",shipment_dimension_width:((X=n.shipment)==null?void 0:X.shipment_dimension_width)||"",shipment_dimension_height:((Y=n.shipment)==null?void 0:Y.shipment_dimension_height)||""}),g(!0)},W=n=>{const s=Math.ceil(o.length/d);n==="next"&&p<s?F(p+1):n==="prev"&&p>1&&F(p-1)},$=(p-1)*d,ie=o.slice($,$+d),z=Math.ceil(o.length/d);return e.createElement(e.Fragment,null,e.createElement("div",{className:"d-flex justify-content-between align-items-center mb-4"},e.createElement("h4",null,"Shipments"),e.createElement(y,{color:"primary",onClick:()=>{C(!1),S(null);const n=D();H(),L(s=>({...s,tracking_id:n})),g(!0)}},"+ New Shipment")),e.createElement(me,{visible:x,onClose:()=>g(!1),size:"lg"},e.createElement(le,null,e.createElement(oe,null,w?"Edit Shipment":"Create Shipment")),e.createElement(pe,null,e.createElement(ue,{onSubmit:se},e.createElement(h,{className:"mb-3"},e.createElement(a,{md:6},e.createElement(r,{label:"Tracking ID",name:"tracking_id",value:t.tracking_id,onChange:i,required:!0})),e.createElement(h,{className:"mb-3"},e.createElement(a,{md:6},e.createElement(r,{type:"date",label:"Received Date",name:"receiveDate",value:t.receiveDate,onChange:i}))),e.createElement(a,{md:6},e.createElement(r,{label:"Shipper Company",name:"shipper_company_name",value:t.shipper_company_name,onChange:i,required:!0}))),e.createElement(h,{className:"mb-3"},e.createElement(a,{md:4},e.createElement(r,{label:"Shipper Contact Name",name:"shipper_contact_name",value:t.shipper_contact_name,onChange:i,required:!0})),e.createElement(a,{md:4},e.createElement(r,{label:"Shipper Email",name:"shipper_contact_email_address",value:t.shipper_contact_email_address,onChange:i,required:!0})),e.createElement(a,{md:4},e.createElement(r,{label:"Shipper Phone",name:"shipper_contact_phone_number",value:t.shipper_contact_phone_number,onChange:i,required:!0}))),e.createElement(h,{className:"mb-3"},e.createElement(a,null,e.createElement(r,{label:"Shipper Address",name:"shipper_company_address",value:t.shipper_company_address,onChange:i,required:!0}))),e.createElement(h,{className:"mb-3"},e.createElement(a,{md:6},e.createElement(r,{label:"Consignee Company",name:"consignee_company_name",value:t.consignee_company_name,onChange:i,required:!0})),e.createElement(a,{md:6},e.createElement(r,{label:"Consignee Contact Name",name:"consignee_contact_name",value:t.consignee_contact_name,onChange:i,required:!0}))),e.createElement(h,{className:"mb-3"},e.createElement(a,{md:4},e.createElement(r,{label:"Consignee Email",name:"consignee_contact_email_address",value:t.consignee_contact_email_address,onChange:i,required:!0})),e.createElement(a,{md:4},e.createElement(r,{label:"Consignee Phone",name:"consignee_contact_phone_number",value:t.consignee_contact_phone_number,onChange:i,required:!0})),e.createElement(a,{md:4},e.createElement(r,{label:"Consignee Address",name:"consignee_company_address",value:t.consignee_company_address,onChange:i,required:!0}))),e.createElement(h,{className:"mb-3"},e.createElement(a,{md:6},e.createElement(r,{label:"Description",name:"shipment_description",value:t.shipment_description,onChange:i,required:!0})),e.createElement(a,{md:6},e.createElement(r,{label:"Weight (kg)",name:"shipment_weight",type:"number",value:t.shipment_weight,onChange:i,required:!0}))),e.createElement(h,{className:"mb-3"},e.createElement(a,{md:4},e.createElement(r,{label:"Length (cm)",name:"shipment_dimension_length",type:"number",value:t.shipment_dimension_length,onChange:i,required:!0})),e.createElement(a,{md:4},e.createElement(r,{label:"Width (cm)",name:"shipment_dimension_width",type:"number",value:t.shipment_dimension_width,onChange:i,required:!0})),e.createElement(a,{md:4},e.createElement(r,{label:"Height (cm)",name:"shipment_dimension_height",type:"number",value:t.shipment_dimension_height,onChange:i,required:!0}))),e.createElement("div",{className:"text-end"},e.createElement(y,{type:"submit",color:"success",disabled:f},f?e.createElement(ee,{size:"sm"}):w?"Update":"Create"))))),e.createElement(de,{striped:!0,hover:!0,responsive:!0},e.createElement(_e,null,e.createElement(Z,null,e.createElement(E,null,"#"),e.createElement(E,null,"Tracking ID"),e.createElement(E,null,"Shipper"),e.createElement(E,null,"Consignee"),e.createElement(E,null,"Description"),e.createElement(E,null,"Weight"),e.createElement(E,null,"Volume (cmÂ³)"),e.createElement(E,null,"Actions"))),e.createElement(he,null,ie.map((n,s)=>{var m,c,_,T,I;return e.createElement(Z,{key:n._id},e.createElement(b,null,$+s+1),e.createElement(b,null,n.tracking_id),e.createElement(b,null,(m=n.shipper)==null?void 0:m.shipper_company_name),e.createElement(b,null,(c=n.consignee)==null?void 0:c.consignee_company_name),e.createElement(b,null,(_=n.shipment)==null?void 0:_.shipment_description),e.createElement(b,null,(T=n.shipment)==null?void 0:T.shipment_weight),e.createElement(b,null,(I=n.shipment)==null?void 0:I.shipment_volume),e.createElement(b,null,e.createElement(y,{size:"sm",color:"info",className:"me-2",onClick:()=>re(n)},"Edit")))}))),e.createElement("div",{className:"d-flex justify-content-between align-items-center mt-3"},e.createElement("span",null,"Page ",p," of ",z),e.createElement("div",null,e.createElement(y,{color:"secondary",className:"me-2",size:"sm",onClick:()=>W("prev"),disabled:p===1},"â Prev"),e.createElement(y,{color:"secondary",size:"sm",onClick:()=>W("next"),disabled:p>=z},"Next â"))),e.createElement(ge,{position:"top-end"},u.visible&&e.createElement(Ee,{color:u.color},e.createElement(be,{closeButton:!0},u.color==="success"?"Success":"Error"),e.createElement(ye,null,u.message))))},fe="https://backend-log2.axleshift.com",Ne=`${fe}/api/v1/shipment`,ke=()=>{const[o,v]=l.useState(""),[f,N]=l.useState(!1),[u,k]=l.useState(null),[x,g]=l.useState(null),w=async()=>{var C,P,q,A,S;if(!o.trim()){g("Please enter a tracking number");return}N(!0),g(null),k(null);try{const d=((await M.get(Ne)).data.shipments||[]).find(D=>D.tracking_id===o);if(!d)g("Tracking number not found.");else{const D={status:((C=d.delivery)==null?void 0:C.status)||"N/A",expectedDelivery:(P=d.delivery)!=null&&P.deliveryDate?new Date(d.delivery.deliveryDate).toLocaleDateString():"Not provided",currentLocation:((S=(A=(q=d.shipping)==null?void 0:q.shipping_details)==null?void 0:A.land)==null?void 0:S.destination_address)||"â"};k(D)}}catch(p){console.error(p),g("Error fetching shipment data.")}finally{N(!1)}};return e.createElement(ne,{className:"shadow-sm"},e.createElement(ae,{className:"bg-primary text-white"},e.createElement("h5",{className:"mb-0"},"ð¦ Delivery Tracking ")),e.createElement(te,null,e.createElement(h,{className:"mb-3"},e.createElement(a,{md:8},e.createElement(r,{id:"trackingNumber",placeholder:"Enter tracking number (e.g. 12345)",value:o,onChange:C=>v(C.target.value)})),e.createElement(a,{md:4},e.createElement(y,{color:"primary",className:"w-100",onClick:w,disabled:f},f?e.createElement(ee,{size:"sm"}):"Track"))),x&&e.createElement(Ce,{color:"danger",className:"mt-2"},x),u&&e.createElement("div",{className:"mt-4 border-top pt-3"},e.createElement("h6",{className:"mb-3 text-success"},"â Delivery Details"),e.createElement("p",null,e.createElement("strong",null,"Status:")," ",u.status),e.createElement("p",null,e.createElement("strong",null,"Expected Delivery:")," ",u.expectedDelivery),e.createElement("p",null,e.createElement("strong",null,"Current Location:")," ",u.currentLocation))))},We=()=>{const[o,v]=l.useState("ShipmentDeliveryForm");return e.createElement(ce,null,e.createElement(h,{className:"mb-3"},e.createElement(a,null,e.createElement(ne,null,e.createElement(ae,null,e.createElement(y,{color:o==="ShipmentDeliveryForm"?"primary":"secondary",onClick:()=>v("ShipmentDeliveryForm"),className:"ms-2"},"ShipmentDeliveryForm"),e.createElement(y,{color:o==="deliveryTracking"?"primary":"secondary",onClick:()=>v("deliveryTracking"),className:"ms-2"},"Delivery Tracking")),e.createElement(te,null,o==="ShipmentDeliveryForm"?e.createElement(Se,null):e.createElement(ke,null))))))};export{We as default};
