import{f as A,r as s,j as e,L as m,g as C}from"./index-CG5cXGW0.js";import{u as F,c as U}from"./index.esm-xGuvYLOc.js";import{C as S}from"./index.esm-DBs-EpJf.js";import{F as _,d as G,e as q}from"./index-DCFH6BHU.js";import{R as V,V as D}from"./config-wfiosbPZ.js";import{C as W,a as i}from"./CContainer-DZvKed_E.js";import{C as d,a as r}from"./CRow-BVAaJJJw.js";import{C as z}from"./CCardGroup-DeHWj0P7.js";import{C as B,a as $}from"./CCardBody-BuyTEJM8.js";import{C as H}from"./CAlert-TWNuonwF.js";import{C as J}from"./CForm-BCrxAxUr.js";import{C as w,a as N}from"./CInputGroupText-ChCmPa4a.js";import{c as K}from"./cil-user-Ddrdy7PS.js";import{C as b}from"./CFormInput-WRbFKXpa.js";import"./CCloseButton-viBWZYHx.js";import"./Transition-DONipWBO.js";const me=()=>{const R="https://backend-log2.axleshift.com/api/v1/auth",{register:u,handleSubmit:P,formState:{errors:t},reset:k}=F(),x=A(),L=s.useRef(null),h=s.useRef(),[a,g]=s.useState(!1),[n,o]=s.useState({message:"",type:""}),[f,E]=s.useState(!1),I=async c=>{g(!0),o({message:"",type:""});try{const l=await h.current.executeAsync(),j=await fetch(`${R}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...c,recaptcha_ref:l})}),p=await j.json();if(console.log("Response Data:",p),!j.ok)throw new Error(p.message||"Login failed");const{accessToken:v,refreshToken:O,user:y}=p;C.set("token",v,{expires:1,secure:!0,httpOnly:!0,sameSite:"Strict"}),C.set("refreshToken",O,{expires:1,secure:!0,httpOnly:!0,sameSite:"Strict"}),o({message:"Welcome back! Redirecting to your Supplier Page...",type:"success"}),k(),y.role==="supplier"||y.role==="user"?x("/supplierspage/supplierprofile"):o({message:"Unauthorized role. Please contact support.",type:"danger"})}catch(l){o({message:l.message,type:"danger"})}finally{g(!1)}},T=()=>{E(c=>!c)};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsxs(W,{children:[e.jsx(V,{ref:h,size:"invisible",sitekey:D}),e.jsxs(d,{className:"justify-content-center",children:[e.jsxs(r,{md:4,className:"d-flex flex-column align-items-center justify-content-center bg-primary text-white",children:[e.jsx("h2",{children:"Supplier Login"}),e.jsx("p",{children:"Logistic Management System"}),e.jsx(m,{to:"/login",className:"text-white",children:"Vendor Portal â†’"})]}),e.jsx(r,{md:5,children:e.jsx(z,{children:e.jsx(B,{className:"p-4",children:e.jsxs($,{children:[n.message&&e.jsx(H,{color:n.type,dismissible:!0,children:n.message}),e.jsxs(J,{onSubmit:P(I),children:[e.jsx("h1",{children:"Supplier Login"}),e.jsx("p",{className:"text-body-secondary",children:"Sign In to your Supplier account"}),e.jsxs(w,{className:"mb-3",children:[e.jsx(N,{children:e.jsx(S,{icon:K})}),e.jsx(b,{ref:L,type:"text",placeholder:"Username",autoComplete:"username",...u("username",{required:"Username is required"})})]}),t.username&&e.jsx("p",{className:"text-danger",children:t.username.message}),e.jsxs(w,{className:"mb-4",children:[e.jsx(N,{children:e.jsx(S,{icon:U})}),e.jsx(b,{type:f?"text":"password",placeholder:"Password",autoComplete:"current-password",...u("password",{required:"Password is required"})}),e.jsx(i,{color:"secondary",variant:"outline",onClick:T,type:"button",children:e.jsx(_,{icon:f?G:q})})]}),t.password&&e.jsx("p",{className:"text-danger",children:t.password.message}),e.jsxs(d,{children:[e.jsx(r,{sm:5,children:e.jsx(i,{color:"success",variant:"outline",className:"px-4",type:"submit",disabled:a,children:a?"Logging in...":"LOGIN"})}),e.jsx(r,{xs:"auto",className:"me-auto",children:e.jsx(m,{to:"/forgotPass",children:e.jsx(i,{color:"danger",variant:"outline",className:"px-4",disabled:a,children:a?"Processing...":"FORGOT PASSWORD"})})})]}),e.jsx(d,{className:"mt-3",children:e.jsx(r,{xs:12,className:"text-center",children:e.jsx(m,{to:"/register",children:e.jsx(i,{color:"link",className:"px-0",children:"Register Now!"})})})})]})]})})})})]})]})})};export{me as default};
