import{r as d,R as e,P as T,n as Y,C as _,v as I}from"./index-T5XWHBzK.js";import{a as G,u as z,F as J,c as Q}from"./index.esm-Dr4FC5U3.js";import{C as h}from"./index.esm-xBXTxMGC.js";import{C as i}from"./CAlert-D0kofbhi.js";import{C as O}from"./CForm-BQmKN4aF.js";import{C as o,a as s}from"./CInputGroupText-DRW-FPgl.js";import{a as c}from"./CFormInput-D8uHrqJJ.js";import{c as L,d as W,a as K,b as X}from"./CRow-Dc32PVYS.js";import{c as H}from"./cil-user-Ddrdy7PS.js";import{C as M}from"./CFormSelect-I-CK3fL7.js";import{C as Z}from"./CFormCheck-Bn8wP9zb.js";import{C as ee,a as te}from"./CCardBody-Bw6ZitW4.js";import"./CCloseButton-ZDYmxsSm.js";var ae=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M16,112V496H496V112ZM236.8,341.6a32.167,32.167,0,0,0,38.4,0L298.667,324,464,448v16H48V448L213.333,324ZM256,316,48,160V144H464v16ZM48,200,186.667,304,48,408ZM464,408,325.333,304,464,200Z' class='ci-primary'/>"],re=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M256,16C123.452,16,16,123.452,16,256S123.452,496,256,496,496,388.548,496,256,388.548,16,256,16ZM175.047,447.667A208.26,208.26,0,0,1,64.333,175.047c1.018-2.408,2.092-4.785,3.2-7.145L120,215.126v63.235L197.1,360H236v49.047l-47.052,43.915Q181.926,450.568,175.047,447.667Zm228.031-44.589A207.253,207.253,0,0,1,256,464a210.4,210.4,0,0,1-29.722-2.107L268,422.953V328H210.9L152,265.639V200.874L83.7,139.408a209.259,209.259,0,0,1,91.343-75.075A207.793,207.793,0,0,1,371.3,82.839l-45.564,58.582,15.49,38.725-10.485,10.485-78.618-15.723L208,208v88H384l50.345,67.126A208.127,208.127,0,0,1,403.078,403.078ZM464,256a206.763,206.763,0,0,1-13.873,74.837L400,264H240V224l19.877-14.908,81.382,16.277,37.515-37.515-16.51-41.275,34.2-43.977q3.361,3.084,6.61,6.32A207.253,207.253,0,0,1,464,256Z' class='ci-primary'/>"],se=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M469.666,216.45,271.078,33.749a34,34,0,0,0-47.062.98L41.373,217.373,32,226.745V496H208V328h96V496H480V225.958ZM248.038,56.771c.282,0,.108.061-.013.18C247.9,56.832,247.756,56.771,248.038,56.771ZM448,464H336V328a32,32,0,0,0-32-32H208a32,32,0,0,0-32,32V464H64V240L248.038,57.356c.013-.012.014-.023.024-.035L448,240Z' class='ci-primary'/>"],ne=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M449.366,89.648l-.685-.428L362.088,46.559,268.625,171.176l43,57.337a88.529,88.529,0,0,1-83.115,83.114l-57.336-43L46.558,362.088l42.306,85.869.356.725.429.684a25.085,25.085,0,0,0,21.393,11.857h22.344A327.836,327.836,0,0,0,461.222,133.386V111.041A25.084,25.084,0,0,0,449.366,89.648Zm-20.144,43.738c0,163.125-132.712,295.837-295.836,295.837h-18.08L87,371.76l84.18-63.135,46.867,35.149h5.333a120.535,120.535,0,0,0,120.4-120.4v-5.333l-35.149-46.866L371.759,87l57.463,28.311Z' class='ci-primary'/>"];function $({email:t,setEmail:C,otpVerified:g,setOtpVerified:a,apiUrl:u}){const[f,v]=d.useState(!1),[p,P]=d.useState(""),[y,E]=d.useState(!1),[b,m]=d.useState({message:"",type:""}),R=async()=>{if(!t){m({message:"Please enter an email address.",type:"danger"});return}E(!0),m({message:"",type:""});try{const n=await fetch(`${u}/register/send-otp`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t})});if(n.ok)v(!0),m({message:"OTP sent to your email. Check your inbox.",type:"success"});else{const N=await n.json();m({message:N.message,type:"danger"})}}catch{m({message:"Network error. Please try again later.",type:"danger"})}finally{E(!1)}},S=async()=>{if(!p){m({message:"Please enter the OTP.",type:"danger"});return}E(!0),m({message:"",type:""});try{const n=await fetch(`${u}/register/verify-otp`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,otp:p})});if(n.ok)a(!0),m({message:"OTP verified successfully!",type:"success"});else{const N=await n.json();m({message:N.message,type:"danger"})}}catch{m({message:"Network error. Please try again later.",type:"danger"})}finally{E(!1)}};return e.createElement(e.Fragment,null,b.message&&e.createElement(i,{color:b.type},b.message),!f&&!g?e.createElement(O,{onSubmit:n=>{n.preventDefault(),R()}},e.createElement("h1",null,"Register"),e.createElement("p",{className:"text-body-secondary"},"Enter your email to receive an OTP"),e.createElement(o,{className:"mb-3"},e.createElement(s,null,"@"),e.createElement(c,{type:"email",placeholder:"Email",autoComplete:"email",value:t,onChange:n=>C(n.target.value)})),e.createElement("div",{className:"d-grid"},e.createElement(L,{color:"success",type:"submit",disabled:y||!t},y?"Sending OTP...":"Send OTP"))):!g&&e.createElement(O,{onSubmit:n=>{n.preventDefault(),S()}},e.createElement("h1",null,"Verify OTP"),e.createElement("p",{className:"text-body-secondary"},"Enter the OTP sent to your email"),e.createElement(o,{className:"mb-3"},e.createElement(s,null,"OTP"),e.createElement(c,{type:"text",placeholder:"Enter OTP",value:p,onChange:n=>P(n.target.value)})),e.createElement("div",{className:"d-grid"},e.createElement(L,{color:"success",type:"submit",disabled:y||!p},y?"Verifying OTP...":"Verify OTP"))))}$.propTypes={email:T.string.isRequired,setEmail:T.func.isRequired,otpVerified:T.bool.isRequired,setOtpVerified:T.func.isRequired,apiUrl:T.string.isRequired};function le(){const{register:t,control:C,setValue:g,formState:{errors:a}}=G(),u=["businessRegistrationCertificate","companyProfile","isoCertification","authorizationCertificate","complianceDeclaration","productCatalog"];return e.createElement("div",null,e.createElement("h5",{className:"mb-3"},"Vendor Details"),e.createElement(o,{className:"mb-3"},e.createElement(s,null,e.createElement(h,{icon:se})),e.createElement(c,{placeholder:"Business Name",...t("businessName",{required:"Business Name is required"})})),a.businessName&&e.createElement(i,{color:"danger"},a.businessName.message),e.createElement(o,{className:"mb-3"},e.createElement(s,null,e.createElement(h,{icon:H})),e.createElement(c,{placeholder:"Full Name",...t("fullName",{required:"Full Name is required"})})),a.fullName&&e.createElement(i,{color:"danger"},a.fullName.message),e.createElement(o,{className:"mb-3"},e.createElement(s,null,"Address"),e.createElement(c,{placeholder:"Business Address",...t("businessAddress",{required:"Business Address is required"})})),a.businessAddress&&e.createElement(i,{color:"danger"},a.businessAddress.message),e.createElement(o,{className:"mb-3"},e.createElement(s,null,e.createElement(h,{icon:ne})),e.createElement(c,{placeholder:"Contact Number",...t("contactNumber",{required:"Contact Number is required"})})),a.contactNumber&&e.createElement(i,{color:"danger"},a.contactNumber.message),e.createElement(o,{className:"mb-3"},e.createElement(s,null,e.createElement(h,{icon:ae})),e.createElement(c,{type:"email",placeholder:"Email",...t("email",{required:"Email is required",pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Invalid email address"}})})),a.email&&e.createElement(i,{color:"danger"},a.email.message),e.createElement(o,{className:"mb-3"},e.createElement(s,null,e.createElement(h,{icon:re})),e.createElement(c,{placeholder:"Website",...t("website")})),e.createElement(o,{className:"mb-3"},e.createElement(s,null,"Registration No."),e.createElement(c,{placeholder:"Registration Number",...t("businessRegistrationNumber")})),e.createElement(o,{className:"mb-3"},e.createElement(s,null,"Business Type"),e.createElement(M,{...t("businessType")},e.createElement("option",{value:""},"Select Type"),e.createElement("option",{value:"LLC"},"LLC"),e.createElement("option",{value:"Partnership"},"Partnership"),e.createElement("option",{value:"Sole Proprietorship"},"Sole Proprietorship"))),e.createElement(o,{className:"mb-3"},e.createElement(s,null,"Country"),e.createElement(c,{placeholder:"Country of Registration",...t("countryOfRegistration")})),e.createElement(o,{className:"mb-3"},e.createElement(s,null,"Year"),e.createElement(c,{type:"number",placeholder:"Year Established",...t("yearEstablished",{min:{value:1900,message:"Year must be 1900 or later"},max:{value:new Date().getFullYear(),message:"Invalid future year"}})})),a.yearEstablished&&e.createElement(i,{color:"danger"},a.yearEstablished.message),e.createElement(o,{className:"mb-3"},e.createElement(s,null,"Tax ID"),e.createElement(c,{placeholder:"Tax ID",...t("taxId")})),e.createElement("h6",{className:"mt-4 mb-2"},"Upload Documents"),u.map(f=>e.createElement(o,{className:"mb-2",key:f},e.createElement(s,null,f.replace(/([A-Z])/g," $1")),e.createElement(c,{type:"file",accept:"application/pdf, image/*",...t(`documents.${f}`),onChange:v=>{var p;(p=v.target.files)==null||p[0]}}))),e.createElement("div",{className:"mb-3 mt-4"},e.createElement(Z,{label:e.createElement(e.Fragment,null,"I agree to the"," ",e.createElement("a",{href:"/terms",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline"},"Terms and Conditions")),...t("agreeToTerms",{required:"You must agree to the Terms and Conditions"})}),a.agreeToTerms&&e.createElement(i,{color:"danger"},a.agreeToTerms.message)),e.createElement("div",{className:"mb-3"},e.createElement(Z,{label:e.createElement(e.Fragment,null,"I accept the"," ",e.createElement("a",{href:"/nda",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline"},"Non-Disclosure Agreement (NDA)")),...t("acceptNDA",{required:"You must accept the NDA"})}),a.acceptNDA&&e.createElement(i,{color:"danger"},a.acceptNDA.message)))}function Ne(){const t="https://backend-log2.axleshift.com/api/v1/auth",C=z(),{register:g,handleSubmit:a,formState:{errors:u},watch:f,reset:v}=C,p=Y(),[P,y]=d.useState(!1),[E,b]=d.useState({message:"",type:""}),[m,R]=d.useState(""),[S,n]=d.useState(!1),[N,j]=d.useState(!1),B=f("role","user"),U=async r=>{y(!0),b({message:"",type:""});try{const w=r.email||"";if(!w)throw new Error("Email verification is required.");const l=new FormData;l.append("username",r.username),l.append("email",w),l.append("password",r.password),l.append("role",r.role||"user"),r.role==="vendor"&&(l.append("businessName",r.businessName),l.append("fullName",r.fullName),l.append("businessAddress",r.businessAddress),l.append("contactNumber",r.contactNumber),l.append("taxId",r.taxId),l.append("website",r.website),l.append("businessType",r.businessType),l.append("countryOfRegistration",r.countryOfRegistration),l.append("yearEstablished",r.yearEstablished),l.append("agreeToTerms",r.agreeToTerms?"true":"false"),l.append("acceptNDA",r.acceptNDA?"true":"false"),["businessRegistrationCertificate","companyProfile","isoCertification","authorizationCertificate","complianceDeclaration","productCatalog"].forEach(q=>{var F,k;const D=(k=(F=r.documents)==null?void 0:F[q])==null?void 0:k[0];D&&l.append(q,D)}));const A=await fetch(`${t}/register/vendor`,{method:"POST",body:l});if(!A.ok){const x=await A.json();throw new Error(x.message||"Registration failed. Please try again.")}const V=await A.json();I.set("token",V.accessToken,{expires:1}),I.set("refreshToken",V.refreshToken,{expires:30}),b({message:"Registration Successful! Redirecting...",type:"success"}),v(),setTimeout(()=>p("/login"),2e3)}catch(w){b({message:w.message,type:"danger"})}finally{y(!1)}};return e.createElement("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center"},e.createElement(W,null,e.createElement(K,{className:"justify-content-center"},e.createElement(X,{md:9,lg:7,xl:6},e.createElement(ee,{className:"mx-4"},e.createElement(te,{className:"p-4"},S?e.createElement(J,{...C},e.createElement(O,{onSubmit:a(U)},e.createElement("h1",{className:"text-center mb-4"},"Complete Registration"),E.message&&e.createElement(i,{color:E.type},E.message),e.createElement(o,{className:`mb-3 ${u.username?"is-invalid":""}`},e.createElement(s,null,e.createElement(h,{icon:H})),e.createElement(c,{placeholder:"Username",...g("username",{required:"Username is required"})})),u.username&&e.createElement(i,{color:"danger"},u.username.message),e.createElement(o,{className:"mb-3"},e.createElement(s,null,e.createElement(h,{icon:Q})),e.createElement(c,{type:N?"text":"password",placeholder:"Password",...g("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}})}),e.createElement(s,{role:"button",onClick:()=>j(r=>!r),style:{cursor:"pointer"}},N?"🙈":"👁️")),u.password&&e.createElement(i,{color:"danger"},u.password.message),e.createElement(o,{className:"mb-3"},e.createElement(s,null,"Role"),e.createElement(M,{...g("role")},e.createElement("option",{value:"super admin"},"Super Admin"),e.createElement("option",{value:"admin"},"Admin"),e.createElement("option",{value:"vendor"},"Vendor"),e.createElement("option",{value:"staff"},"Staff"))),B==="vendor"&&e.createElement(le,null),e.createElement("div",{className:"d-grid"},e.createElement(L,{color:"primary",type:"submit",disabled:P},P?e.createElement(_,{color:"light"}):"Register")))):e.createElement($,{email:m,setEmail:R,otpVerified:S,setOtpVerified:n,apiUrl:t})))))))}export{Ne as default};
