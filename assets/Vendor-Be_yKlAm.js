import{k as B,r as n,R as e,C as F,P as j}from"./index-qAjInVaZ.js";import{C as R,a as A}from"./CRow-CktHiRio.js";import{C as h,a as y}from"./CCardBody-DXOvSCcW.js";import{C as D,a as H,b as g,c as d,d as L,e as m}from"./CTable-3eKYyPNy.js";import{b as c,a as z}from"./CContainer-CPP8_u0b.js";import{e as q,f as G,g as I,h as J,j as K}from"./CNavItem-BK7iTdnI.js";import{C as k}from"./CCardHeader-CANAulHu.js";import{C as S}from"./CForm-BC9QhIXx.js";import{C as N}from"./CFormControlWrapper-DILRo1BL.js";import{C as O}from"./CFormInput-DahtiFNR.js";import"./CCloseButton-Bpa28C6a.js";const v="https://backend-log2.axleshift.com/api/v1/auth",Q=()=>{const{accessToken:l}=B(),[r,i]=n.useState([]),[E,C]=n.useState(!0),[f,o]=n.useState(!1),[s,M]=n.useState(null),[b,p]=n.useState(null);n.useEffect(()=>{if(!l)return;(async()=>{try{const a=await fetch(`${v}/users`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`}});if(!a.ok)throw new Error(`HTTP error! Status: ${a.status}`);const u=(await a.json()).users.filter(_=>_.role==="vendor");i(u)}catch(a){console.error("Error fetching users:",a),i([])}finally{C(!1)}})()},[l]);const w=(t,a)=>{i(T=>T.map(u=>u._id===t?{...u,status:a}:u))},P=async t=>{if(l){p(t);try{const a=await fetch(`${v}/approve/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`}});a.ok?w(t,"Approved"):console.error("Error approving user",a.statusText)}catch(a){console.error("Error approving user:",a)}finally{p(null)}}},x=async t=>{if(l){p(t);try{const a=await fetch(`${v}/cancel-approval/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`}});a.ok?w(t,"Pending"):console.error("Error canceling approval:",a.statusText)}catch(a){console.error("Error canceling approval:",a)}finally{p(null)}}},V=t=>{M(t),o(!0)},U=t=>{switch(t){case"Approved":return"success";case"Pending":return"warning";default:return"secondary"}};return e.createElement(e.Fragment,null,e.createElement(R,null,e.createElement(A,{xs:"12"},e.createElement(h,{className:"shadow-lg"},e.createElement(y,null,e.createElement("h4",{className:"text-primary"},"Vendor Management"),E?e.createElement("div",{className:"d-flex justify-content-center"},e.createElement(F,{color:"primary"})):e.createElement(D,{striped:!0,bordered:!0,hover:!0,responsive:!0},e.createElement(H,{className:"bg-light"},e.createElement(g,null,e.createElement(d,null,"User ID"),e.createElement(d,null,"Email"),e.createElement(d,null,"Status"),e.createElement(d,null,"Role"),e.createElement(d,null,"Actions"))),e.createElement(L,null,r.length>0?r.map(t=>e.createElement(g,{key:t._id,className:"text-center"},e.createElement(m,null,t._id),e.createElement(m,null,t.email),e.createElement(m,null,e.createElement(c,{color:U(t.status),className:"mr-2"},t.status)),e.createElement(m,null,t.role),e.createElement(m,null,e.createElement(c,{color:"info",onClick:()=>V(t),className:"mr-2"},"View Details"),t.status==="Approved"?e.createElement(c,{color:"warning",onClick:()=>x(t._id),className:"ml-2",disabled:b===t._id},"Cancel Approval"):e.createElement(c,{color:"success",onClick:()=>P(t._id),className:"ml-2",disabled:b===t._id},"Approve")))):e.createElement(g,null,e.createElement(m,{colSpan:"5",className:"text-center"},"No vendors found.")))))))),e.createElement(q,{visible:f,onClose:()=>o(!1),className:"bg-light"},e.createElement(G,{onClose:()=>o(!1)},e.createElement(I,null,"User Details")),e.createElement(J,null,s&&e.createElement("div",null,e.createElement("p",null,e.createElement("strong",null,"User ID:")," ",s._id),e.createElement("p",null,e.createElement("strong",null,"Name:")," ",(s==null?void 0:s.name)||"N/A"),e.createElement("p",null,e.createElement("strong",null,"Email:")," ",s.email),e.createElement("p",null,e.createElement("strong",null,"Status:")," ",s.status),e.createElement("p",null,e.createElement("strong",null,"Role:")," ",s.role))),e.createElement(K,null,e.createElement(c,{color:"secondary",onClick:()=>o(!1)},"Close"))))},$=({vendorId:l})=>{const[r,i]=n.useState(""),[E,C]=n.useState(""),f=()=>{console.log(`Rating for vendor ${l}: ${r}`),console.log(`Review for vendor ${l}: ${E}`)};return e.createElement(h,null,e.createElement(k,null,"Vendor Profile"),e.createElement(y,null,e.createElement(S,null,e.createElement(N,{htmlFor:"rating"},"Rating"),e.createElement(O,{type:"number",id:"rating",value:r,onChange:o=>i(o.target.value),min:"1",max:"5"})),e.createElement(S,null,e.createElement(N,{htmlFor:"review"},"Review"),e.createElement("textarea",{id:"review",rows:"4",value:E,onChange:o=>C(o.target.value),className:"form-control"})),e.createElement(c,{color:"primary",onClick:f},"Submit Rating & Review")))};$.propTypes={vendorId:j.string.isRequired};const se=()=>{const[l,r]=n.useState("vendorManagement");return e.createElement(z,null,e.createElement(R,{className:"mb-3"},e.createElement(A,null,e.createElement(h,null,e.createElement(k,null,e.createElement(c,{color:l==="vendorManagement"?"primary":"secondary",onClick:()=>r("vendorManagement"),className:"ms-2"},"Vendor Management"),e.createElement(c,{color:l==="vendorProfile"?"primary":"secondary",onClick:()=>r("vendorProfile"),className:"ms-2"},"Vendor Profile")),e.createElement(y,null,l==="vendorManagement"?e.createElement(Q,null):e.createElement($,null))))))};export{se as default};
