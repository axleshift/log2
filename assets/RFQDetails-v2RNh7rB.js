import{y as _,i as $,r as s,R as e,C as H}from"./index-BymYdVf9.js";import{a as S}from"./index-C88pvD_q.js";import{C as P,a as L}from"./CCardBody-DKAj1_EX.js";import{C as U}from"./CCardHeader-C8qsqDXX.js";import{b as d}from"./CContainer-BW6RyZoO.js";import{C as F}from"./DefaultLayout-CguGU2D0.js";import{C as B,a as I,b as o,c as r,d as T,e as a}from"./CTable-BSOgMIVc.js";import{C as j,a as O,b as z,c as G}from"./CModalHeader-CSRrgwEo.js";import"./index.esm-Cw0dBaxO.js";import"./CNavItem-BBtPj2Ni.js";import"./CCloseButton-CoMusDxn.js";import"./cil-user-Ddrdy7PS.js";import"./index-CiGjFrqD.js";const k="https://backend-log2.axleshift.com/api/v1/rfq",se=()=>{var y,b,v,N,h,Q,R;const{id:u}=_(),q=$(),[l,C]=s.useState(null),[A,E]=s.useState(!0),[g,p]=s.useState(null),[m,w]=s.useState(null),[x,i]=s.useState(!1);s.useEffect(()=>{(async()=>{var n,c;if(!u){p("Invalid RFQ ID"),E(!1);return}try{E(!0);const{data:f}=await S.get(`${k}/${u}`);C(f.rfq)}catch(f){p(((c=(n=f.response)==null?void 0:n.data)==null?void 0:c.message)||"Failed to load RFQ")}finally{E(!1)}})()},[u]);const D=t=>{w(t),i(!0)},V=async()=>{var t,n;if(m)try{const{data:c}=await S.put(`${k}/${u}/accept-quote`,{quoteId:m._id});C(c.rfq),i(!1)}catch(c){p(((n=(t=c.response)==null?void 0:t.data)==null?void 0:n.message)||"Failed to accept quote")}};if(A)return e.createElement(H,{color:"primary"});if(g)return e.createElement("div",{className:"text-danger"},g);if(!l)return e.createElement("div",null,"No RFQ found.");const M=((y=l.requestedBy)==null?void 0:y.email)||((v=(b=l.procurementId)==null?void 0:b.requestedBy)==null?void 0:v.email)||"Unknown";return e.createElement(P,null,e.createElement(U,{className:"d-flex justify-content-between align-items-center"},e.createElement("h5",null,"RFQ Details"),e.createElement(d,{color:"secondary",onClick:()=>q(-1)},"Back")),e.createElement(L,null,e.createElement("div",{className:"row mb-3"},e.createElement("div",{className:"col-md-6"},e.createElement("strong",null,"RFQ ID:")," ",l._id),e.createElement("div",{className:"col-md-6"},e.createElement("strong",null,"Title:")," ",((N=l.procurementId)==null?void 0:N.title)||"N/A"),e.createElement("div",{className:"col-md-6"},e.createElement("strong",null,"Description:")," ",((h=l.procurementId)==null?void 0:h.description)||"No description available"),e.createElement("div",{className:"col-md-6"}," ",e.createElement("strong",null,"Requested By:")," ",M),e.createElement("div",{className:"col-md-6"},e.createElement("strong",null,"Status:")," ",e.createElement(F,{color:l.status==="Open"?"success":"danger"},l.status))),e.createElement("h6",null,e.createElement("strong",null,"Items")),e.createElement(B,{hover:!0,responsive:!0},e.createElement(I,null,e.createElement(o,null,e.createElement(r,null,"Name"),e.createElement(r,null,"Quantity"),e.createElement(r,null,"Unit"))),e.createElement(T,null,l.products.length?l.products.map((t,n)=>e.createElement(o,{key:n},e.createElement(a,null,t.name),e.createElement(a,null,t.quantity),e.createElement(a,null,t.unit))):e.createElement(o,null,e.createElement(a,{colSpan:"3"},"No products listed")))),e.createElement("h6",null,e.createElement("strong",null,"Submitted Quotes")),e.createElement(B,{hover:!0,responsive:!0},e.createElement(I,null,e.createElement(o,null,e.createElement(r,null,"Vendor"),e.createElement(r,null,"Price"),e.createElement(r,null,"Lead Time"),e.createElement(r,null,"Terms"),e.createElement(r,null,"Status"),e.createElement(r,null,"Action"))),e.createElement(T,null,l.quotes.length?l.quotes.map(t=>{var n;return e.createElement(o,{key:t._id},e.createElement(a,null,((n=t.vendorId)==null?void 0:n.businessName)||"No Vendor"),e.createElement(a,null,t.totalPrice),e.createElement(a,null,t.leadTime),e.createElement(a,null,t.terms),e.createElement(a,null,e.createElement(F,{color:t.status==="Accepted"?"success":"warning"},t.status)),e.createElement(a,null,l.status!=="Closed"&&e.createElement(d,{color:"primary",onClick:()=>D(t)},"Accept")))}):e.createElement(o,null,e.createElement(a,{colSpan:"6"},"No quotes submitted yet.")))),e.createElement("h6",null,e.createElement("strong",null,"Selected Vendor:")," ",((Q=l.selectedVendor)==null?void 0:Q.businessName)||"No vendor selected")),e.createElement(j,{visible:x,onClose:()=>i(!1)},e.createElement(O,{closeButton:!0},"Confirm Quote Selection"),e.createElement(z,null,"Accept quote from ",e.createElement("strong",null,(R=m==null?void 0:m.vendorId)==null?void 0:R.businessName),"?"),e.createElement(G,null,e.createElement(d,{color:"secondary",onClick:()=>i(!1)},"Cancel"),e.createElement(d,{color:"primary",onClick:V},"Confirm"))))};export{se as default};
