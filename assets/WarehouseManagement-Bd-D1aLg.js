import{r as d,_ as R,R as E,a as I,c as G,P as _,f as P,j as e,C as V}from"./index-CBibLMk7.js";import{C as $,a as h}from"./CContainer-_BzGSDq9.js";import{C as q,a as H,b as O,c as U,d as A}from"./CModalTitle-cZi55D_N.js";import{C as B}from"./CForm-D9uU9QSo.js";import{a as T,b as p,C as v}from"./CFormInput-D_04IyqU.js";import{C as J}from"./CAlert-B4UE7Blg.js";import{C as K,a as Q}from"./CListGroupItem-B4_HiJQX.js";import"./js.cookie-Bgi00-Wx.js";import"./simplebar.min-Il_Smm22.js";import"./Transition-B3wsVLqJ.js";import"./CNavItem-IxH7X29L.js";var M=d.forwardRef(function(t,m){var s,u=t.children,w=t.className,f=t.feedback,y=t.feedbackInvalid,i=t.feedbackValid,C=t.floatingClassName,D=t.floatingLabel,N=t.htmlSize,c=t.id,b=t.invalid,W=t.label,x=t.options,n=t.size,k=t.text,F=t.tooltipFeedback,g=t.valid,j=R(t,["children","className","feedback","feedbackInvalid","feedbackValid","floatingClassName","floatingLabel","htmlSize","id","invalid","label","options","size","text","tooltipFeedback","valid"]);return E.createElement(T,{describedby:j["aria-describedby"],feedback:f,feedbackInvalid:y,feedbackValid:i,floatingClassName:C,floatingLabel:D,id:c,invalid:b,label:W,text:k,tooltipFeedback:F,valid:g},E.createElement("select",I({id:c,className:G("form-select",(s={},s["form-select-".concat(n)]=n,s["is-invalid"]=b,s["is-valid"]=g,s),w),size:N},j,{ref:m}),x?x.map(function(a,o){return E.createElement("option",I({},typeof a=="object"&&a.disabled&&{disabled:a.disabled},typeof a=="object"&&a.value!==void 0&&{value:a.value},{key:o}),typeof a=="string"?a:a.label)}):u))});M.propTypes=I({className:_.string,htmlSize:_.number,options:_.array},T.propTypes);M.displayName="CFormSelect";const L="http://localhost:5058/api/v1/warehouse",ce=()=>{const[t,m]=d.useState([]),[s,u]=d.useState({name:"",location:"",capacity:"",type_of_goods:"",customCapacity:""}),[w,f]=d.useState(!0),[y,i]=d.useState(null),[C,D]=d.useState(null),[N,c]=d.useState(!1),b=P(),W=["Low","Medium","Full","Custom"],x={Low:10,Medium:50,Full:100,Custom:a=>a?parseInt(a,10):0};d.useEffect(()=>{(async()=>{try{f(!0);const o=await fetch(L);if(!o.ok)throw new Error("Failed to fetch warehouses");const r=await o.json();m(r)}catch{i("Failed to load warehouses")}finally{f(!1)}})()},[]);const n=a=>{const{name:o,value:r}=a.target;u({...s,[o]:r})},k=()=>{const a=t[t.length-1];let o=0;if(a){const l=parseInt(a.warehouse_id.replace("WH",""),10);isNaN(l)||(o=l)}return`WH${(o+1).toString().padStart(3,"0")}`},F=async a=>{a.preventDefault();let o=0;s.capacity==="Custom"?o=s.customCapacity?parseInt(s.customCapacity,10):0:o=x[s.capacity]||0;const r={warehouse_id:k(),name:s.name,location:s.location,capacity:o,type_of_goods:s.type_of_goods};if(!r.name||!r.location||!r.capacity||!r.type_of_goods){i("Please fill all fields to create a new warehouse.");return}try{const l=await fetch(L,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!l.ok){const S=await l.text();throw new Error(S||"Failed to create warehouse")}const z=await l.json();m(S=>[...S,z]),u({name:"",location:"",capacity:"",type_of_goods:"",customCapacity:""}),c(!1),i(null)}catch(l){i("Failed to create warehouse: "+l.message)}},g=async a=>{if(!a){i("Warehouse ID is undefined. Unable to delete.");return}try{if(!(await fetch(`${L}/${a}`,{method:"DELETE"})).ok)throw new Error("Failed to delete warehouse");m(r=>r.filter(l=>l.warehouse_id!==a)),i(null)}catch(o){i("Failed to delete warehouse: "+o.message)}},j=a=>{b(`/warehouseDetail/${a}`)};return e.jsxs($,{children:[e.jsx("h1",{className:"mb-4",children:"Warehouse Management"}),e.jsx(h,{color:"primary",onClick:()=>c(!0),className:"mb-4",children:"Create Warehouse"}),e.jsxs(q,{visible:N,onClose:()=>c(!1),children:[e.jsx(H,{onClose:()=>c(!1),children:e.jsx(O,{children:C?"Edit Warehouse":"Create New Warehouse"})}),e.jsx(U,{children:e.jsxs(B,{onSubmit:F,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"name",children:"Warehouse Name"}),e.jsx(v,{id:"name",name:"name",type:"text",placeholder:"Enter warehouse name",value:s.name,onChange:n,required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"location",children:"Location"}),e.jsx(v,{id:"location",name:"location",type:"text",placeholder:"Enter warehouse location",value:s.location,onChange:n,required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"capacity",children:"Capacity"}),e.jsxs(M,{id:"capacity",name:"capacity",value:s.capacity,onChange:n,required:!0,children:[e.jsx("option",{value:"",children:"Select capacity"}),W.map((a,o)=>e.jsx("option",{value:a,children:a},o))]})]}),s.capacity==="Custom"&&e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"customCapacity",children:"Custom Capacity"}),e.jsx(v,{id:"customCapacity",name:"customCapacity",type:"text",placeholder:"Enter custom capacity",value:s.customCapacity||"",onChange:n})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(p,{htmlFor:"type_of_goods",children:"Type of Goods"}),e.jsx(v,{id:"type_of_goods",name:"type_of_goods",type:"text",placeholder:"Enter type of goods stored",value:s.type_of_goods,onChange:n,required:!0})]}),e.jsxs(A,{children:[e.jsx(h,{color:"secondary",onClick:()=>c(!1),children:"Close"}),e.jsx(h,{type:"submit",color:"primary",children:C?"Update Warehouse":"Create Warehouse"})]})]})})]}),e.jsx("h2",{className:"mt-4",children:"Warehouse List"}),w&&e.jsx(V,{}),y&&e.jsx(J,{color:"danger",children:y}),e.jsx(K,{children:t.map(a=>e.jsxs(Q,{children:[e.jsx("h4",{children:a.name}),e.jsx("p",{children:a.location}),e.jsxs("p",{children:["Capacity: ",a.capacity]}),e.jsxs("p",{children:["Type of Goods: ",a.type_of_goods]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(h,{color:"info",onClick:()=>j(a.warehouse_id),children:"View Details"}),e.jsx(h,{color:"danger",onClick:()=>g(a.warehouse_id),children:"Delete"})]})]},a.warehouse_id))})]})};export{ce as default};
