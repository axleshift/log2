import{u as z,r as a,R as e,C as E}from"./index-Czk1en48.js";import{a as h}from"./index-xsH4HHeE.js";import{C as D}from"./CFormSelect-DbfrKTkb.js";import{a as M}from"./CFormInput-BMJoeGH4.js";import{e as H,f as U,g as v,h as p,j as W,k as i,l as O,m as G,n as J,o as K}from"./CTable-D_U4Alk1.js";import{c as m}from"./CRow-COWDqcej.js";import{a as X,b as Y,c as Z,d as q}from"./DefaultLayout-RSXezbv-.js";import"./CCloseButton-jv1sHiMY.js";import"./CFormTextarea-CbFIJlat.js";import"./CForm-DpxG6y2y.js";import"./index.esm-Cuh8qHpg.js";import"./CCardBody-Fly4LOGC.js";import"./CCardHeader-DYgh3k3A.js";import"./CAlert-DUOQnrT6.js";import"./cil-user-Ddrdy7PS.js";import"./index-lIfIVm9I.js";const ee="https://backend-log2.axleshift.com",b=`${ee}/api/v1/vendor-quotes`,ge=()=>{var F,w;const{accessToken:f}=z(),[N,y]=a.useState([]),[S,I]=a.useState([]),[r,R]=a.useState(null),[d,k]=a.useState("All"),[u,$]=a.useState(""),[B,C]=a.useState(!1),[P,A]=a.useState(!1),[n,g]=a.useState(null),[o,T]=a.useState({visible:!1,message:"",color:""});a.useEffect(()=>{Q()},[]),a.useEffect(()=>{V()},[N,d,u]);const Q=async()=>{A(!0);try{const t=await h.get(b,{headers:{Authorization:`Bearer ${f}`}});y(t.data)}catch(t){console.error("Failed to fetch vendor quotes",t),c("Failed to fetch vendor quotes","danger")}finally{A(!1)}},V=()=>{let t=[...N];if(d!=="All"&&(t=t.filter(l=>l.status===d)),u.trim()){const l=u.toLowerCase();t=t.filter(s=>{var x,L;return(((x=s.vendorId)==null?void 0:x.businessName)||((L=s.vendorId)==null?void 0:L.fullName)||"").toLowerCase().includes(l)})}I(t)},c=(t,l="success")=>{T({visible:!0,message:t,color:l})},_=async(t,l)=>{g(t);try{await h.put(`${b}/${t}/status`,{status:l},{headers:{Authorization:`Bearer ${f}`}}),await Q(),c(`Quote ${l.toLowerCase()} successfully!`)}catch(s){console.error("Failed to update status",s),c("Failed to update status","danger")}finally{g(null)}},j=async t=>{try{await h.delete(`${b}/${t}`,{headers:{Authorization:`Bearer ${f}`}}),y(l=>l.filter(s=>s._id!==t)),c("Quote deleted successfully!")}catch(l){console.error("Failed to delete quote",l),c("Failed to delete quote","danger")}finally{g(null)}};return e.createElement("div",{className:"p-4 max-w-4xl mx-auto"},e.createElement("h1",{className:"mb-4 fw-bold"},"RFQ Details â€“ Submitted Quotes"),e.createElement("div",{className:"d-flex justify-content-between mb-3"},e.createElement(D,{value:d,onChange:t=>k(t.target.value),style:{maxWidth:200}},e.createElement("option",{value:"All"},"All"),e.createElement("option",{value:"Pending"},"Pending"),e.createElement("option",{value:"Accepted"},"Accepted"),e.createElement("option",{value:"Rejected"},"Rejected")),e.createElement(M,{placeholder:"Search Vendor",value:u,onChange:t=>$(t.target.value),style:{maxWidth:300}})),P?e.createElement("div",{className:"text-center my-5"},e.createElement(E,null),e.createElement("div",null,"Loading quotes...")):e.createElement(H,{striped:!0,hover:!0,responsive:!0},e.createElement(U,null,e.createElement(v,null,e.createElement(p,null,"Vendor Name"),e.createElement(p,null,"Price"),e.createElement(p,null,"Status"),e.createElement(p,null,"Actions"))),e.createElement(W,null,S.length===0?e.createElement(v,null,e.createElement(i,{colSpan:4,className:"text-center"},"No quotes found.")):S.map(t=>{var l,s;return e.createElement(v,{key:t._id},e.createElement(i,null,((l=t.vendorId)==null?void 0:l.businessName)||((s=t.vendorId)==null?void 0:s.fullName)||"N/A"),e.createElement(i,null,Number(t.price).toLocaleString()),e.createElement(i,null,t.status),e.createElement(i,null,e.createElement(m,{color:"info",onClick:()=>{R(t),C(!0)},disabled:n===t._id},"View"),t.status==="Pending"&&e.createElement(e.Fragment,null,e.createElement(m,{color:"success",className:"ms-2",onClick:()=>_(t._id,"Accepted"),disabled:n===t._id},n===t._id?e.createElement(E,{size:"sm"}):"Accept"),e.createElement(m,{color:"danger",className:"ms-2",onClick:()=>_(t._id,"Rejected"),disabled:n===t._id},n===t._id?e.createElement(E,{size:"sm"}):"Reject")),e.createElement(m,{color:"danger",className:"ms-2",onClick:()=>j(t._id),disabled:n===t._id},n===t._id?e.createElement(E,{size:"sm"}):"Delete")))}))),e.createElement(O,{visible:B,onClose:()=>C(!1)},e.createElement(G,{closeButton:!0},"Quote Details"),e.createElement(J,null,r&&e.createElement(e.Fragment,null,e.createElement("p",null,e.createElement("strong",null,"Vendor:")," ",((F=r.vendorId)==null?void 0:F.businessName)||((w=r.vendorId)==null?void 0:w.fullName)||"N/A"),e.createElement("p",null,e.createElement("strong",null,"Price:"),Number(r.price).toLocaleString()),e.createElement("p",null,e.createElement("strong",null,"Details:")," ",r.details||"No details provided."),e.createElement("p",null,e.createElement("strong",null,"Lead Time:")," ",r.leadTime||"No lead time specified."),e.createElement("p",null,e.createElement("strong",null,"Terms:")," ",r.terms||"No terms specified."))),e.createElement(K,null,e.createElement(m,{color:"secondary",onClick:()=>C(!1)},"Close"))),e.createElement(X,{placement:"top-end"},o.visible&&e.createElement(Y,{color:o.color,autohide:!0,delay:3e3,show:o.visible,fade:!0,onClose:()=>T({visible:!1,message:"",color:""})},e.createElement(Z,null,o.color==="danger"?"Error":"Success"),e.createElement(q,null,o.message))))};export{ge as default};
