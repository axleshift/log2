import{r as c,f as D,j as e,C as L}from"./index-CG5cXGW0.js";import{C as I,a as d}from"./CContainer-DZvKed_E.js";import{C as k,a as T,b as G,c as $,d as q}from"./CModalTitle-D3ihixE_.js";import{C as H}from"./CForm-BCrxAxUr.js";import{a as h,C as m}from"./CFormInput-WRbFKXpa.js";import{C as O}from"./CFormSelect-uzXXOHJV.js";import{C as U}from"./CAlert-TWNuonwF.js";import{C as A,a as P}from"./CListGroupItem-BfyemgFz.js";import"./CCloseButton-viBWZYHx.js";import"./simplebar.min-Z0vrnpZ0.js";import"./Transition-DONipWBO.js";import"./CNavItem-RDe7WxqJ.js";const f="https://backend-log2.axleshift.com/api/v1/warehouse",te=()=>{const[u,p]=c.useState([]),[t,C]=c.useState({name:"",location:"",capacity:"",type_of_goods:"",customCapacity:""}),[w,x]=c.useState(!0),[j,n]=c.useState(null),[g,R]=c.useState(null),[_,i]=c.useState(!1),W=D(),b=["Low","Medium","Full","Custom"],v={Low:10,Medium:50,Full:100,Custom:a=>a?parseInt(a,10):0};c.useEffect(()=>{(async()=>{try{x(!0);const o=await fetch(f);if(!o.ok)throw new Error("Failed to fetch warehouses");const s=await o.json();p(s)}catch{n("Failed to load warehouses")}finally{x(!1)}})()},[]);const l=a=>{const{name:o,value:s}=a.target;C({...t,[o]:s})},E=()=>{const a=u[u.length-1];let o=0;if(a){const r=parseInt(a.warehouse_id.replace("WH",""),10);isNaN(r)||(o=r)}return`WH${(o+1).toString().padStart(3,"0")}`},F=async a=>{a.preventDefault();let o=0;t.capacity==="Custom"?o=t.customCapacity?parseInt(t.customCapacity,10):0:o=v[t.capacity]||0;const s={warehouse_id:E(),name:t.name,location:t.location,capacity:o,type_of_goods:t.type_of_goods};if(!s.name||!s.location||!s.capacity||!s.type_of_goods){n("Please fill all fields to create a new warehouse.");return}try{const r=await fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!r.ok){const y=await r.text();throw new Error(y||"Failed to create warehouse")}const M=await r.json();p(y=>[...y,M]),C({name:"",location:"",capacity:"",type_of_goods:"",customCapacity:""}),i(!1),n(null)}catch(r){n("Failed to create warehouse: "+r.message)}},N=async a=>{if(!a){n("Warehouse ID is undefined. Unable to delete.");return}try{if(!(await fetch(`${f}/${a}`,{method:"DELETE"})).ok)throw new Error("Failed to delete warehouse");p(s=>s.filter(r=>r.warehouse_id!==a)),n(null)}catch(o){n("Failed to delete warehouse: "+o.message)}},S=a=>{W(`/warehouseDetail/${a}`)};return e.jsxs(I,{children:[e.jsx("h1",{className:"mb-4",children:"Warehouse Management"}),e.jsx(d,{color:"primary",onClick:()=>i(!0),className:"mb-4",children:"Create Warehouse"}),e.jsxs(k,{visible:_,onClose:()=>i(!1),children:[e.jsx(T,{onClose:()=>i(!1),children:e.jsx(G,{children:g?"Edit Warehouse":"Create New Warehouse"})}),e.jsx($,{children:e.jsxs(H,{onSubmit:F,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(h,{htmlFor:"name",children:"Warehouse Name"}),e.jsx(m,{id:"name",name:"name",type:"text",placeholder:"Enter warehouse name",value:t.name,onChange:l,required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(h,{htmlFor:"location",children:"Location"}),e.jsx(m,{id:"location",name:"location",type:"text",placeholder:"Enter warehouse location",value:t.location,onChange:l,required:!0})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(h,{htmlFor:"capacity",children:"Capacity"}),e.jsxs(O,{id:"capacity",name:"capacity",value:t.capacity,onChange:l,required:!0,children:[e.jsx("option",{value:"",children:"Select capacity"}),b.map((a,o)=>e.jsx("option",{value:a,children:a},o))]})]}),t.capacity==="Custom"&&e.jsxs("div",{className:"mb-3",children:[e.jsx(h,{htmlFor:"customCapacity",children:"Custom Capacity"}),e.jsx(m,{id:"customCapacity",name:"customCapacity",type:"text",placeholder:"Enter custom capacity",value:t.customCapacity||"",onChange:l})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(h,{htmlFor:"type_of_goods",children:"Type of Goods"}),e.jsx(m,{id:"type_of_goods",name:"type_of_goods",type:"text",placeholder:"Enter type of goods stored",value:t.type_of_goods,onChange:l,required:!0})]}),e.jsxs(q,{children:[e.jsx(d,{color:"secondary",onClick:()=>i(!1),children:"Close"}),e.jsx(d,{type:"submit",color:"primary",children:g?"Update Warehouse":"Create Warehouse"})]})]})})]}),e.jsx("h2",{className:"mt-4",children:"Warehouse List"}),w&&e.jsx(L,{}),j&&e.jsx(U,{color:"danger",children:j}),e.jsx(A,{children:u.map(a=>e.jsxs(P,{children:[e.jsx("h4",{children:a.name}),e.jsx("p",{children:a.location}),e.jsxs("p",{children:["Capacity: ",a.capacity]}),e.jsxs("p",{children:["Type of Goods: ",a.type_of_goods]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(d,{color:"info",onClick:()=>S(a.warehouse_id),children:"View Details"}),e.jsx(d,{color:"danger",onClick:()=>N(a.warehouse_id),children:"Delete"})]})]},a.warehouse_id))})]})};export{te as default};
