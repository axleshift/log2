import{R as e,P as l,z,u as H,r as m,D as O,C as w}from"./index-DznbbmHq.js";import{a as F}from"./index-xsH4HHeE.js";import{c as V,d as j,n as Y,e as _,f as G,g as x,h as D,j as u,k as n,l as P,m as r}from"./CTable-L9EKVTuf.js";import{C as J}from"./CForm-D71oTwph.js";import{a as E}from"./CFormInput-DtjwLQkO.js";import{C as K}from"./CFormTextarea-BO9FFXJh.js";import{c as g}from"./CRow-Xtf4gk-Q.js";import{C as W,a as X}from"./CCardBody-kbmAcOpe.js";import{C as Z}from"./CCardHeader-C4KYOvKz.js";import{C as k}from"./CAlert-BniXiEjz.js";import{C as A}from"./DefaultLayout-DU-VXXEj.js";import"./CCloseButton-DirAFvMq.js";import"./CFormSelect-Dx6z8S3I.js";import"./index.esm-B9_GYmHU.js";import"./cil-user-Ddrdy7PS.js";import"./index-0GvwZ2J7.js";const U=({visible:d,onClose:s,quote:t,onChange:o,onSubmit:p})=>e.createElement(V,{visible:d,onClose:s},e.createElement(j,null,e.createElement(Y,null,"Submit Your Quote")),e.createElement(_,null,e.createElement(J,null,e.createElement(E,{type:"number",label:"Total Price",name:"totalPrice",value:t.totalPrice,onChange:o,placeholder:"Enter the total price",required:!0}),e.createElement(E,{type:"number",label:"Quantity",name:"quantity",value:t.quantity,onChange:o,placeholder:"Enter the quantity",required:!0}),e.createElement(E,{type:"text",label:"Lead Time",name:"leadTime",value:t.leadTime,onChange:o,placeholder:"Enter lead time (e.g., 3 days, 1 week)",required:!0}),e.createElement(K,{label:"Terms",name:"terms",value:t.terms,onChange:o,rows:"3",placeholder:"Enter terms and conditions (optional)"}),e.createElement(E,{type:"date",label:"Valid Until",name:"validUntil",value:t.validUntil,onChange:o,placeholder:"Enter validity date"}))),e.createElement(G,null,e.createElement(g,{color:"secondary",onClick:s},"Cancel"),e.createElement(g,{color:"primary",onClick:p},"Submit Quote")));U.propTypes={visible:l.bool.isRequired,onClose:l.func.isRequired,quote:l.shape({totalPrice:l.oneOfType([l.string,l.number]).isRequired,quantity:l.oneOfType([l.string,l.number]).isRequired,leadTime:l.string.isRequired,terms:l.string,validUntil:l.string}).isRequired,onChange:l.func.isRequired,onSubmit:l.func.isRequired};const fe=()=>{var T,N,q,Q,R,S;const{id:d}=z(),{accessToken:s}=H(),[t,o]=m.useState(null),[p,b]=m.useState(!0),[h,y]=m.useState(!1),[v,B]=m.useState(null),{showToast:f}=O(),[M,C]=m.useState(!1),[c,L]=m.useState({totalPrice:"",quantity:"",leadTime:"",terms:"",validUntil:"",status:"Pending"});m.useEffect(()=>{s&&(async()=>{b(!0);try{const i=await F.get(`https://backend-log2.axleshift.com/api/v1/rfq/vendor/rfqs/${d}`,{headers:{Authorization:`Bearer ${s}`}});o(i.data)}catch{B("Failed to load RFQ details.")}finally{b(!1)}})()},[d,s]);const I=a=>{L({...c,[a.target.name]:a.target.value})},$=async()=>{if(!c.totalPrice||!c.quantity||!c.leadTime){f("Please fill in all required fields.","warning");return}try{y(!0),await F.post(`https://backend-log2.axleshift.com/api/v1/rfq/vendor/rfqs/${d}/submit-quote`,{...c,quoteDate:new Date},{headers:{Authorization:`Bearer ${s}`}}),C(!1),y(!1),f("Quote submitted successfully!","success")}catch{y(!1),f("Failed to submit quote.","error")}};return e.createElement(W,{className:"shadow-sm"},e.createElement(Z,{className:"bg-primary text-white fw-bold"},"RFQ Details"),e.createElement(X,null,p?e.createElement("div",{className:"text-center my-3"},e.createElement(w,{color:"primary"})):v?e.createElement(k,{color:"danger",className:"text-center"},v):t?e.createElement(e.Fragment,null,e.createElement("div",{className:"row mb-3"},e.createElement("div",{className:"col-md-6"},e.createElement("strong",null,"RFQ ID:")," ",t._id),e.createElement("div",{className:"col-md-6"},e.createElement("strong",null,"Title:")," ",((T=t.procurementId)==null?void 0:T.title)||"N/A"),e.createElement("div",{className:"col-md-6"},e.createElement("strong",null,"Description:")," ",((N=t.procurementId)==null?void 0:N.description)||"No description available"),e.createElement("div",{className:"col-md-6"},e.createElement("strong",null,"Status:"),e.createElement(A,{color:t.status==="Open"?"success":t.status==="Closed"?"danger":"warning"},t.status)),e.createElement("div",{className:"col-md-6"},e.createElement("strong",null,"Requested By:")," ",((q=t==null?void 0:t.requestedBy)==null?void 0:q.email)||((R=(Q=t==null?void 0:t.procurementId)==null?void 0:Q.requestedBy)==null?void 0:R.email)||"Unknown"),e.createElement("div",{className:"col-md-6"},e.createElement("strong",null,"Created At:")," ",new Date(t.createdAt).toLocaleDateString())),e.createElement("hr",null),e.createElement("h6",null,e.createElement("strong",null,"Items")),e.createElement(x,{hover:!0,responsive:!0,className:"text-center"},e.createElement(D,null,e.createElement(u,null,e.createElement(n,null,"Name"),e.createElement(n,null,"Quantity"),e.createElement(n,null,"Unit"))),e.createElement(P,null,((S=t.products)==null?void 0:S.length)>0?t.products.map((a,i)=>e.createElement(u,{key:i},e.createElement(r,null,a.name||"No name"),e.createElement(r,null,a.quantity||"N/A"),e.createElement(r,null,a.unit||"No Unit"))):e.createElement(u,null,e.createElement(r,{colSpan:"3",className:"text-center"},"No products listed")))),e.createElement("h6",null,e.createElement("strong",null,"Submitted Quotes")),e.createElement(x,{hover:!0,responsive:!0,className:"text-center"},e.createElement(D,null,e.createElement(u,null,e.createElement(n,null,"Total Price"),e.createElement(n,null,"Quantity"),e.createElement(n,null,"Lead Time"),e.createElement(n,null,"Terms"),e.createElement(n,null,"Valid Until"),e.createElement(n,null,"Status"))),e.createElement(P,null,t.quotes.length>0?t.quotes.map((a,i)=>e.createElement(u,{key:i},e.createElement(r,null,a.totalPrice),e.createElement(r,null,a.quantity),e.createElement(r,null,a.leadTime),e.createElement(r,null,a.terms||"N/A"),e.createElement(r,null,a.validUntil?new Date(a.validUntil).toLocaleDateString():"N/A"),e.createElement(r,null,e.createElement(A,{color:a.status==="Approved"?"success":a.status==="Rejected"?"danger":"warning"},a.status)))):e.createElement(u,null,e.createElement(r,{colSpan:"6"},"No quotes submitted yet.")))),e.createElement(g,{color:"primary",className:"mt-3",onClick:()=>C(!0),disabled:h},h?e.createElement(w,{size:"sm"}):"Submit Quote"),e.createElement(U,{visible:M,onClose:()=>C(!1),quote:c,onChange:I,onSubmit:$})):e.createElement(k,{color:"warning",className:"text-center"},"RFQ not found.")))};export{fe as default};
