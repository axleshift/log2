import{u as M,r as a,R as e,C as j}from"./index-CZbhyFiD.js";import{C as z}from"./CAlert-D5Ki0zoC.js";import{a as L,b as H,c as i}from"./CRow-DAWJ6kQb.js";import{C as F,a as O}from"./CCardBody-D6vwvdO3.js";import{g as G,h as I,j as g,k as m,l as q,m as c,c as J,d as K,n as Q,e as W,f as X}from"./CTable-CR8nuKb2.js";import"./CCloseButton-BPwTVHYG.js";const Y="https://backend-log2.axleshift.com/api/v1/vendor",_="https://backend-log2.axleshift.com/api/v1/auth",le=()=>{var P,y,w,N,k,A;const{accessToken:l}=M(),[C,d]=a.useState([]),[S,T]=a.useState(!0),[V,p]=a.useState(!1),[r,R]=a.useState(null),[h,u]=a.useState(null),[v,o]=a.useState(null),[U,s]=a.useState(null);a.useEffect(()=>{if(!l)return;(async()=>{try{const n=await fetch(`${Y}/with-users`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`}});if(!n.ok)throw new Error(`HTTP error! Status: ${n.status}`);const E=await n.json();d(E.vendors)}catch(n){console.error("Error fetching vendors:",n),d([])}finally{T(!1)}})()},[l]);const b=(t,n)=>{d(E=>E.map(f=>f._id===t?{...f,status:n}:f))},x=async t=>{if(l){u(t);try{(await fetch(`${_}/approve/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`}})).ok?(b(t,"Approved"),o("User approved successfully!"),s("success")):(o("Error approving user."),s("danger"))}catch(n){console.error("Error approving user:",n),o("Error approving user."),s("danger")}finally{u(null)}}},B=async t=>{if(l){u(t);try{(await fetch(`${_}/cancel-approval/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`}})).ok?(b(t,"Pending"),o("Approval canceled successfully!"),s("warning")):(o("Error canceling approval."),s("danger"))}catch(n){console.error("Error canceling approval:",n),o("Error canceling approval."),s("danger")}finally{u(null)}}},$=t=>{R(t),p(!0)},D=t=>{switch(t){case"Approved":return"success";case"Pending":return"warning";default:return"secondary"}};return e.createElement(e.Fragment,null,v&&e.createElement(z,{color:U,className:"mt-3",closeButton:!0},v),e.createElement(L,null,e.createElement(H,{xs:"12"},e.createElement(F,{className:"shadow-lg"},e.createElement(O,null,S?e.createElement("div",{className:"d-flex justify-content-center"},e.createElement(j,{color:"primary"})):e.createElement(G,{striped:!0,bordered:!0,hover:!0,responsive:!0},e.createElement(I,{className:"bg-light"},e.createElement(g,null,e.createElement(m,null,"User ID"),e.createElement(m,null,"Email"),e.createElement(m,null,"Status"),e.createElement(m,null,"Role"),e.createElement(m,null,"Actions"))),e.createElement(q,null,C.length>0?C.map(t=>e.createElement(g,{key:t._id,className:"text-center"},e.createElement(c,null,t._id),e.createElement(c,null,t.email),e.createElement(c,null,e.createElement(i,{color:D(t.status),className:"mr-2"},t.status)),e.createElement(c,null,t.role),e.createElement(c,null,e.createElement(i,{color:"info",onClick:()=>$(t),className:"mr-2"},"View Details"),t.status==="Approved"?e.createElement(i,{color:"warning",onClick:()=>B(t._id),className:"ml-2",disabled:h===t._id},"Cancel Approval"):e.createElement(i,{color:"success",onClick:()=>x(t._id),className:"ml-2",disabled:h===t._id},"Approve")))):e.createElement(g,null,e.createElement(c,{colSpan:"5",className:"text-center"},"No vendors found.")))))))),e.createElement(J,{visible:V,onClose:()=>p(!1)},e.createElement(K,{closeButton:!0,className:"bg-dark text-white"},e.createElement(Q,null,"Vendor Profile")),e.createElement(W,{className:"bg-dark text-white"},r&&e.createElement("div",{className:"p-2"},e.createElement("p",null,e.createElement("strong",null,"User ID:")," ",r._id),e.createElement("p",null,e.createElement("strong",null,"Email:")," ",r.email),e.createElement("p",null,e.createElement("strong",null,"Status:")," ",r.status),e.createElement("p",null,e.createElement("strong",null,"Role:")," ",r.role),r.vendorProfile?e.createElement(e.Fragment,null,e.createElement("p",null,e.createElement("strong",null,"Business Name:")," ",r.vendorProfile.businessName),e.createElement("p",null,e.createElement("strong",null,"Contact Number:")," ",r.vendorProfile.contactNumber),((P=r.vendorProfile.documents)==null?void 0:P.businessRegistrationCertificate)&&e.createElement("p",null,e.createElement("strong",null,"Business Registration Certificate:")," ",e.createElement("a",{href:r.vendorProfile.documents.businessRegistrationCertificate,target:"_blank",rel:"noopener noreferrer"},"View")),((y=r.vendorProfile.documents)==null?void 0:y.companyProfile)&&e.createElement("p",null,e.createElement("strong",null,"Company Profile:")," ",e.createElement("a",{href:r.vendorProfile.documents.companyProfile,target:"_blank",rel:"noopener noreferrer"},"View")),((w=r.vendorProfile.documents)==null?void 0:w.isoCertification)&&e.createElement("p",null,e.createElement("strong",null,"ISO Certification:")," ",e.createElement("a",{href:r.vendorProfile.documents.isoCertification,target:"_blank",rel:"noopener noreferrer"},"View")),((N=r.vendorProfile.documents)==null?void 0:N.authorizationCertificate)&&e.createElement("p",null,e.createElement("strong",null,"Authorization Certificate:")," ",e.createElement("a",{href:r.vendorProfile.documents.authorizationCertificate,target:"_blank",rel:"noopener noreferrer"},"View")),((k=r.vendorProfile.documents)==null?void 0:k.complianceDeclaration)&&e.createElement("p",null,e.createElement("strong",null,"Compliance Declaration:")," ",e.createElement("a",{href:r.vendorProfile.documents.complianceDeclaration,target:"_blank",rel:"noopener noreferrer"},"View")),((A=r.vendorProfile.documents)==null?void 0:A.productCatalog)&&e.createElement("p",null,e.createElement("strong",null,"Product Catalog:")," ",e.createElement("a",{href:r.vendorProfile.documents.productCatalog,target:"_blank",rel:"noopener noreferrer"},"View"))):e.createElement("p",{className:"text-muted"},"No vendor profile attached."))),e.createElement(X,{className:"bg-dark"},e.createElement(i,{color:"secondary",onClick:()=>p(!1)},"Close"))))};export{le as default};
