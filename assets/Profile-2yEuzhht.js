import{u as I,r as h,R as e}from"./index-DznbbmHq.js";import{a as P}from"./index-xsH4HHeE.js";import{C as x,a as k}from"./CCardBody-kbmAcOpe.js";import{C as L}from"./CCardHeader-C4KYOvKz.js";import{a as E,b as l,c as S}from"./CRow-Xtf4gk-Q.js";import{u as F}from"./CTable-L9EKVTuf.js";import{C as R}from"./CForm-D71oTwph.js";import{C as m,a as i}from"./CFormInput-DtjwLQkO.js";import"./CCloseButton-DirAFvMq.js";const j=()=>{const v="https://backend-log2.axleshift.com/api/v1/profile",{accessToken:d,user:s,profile:t,setProfile:u}=I(),[g,f]=h.useState("https://placehold.co/150"),[C,p]=h.useState(!0),[b,c]=h.useState(null),[N,y]=h.useState(!1),w=async()=>{if(!(s!=null&&s._id)||!d)return c("User ID or Access Token is missing.");try{const r=(await P.get(`${v}/${s._id}`,{headers:{Authorization:`Bearer ${d}`},timeout:5e3})).data;r.email?(u(r),f(r.avatar||"https://placehold.co/150")):c("Email is required in profile data."),localStorage.setItem("profile",JSON.stringify(r)),p(!1)}catch{c("Error fetching profile."),p(!1)}};h.useEffect(()=>{s&&d&&!t?w():t&&(f(t.avatar||"https://placehold.co/150"),p(!1))},[s,d,t]);const n=a=>{const{name:r,value:o}=a.target;u(A=>({...A,[r]:o||""}))},$=async a=>{if(a.preventDefault(),!t.email){c("Email is required.");return}p(!0);try{const o=(await P.put(`${v}/${s._id}`,t,{headers:{Authorization:`Bearer ${d}`}})).data;localStorage.setItem("profile",JSON.stringify(o)),u(o),f(o.avatar||"https://placehold.co/150"),c(null)}catch{c("There was an issue updating your profile.")}finally{p(!1)}};return C?e.createElement("div",null,"Loading..."):t?e.createElement("div",{className:"profile-page"},e.createElement(x,{className:"mb-4"},e.createElement(L,null,e.createElement("h5",null,"User Profile")),e.createElement(k,null,b&&e.createElement("div",{className:"alert alert-danger"},b),e.createElement(E,null,e.createElement(l,{md:3,className:"text-center"},e.createElement(F,{src:g.startsWith("http")?g:`/src/assets/images/${g}`,alt:"Profile Picture",className:"mb-3",rounded:!0,width:150}),e.createElement(S,{color:"primary",onClick:()=>y(!N)},"Choose Avatar"),N&&e.createElement("div",{className:"d-flex flex-wrap justify-content-center mt-3"},avatarOptions.map((a,r)=>e.createElement(F,{key:r,src:`/src/assets/images/${a}`,alt:`Avatar ${r+1}`,width:60,height:60,className:`m-2 avatar-option ${t.avatar===a?"selected":""}`,onClick:()=>{u(o=>({...o,avatar:a})),f(a),y(!1)},style:{cursor:"pointer",borderRadius:"50%",border:t.avatar===a?"3px solid blue":"none"}})))),e.createElement(l,{md:9},e.createElement("h6",{className:"mb-4"},"Personal Details"),e.createElement(R,{onSubmit:$},e.createElement(E,{className:"mb-3"},e.createElement(l,{md:6},e.createElement(m,{htmlFor:"firstName"},"First Name"),e.createElement(i,{id:"firstName",name:"firstName",value:t.firstName||"",onChange:n,placeholder:"Enter first name"})),e.createElement(l,{md:6},e.createElement(m,{htmlFor:"lastName"},"Last Name"),e.createElement(i,{id:"lastName",name:"lastName",value:t.lastName||"",onChange:n,placeholder:"Enter last name"}))),e.createElement(E,{className:"mb-3"},e.createElement(l,{md:6},e.createElement(m,{htmlFor:"email"},"Email"),e.createElement(i,{id:"email",name:"email",value:t.email||"",onChange:n,placeholder:"Enter email",disabled:!0})),e.createElement(l,{md:6},e.createElement(m,{htmlFor:"phone"},"Phone"),e.createElement(i,{id:"phone",name:"phone",value:t.phone||"",onChange:n,placeholder:"Enter phone number"}))),e.createElement(E,{className:"mb-3"},e.createElement(l,{md:6},e.createElement(m,{htmlFor:"address"},"Address"),e.createElement(i,{id:"address",name:"address",value:t.address||"",onChange:n,placeholder:"Enter address"})),e.createElement(l,{md:6},e.createElement(m,{htmlFor:"city"},"City"),e.createElement(i,{id:"city",name:"city",value:t.city||"",onChange:n,placeholder:"Enter city"})),e.createElement(l,{md:6},e.createElement(m,{htmlFor:"bio"},"Bio"),e.createElement(i,{id:"bio",name:"bio",value:t.bio||"",onChange:n,placeholder:"Enter bio"}))),e.createElement(S,{type:"submit",color:"primary",disabled:C},C?"Submitting...":"Save Changes"))))))):e.createElement("div",null,"No profile found. Please log in.")};export{j as default};
