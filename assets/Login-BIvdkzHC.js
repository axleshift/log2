import{f as O,r as a,j as e,L as c}from"./index-g0pqW7ck.js";import{u as U,c as G,p as j}from"./purify.es-D9zJbmHF.js";import{C}from"./index.esm-D3-yDp1K.js";import{F as q,d as V,e as z}from"./index-C_LsWKpG.js";import{a as y}from"./js.cookie-DCCPG9Ne.js";import{R as D}from"./recaptcha-wrapper-DFsmMHQl.js";import{C as W,a as l}from"./CContainer-Q6orkmqE.js";import{C as w,a as t}from"./CRow-DMUOOBum.js";import{C as B}from"./CCardGroup-CQOESIDd.js";import{C as _,a as $}from"./CCardBody-CJNadQcM.js";import{C as H}from"./CAlert-hWjT0Mi_.js";import{C as J}from"./CForm-Dk5WdL2p.js";import{C as N,a as b}from"./CInputGroupText-BY3IZtA-.js";import{c as M}from"./cil-user-Ddrdy7PS.js";import{C as S}from"./CFormInput-DmvkNggx.js";import"./Transition-CbQc5TrU.js";function de(){const L="undefined/api/v1/auth",{register:x,handleSubmit:k,formState:{errors:o},reset:P}=U(),R=O(),[n,m]=a.useState(!1),[d,i]=a.useState({message:"",type:""}),[h,T]=a.useState(!1),[f,g]=a.useState(null),p=a.useRef(),v=async r=>{const s=await fetch(`${L}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!s.ok){const u=await s.json();throw new Error(u.message||"Login failed")}return s.json()},I=async r=>{if(m(!0),i({message:"",type:""}),!f){i({message:"Please complete the reCAPTCHA",type:"danger"}),m(!1);return}try{const s={username:j.sanitize(r.username),password:j.sanitize(r.password),recaptchaToken:f},u=await v(s),{accessToken:E,refreshToken:F}=u;y.set("token",E,{expires:1}),y.set("refreshToken",F,{expires:1}),i({message:"Welcome back! Redirecting to your dashboard...",type:"success"}),P(),setTimeout(()=>R("/dashboard"),2e3)}catch(s){i({message:s.message,type:"danger"})}finally{m(!1),g(null),p.current&&p.current.reset()}},A=()=>{T(r=>!r)};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(W,{children:e.jsxs(w,{className:"justify-content-center",children:[e.jsxs(t,{md:4,className:"d-flex flex-column align-items-center justify-content-center bg-primary text-white",children:[e.jsx("h2",{children:"Vendor Portal"}),e.jsx("p",{children:"Logistic Management System"}),e.jsx(c,{to:"/",className:"text-white",children:"Landing page →"}),e.jsx(c,{to:"/supplierslogin",className:"text-white",children:"Supplier Login →"})]}),e.jsx(t,{md:5,children:e.jsx(B,{children:e.jsx(_,{className:"p-4",children:e.jsxs($,{children:[d.message&&e.jsx(H,{color:d.type,dismissible:!0,children:d.message}),e.jsxs(J,{onSubmit:k(I),children:[e.jsx("h1",{children:"Login"}),e.jsx("p",{className:"text-body-secondary",children:"Sign In to your account"}),e.jsxs(N,{className:"mb-3",children:[e.jsx(b,{children:e.jsx(C,{icon:M})}),e.jsx(S,{type:"text",placeholder:"Username",autoComplete:"username",...x("username",{required:"Username is required"})})]}),o.username&&e.jsx("p",{className:"text-danger",children:o.username.message}),e.jsxs(N,{className:"mb-4",children:[e.jsx(b,{children:e.jsx(C,{icon:G})}),e.jsx(S,{type:h?"text":"password",placeholder:"Password",autoComplete:"current-password",...x("password",{required:"Password is required"})}),e.jsx(l,{color:"secondary",variant:"outline",onClick:A,type:"button",children:e.jsx(q,{icon:h?V:z})})]}),o.password&&e.jsx("p",{className:"text-danger",children:o.password.message}),e.jsx("div",{className:"mb-3",children:e.jsx(D,{ref:p,sitekey:void 0,onChange:g})}),e.jsxs(w,{children:[e.jsx(t,{sm:5,children:e.jsx(l,{color:"success",variant:"outline",className:"px-4",type:"submit",disabled:n,children:n?"Logging in...":"LOGIN"})}),e.jsx(t,{xs:"auto",className:"me-auto",children:e.jsx(c,{to:"/forgotPass",children:e.jsx(l,{color:"danger",variant:"outline",className:"px-4",disabled:n,children:n?"Processing...":"FORGOT PASSWORD"})})}),e.jsx(t,{xs:4,children:e.jsx(c,{to:"/register",children:e.jsx(l,{color:"link",className:"px-0",children:"Register Now!"})})})]})]})]})})})})]})})})}export{de as default};
