import{f as A,r as s,j as e,L as m,g}from"./index-XyHrDUr1.js";import{u as O,c as _}from"./index.esm-BwutIiRz.js";import{C as j}from"./index.esm-MB9LxqRG.js";import{F,d as G,e as U}from"./index-BzNwzLXq.js";import{R as q,V}from"./config-DHgLX0af.js";import{C as D,a as d}from"./CContainer-ByZ92ki9.js";import{C as y,a}from"./CRow-RzJnCeXJ.js";import{C as W}from"./CCardGroup-CMWmIiYn.js";import{C as B,a as $}from"./CCardBody-CZtvl6iF.js";import{C as z}from"./CAlert-CjHSjr33.js";import{C as H}from"./CForm-Bl4c23yF.js";import{C,a as w}from"./CInputGroupText-Bb2GQFN4.js";import{c as J}from"./cil-user-Ddrdy7PS.js";import{C as S}from"./CFormInput-CX3mgzzM.js";import"./CCloseButton-SXzgWpFd.js";import"./Transition-B9s6pyla.js";const me=()=>{const b="undefined/api/v1/auth",{register:p,handleSubmit:N,formState:{errors:r},reset:P}=O(),R=A(),L=s.useRef(null),u=s.useRef(),[t,x]=s.useState(!1),[o,i]=s.useState({message:"",type:""}),[h,k]=s.useState(!1),T=async n=>{x(!0),i({message:"",type:""});try{const c=await u.current.executeAsync(),f=await fetch(`${b}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...n,recaptcha_ref:c})}),l=await f.json();if(console.log("Response Data:",l),!f.ok)throw new Error(l.message||"Login failed");const{accessToken:I,refreshToken:v}=l;g.set("token",I,{expires:1,secure:!0,httpOnly:!0,sameSite:"Strict"}),g.set("refreshToken",v,{expires:1,secure:!0,httpOnly:!0,sameSite:"Strict"}),i({message:"Welcome back! Redirecting to your dashboard...",type:"success"}),P(),setTimeout(()=>R("/dashboard"),2e3)}catch(c){i({message:c.message,type:"danger"})}finally{x(!1)}},E=()=>{k(n=>!n)};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsxs(D,{children:[e.jsx(q,{ref:u,size:"invisible",sitekey:V}),e.jsxs(y,{className:"justify-content-center",children:[e.jsxs(a,{md:4,className:"d-flex flex-column align-items-center justify-content-center bg-primary text-white",children:[e.jsx("h2",{children:"Vendor Portal"}),e.jsx("p",{children:"Logistic Management System"}),e.jsx(m,{to:"/supplierslogin",className:"text-white",children:"Supplier Page →"}),e.jsx(m,{to:"/",className:"text-white",children:"Landing Page →"})]}),e.jsx(a,{md:5,children:e.jsx(W,{children:e.jsx(B,{className:"p-4",children:e.jsxs($,{children:[o.message&&e.jsx(z,{color:o.type,dismissible:!0,children:o.message}),e.jsxs(H,{onSubmit:N(T),children:[e.jsx("h1",{children:"Login"}),e.jsx("p",{className:"text-body-secondary",children:"Sign In to your account"}),e.jsxs(C,{className:"mb-3",children:[e.jsx(w,{children:e.jsx(j,{icon:J})}),e.jsx(S,{ref:L,type:"text",placeholder:"Username",autoComplete:"username",...p("username",{required:"Username is required"})})]}),r.username&&e.jsx("p",{className:"text-danger",children:r.username.message}),e.jsxs(C,{className:"mb-4",children:[e.jsx(w,{children:e.jsx(j,{icon:_})}),e.jsx(S,{type:h?"text":"password",placeholder:"Password",autoComplete:"current-password",...p("password",{required:"Password is required"})}),e.jsx(d,{color:"secondary",variant:"outline",onClick:E,type:"button",children:e.jsx(F,{icon:h?G:U})})]}),r.password&&e.jsx("p",{className:"text-danger",children:r.password.message}),e.jsxs(y,{children:[e.jsx(a,{sm:5,children:e.jsx(d,{color:"success",variant:"outline",className:"px-4",type:"submit",disabled:t,children:t?"Logging in...":"LOGIN"})}),e.jsx(a,{xs:"auto",className:"me-auto",children:e.jsx(m,{to:"/forgotPass",children:e.jsx(d,{color:"danger",variant:"outline",className:"px-4",disabled:t,children:t?"Processing...":"FORGOT PASSWORD"})})})]})]})]})})})})]})]})})};export{me as default};
