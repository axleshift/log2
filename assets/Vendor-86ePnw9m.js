import{k as U,r as n,R as e,C as x}from"./index-DQP8N3_v.js";import{C as _,a as $}from"./CRow-DRxYPhhI.js";import{C as M,a as R}from"./CCardBody-DhxhUCKr.js";import{C as B,a as V,b as d,c,d as D,e as o}from"./CTable-BMBWZ6R4.js";import{b as i}from"./CContainer-B5X986nK.js";import{C as P,a as j,b as H,c as L}from"./CModalHeader-Dvi2NdUX.js";import{C as z}from"./CModalTitle-BsPjcxN8.js";import"./CCloseButton-B0Lgjfr_.js";import"./CNavItem-BP7P-adU.js";const E="https://backend-log2.axleshift.com/api/v1/auth",Y=()=>{const{accessToken:r}=U(),[C,p]=n.useState([]),[v,y]=n.useState(!0),[b,m]=n.useState(!1),[l,T]=n.useState(null),[f,u]=n.useState(null);n.useEffect(()=>{if(!r)return;(async()=>{try{const a=await fetch(`${E}/users`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}});if(!a.ok)throw new Error(`HTTP error! Status: ${a.status}`);const s=(await a.json()).users.filter(k=>k.role==="vendor");p(s)}catch(a){console.error("Error fetching users:",a),p([])}finally{y(!1)}})()},[r]);const h=(t,a)=>{p(g=>g.map(s=>s._id===t?{...s,status:a}:s))},A=async t=>{if(r){u(t);try{const a=await fetch(`${E}/approve/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}});a.ok?h(t,"Approved"):console.error("Error approving user",a.statusText)}catch(a){console.error("Error approving user:",a)}finally{u(null)}}},w=async t=>{if(r){u(t);try{const a=await fetch(`${E}/cancel-approval/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}});a.ok?h(t,"Pending"):console.error("Error canceling approval:",a.statusText)}catch(a){console.error("Error canceling approval:",a)}finally{u(null)}}},N=t=>{T(t),m(!0)},S=t=>{switch(t){case"Approved":return"success";case"Pending":return"warning";default:return"secondary"}};return e.createElement(e.Fragment,null,e.createElement(_,null,e.createElement($,{xs:"12"},e.createElement(M,{className:"shadow-lg"},e.createElement(R,null,e.createElement("h4",{className:"text-primary"},"Vendor Management"),v?e.createElement("div",{className:"d-flex justify-content-center"},e.createElement(x,{color:"primary"})):e.createElement(B,{striped:!0,bordered:!0,hover:!0,responsive:!0},e.createElement(V,{className:"bg-light"},e.createElement(d,null,e.createElement(c,null,"User ID"),e.createElement(c,null,"Email"),e.createElement(c,null,"Status"),e.createElement(c,null,"Role"),e.createElement(c,null,"Actions"))),e.createElement(D,null,C.length>0?C.map(t=>e.createElement(d,{key:t._id,className:"text-center"},e.createElement(o,null,t._id),e.createElement(o,null,t.email),e.createElement(o,null,e.createElement(i,{color:S(t.status),className:"mr-2"},t.status)),e.createElement(o,null,t.role),e.createElement(o,null,e.createElement(i,{color:"info",onClick:()=>N(t),className:"mr-2"},"View Details"),t.status==="Approved"?e.createElement(i,{color:"warning",onClick:()=>w(t._id),className:"ml-2",disabled:f===t._id},"Cancel Approval"):e.createElement(i,{color:"success",onClick:()=>A(t._id),className:"ml-2",disabled:f===t._id},"Approve")))):e.createElement(d,null,e.createElement(o,{colSpan:"5",className:"text-center"},"No vendors found.")))))))),e.createElement(P,{visible:b,onClose:()=>m(!1),className:"bg-light"},e.createElement(j,{onClose:()=>m(!1)},e.createElement(z,null,"User Details")),e.createElement(H,null,l&&e.createElement("div",null,e.createElement("p",null,e.createElement("strong",null,"User ID:")," ",l._id),e.createElement("p",null,e.createElement("strong",null,"Name:")," ",(l==null?void 0:l.name)||"N/A"),e.createElement("p",null,e.createElement("strong",null,"Email:")," ",l.email),e.createElement("p",null,e.createElement("strong",null,"Status:")," ",l.status),e.createElement("p",null,e.createElement("strong",null,"Role:")," ",l.role))),e.createElement(L,null,e.createElement(i,{color:"secondary",onClick:()=>m(!1)},"Close"))))};export{Y as default};
