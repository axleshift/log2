import{r as c,R as e,C as O}from"./index-D1haz4zp.js";import{a as I}from"./index-t--hEgTQ.js";import{c as y,a as o,b as r,d as Y}from"./CRow-Boga1cOo.js";import{b as Z,c as ee,m as ne,d as te,f as ae,g as re,h as j,j as u,k as se,l as g}from"./CTable-BHUvNzq9.js";import{C as ie}from"./CForm-BKi5VGFH.js";import{a as s}from"./CFormInput-CujOS9_1.js";import{a as ce,b as me,c as le,d as oe}from"./DefaultLayout-BUZUy6TS.js";import{C as G,a as J}from"./CCardBody-R9kYYhXf.js";import{C as K}from"./CCardHeader-B8zj-hL2.js";import{C as pe}from"./CAlert-D2T20cRn.js";import"./CCloseButton-DhW8IUPc.js";import"./CFormTextarea-DJHGWBI0.js";import"./CFormSelect-CQL6fzkU.js";import"./index.esm-DRRgYBAD.js";import"./cil-user-Ddrdy7PS.js";import"./index-sMQ8yH7z.js";const _e="https://backend-log2.axleshift.com",L=`${_e}/api/v1/shipment`,de=()=>{const[p,b]=c.useState([]),[f,N]=c.useState(!1),[_,k]=c.useState({visible:!1,message:"",color:""}),[x,d]=c.useState(!1),[D,E]=c.useState(!1),[F,w]=c.useState(null),[t,C]=c.useState({tracking_id:"",shipper_company_name:"",shipper_contact_name:"",shipper_contact_email_address:"",shipper_contact_phone_number:"",shipper_company_address:"",consignee_company_name:"",consignee_contact_name:"",consignee_contact_email_address:"",consignee_contact_phone_number:"",consignee_company_address:"",shipment_description:"",shipment_weight:"",shipment_dimension_length:"",shipment_dimension_width:"",shipment_dimension_height:"",receiveDate:"",isInWarehouse:!1,dispatch:"Pending",paid:"Unpaid",amount:"",type:"public"});c.useEffect(()=>{v()},[]);const v=async()=>{try{const n=await I.get(L);b(n.data.shipments||[])}catch(n){console.error("Failed to fetch shipments:",n)}},S=(n,i)=>{k({visible:!0,message:n,color:i}),setTimeout(()=>k({visible:!1,message:"",color:""}),4e3)},a=n=>{const{name:i,value:m}=n.target;C(l=>({...l,[i]:m}))},T=async n=>{n.preventDefault(),N(!0);try{const i=Number(t.shipment_dimension_length),m=Number(t.shipment_dimension_width),l=Number(t.shipment_dimension_height),h={tracking_id:t.tracking_id,shipper:{shipper_company_name:t.shipper_company_name,shipper_contact_name:t.shipper_contact_name,shipper_contact_email_address:t.shipper_contact_email_address,shipper_contact_phone_number:t.shipper_contact_phone_number,shipper_company_address:t.shipper_company_address},consignee:{consignee_company_name:t.consignee_company_name,consignee_contact_name:t.consignee_contact_name,consignee_contact_email_address:t.consignee_contact_email_address,consignee_contact_phone_number:t.consignee_contact_phone_number,consignee_company_address:t.consignee_company_address},shipment:{shipment_description:t.shipment_description,shipment_weight:Number(t.shipment_weight),shipment_dimension_length:i,shipment_dimension_width:m,shipment_dimension_height:l,shipment_volume:i*m*l,shipment_value:100,shipment_instructions:"N/A"},shipping:{shipping_type:"land",shipping_details:{land:{origin_address:"N/A",destination_address:"N/A"}}},receiveDate:t.receiveDate||null,isInWarehouse:t.isInWarehouse,dispatch:"Pending",paid:"Unpaid",amount:0,type:"public"};D?(await I.put(`${L}/${F}`,h),S("Shipment updated!","success")):(await I.post(L,h),S("Shipment created!","success")),v(),d(!1),P()}catch(i){console.error("Error:",i),S("Error occurred","danger")}finally{N(!1)}},P=()=>{C({tracking_id:"",shipper_company_name:"",shipper_contact_name:"",shipper_contact_email_address:"",shipper_contact_phone_number:"",shipper_company_address:"",consignee_company_name:"",consignee_contact_name:"",consignee_contact_email_address:"",consignee_contact_phone_number:"",consignee_company_address:"",shipment_description:"",shipment_weight:"",shipment_dimension_length:"",shipment_dimension_width:"",shipment_dimension_height:"",receiveDate:"",isInWarehouse:!1,dispatch:"Pending",paid:"Unpaid",amount:0,type:"public"})},Q=n=>{var i,m,l,h,q,A,M,R,U,B,H,$,W,z,V;E(!0),w(n._id),C({tracking_id:n.tracking_id,shipper_company_name:((i=n.shipper)==null?void 0:i.shipper_company_name)||"",shipper_contact_name:((m=n.shipper)==null?void 0:m.shipper_contact_name)||"",shipper_contact_email_address:((l=n.shipper)==null?void 0:l.shipper_contact_email_address)||"",shipper_contact_phone_number:((h=n.shipper)==null?void 0:h.shipper_contact_phone_number)||"",shipper_company_address:((q=n.shipper)==null?void 0:q.shipper_company_address)||"",consignee_company_name:((A=n.consignee)==null?void 0:A.consignee_company_name)||"",consignee_contact_name:((M=n.consignee)==null?void 0:M.consignee_contact_name)||"",consignee_contact_email_address:((R=n.consignee)==null?void 0:R.consignee_contact_email_address)||"",consignee_contact_phone_number:((U=n.consignee)==null?void 0:U.consignee_contact_phone_number)||"",consignee_company_address:((B=n.consignee)==null?void 0:B.consignee_company_address)||"",shipment_description:((H=n.shipment)==null?void 0:H.shipment_description)||"",shipment_weight:(($=n.shipment)==null?void 0:$.shipment_weight)||"",shipment_dimension_length:((W=n.shipment)==null?void 0:W.shipment_dimension_length)||"",shipment_dimension_width:((z=n.shipment)==null?void 0:z.shipment_dimension_width)||"",shipment_dimension_height:((V=n.shipment)==null?void 0:V.shipment_dimension_height)||""}),d(!0)},X=async n=>{if(confirm("Are you sure you want to delete this shipment?"))try{await I.delete(`${L}/${n}`),S("Shipment deleted!","success"),v()}catch(i){console.error("Delete error:",i),S("Failed to delete","danger")}};return e.createElement(e.Fragment,null,e.createElement("div",{className:"d-flex justify-content-between align-items-center mb-4"},e.createElement("h4",null,"Shipments"),e.createElement(y,{color:"primary",onClick:()=>{E(!1),w(null),P(),d(!0)}},"+ New Shipment")),e.createElement(Z,{visible:x,onClose:()=>d(!1),size:"lg"},e.createElement(ee,null,e.createElement(ne,null,D?"Edit Shipment":"Create Shipment")),e.createElement(te,null,e.createElement(ie,{onSubmit:T},e.createElement(o,{className:"mb-3"},e.createElement(r,{md:6},e.createElement(s,{label:"Tracking ID",name:"tracking_id",value:t.tracking_id,onChange:a,required:!0})),e.createElement(o,{className:"mb-3"},e.createElement(r,{md:6},e.createElement(s,{type:"date",label:"Received Date",name:"receiveDate",value:t.receiveDate,onChange:a}))),e.createElement(r,{md:6},e.createElement(s,{label:"Shipper Company",name:"shipper_company_name",value:t.shipper_company_name,onChange:a,required:!0}))),e.createElement(o,{className:"mb-3"},e.createElement(r,{md:4},e.createElement(s,{label:"Shipper Contact Name",name:"shipper_contact_name",value:t.shipper_contact_name,onChange:a,required:!0})),e.createElement(r,{md:4},e.createElement(s,{label:"Shipper Email",name:"shipper_contact_email_address",value:t.shipper_contact_email_address,onChange:a,required:!0})),e.createElement(r,{md:4},e.createElement(s,{label:"Shipper Phone",name:"shipper_contact_phone_number",value:t.shipper_contact_phone_number,onChange:a,required:!0}))),e.createElement(o,{className:"mb-3"},e.createElement(r,null,e.createElement(s,{label:"Shipper Address",name:"shipper_company_address",value:t.shipper_company_address,onChange:a,required:!0}))),e.createElement(o,{className:"mb-3"},e.createElement(r,{md:6},e.createElement(s,{label:"Consignee Company",name:"consignee_company_name",value:t.consignee_company_name,onChange:a,required:!0})),e.createElement(r,{md:6},e.createElement(s,{label:"Consignee Contact Name",name:"consignee_contact_name",value:t.consignee_contact_name,onChange:a,required:!0}))),e.createElement(o,{className:"mb-3"},e.createElement(r,{md:4},e.createElement(s,{label:"Consignee Email",name:"consignee_contact_email_address",value:t.consignee_contact_email_address,onChange:a,required:!0})),e.createElement(r,{md:4},e.createElement(s,{label:"Consignee Phone",name:"consignee_contact_phone_number",value:t.consignee_contact_phone_number,onChange:a,required:!0})),e.createElement(r,{md:4},e.createElement(s,{label:"Consignee Address",name:"consignee_company_address",value:t.consignee_company_address,onChange:a,required:!0}))),e.createElement(o,{className:"mb-3"},e.createElement(r,{md:6},e.createElement(s,{label:"Description",name:"shipment_description",value:t.shipment_description,onChange:a,required:!0})),e.createElement(r,{md:6},e.createElement(s,{label:"Weight (kg)",name:"shipment_weight",type:"number",value:t.shipment_weight,onChange:a,required:!0}))),e.createElement(o,{className:"mb-3"},e.createElement(r,{md:4},e.createElement(s,{label:"Length (cm)",name:"shipment_dimension_length",type:"number",value:t.shipment_dimension_length,onChange:a,required:!0})),e.createElement(r,{md:4},e.createElement(s,{label:"Width (cm)",name:"shipment_dimension_width",type:"number",value:t.shipment_dimension_width,onChange:a,required:!0})),e.createElement(r,{md:4},e.createElement(s,{label:"Height (cm)",name:"shipment_dimension_height",type:"number",value:t.shipment_dimension_height,onChange:a,required:!0}))),e.createElement("div",{className:"text-end"},e.createElement(y,{type:"submit",color:"success",disabled:f},f?e.createElement(O,{size:"sm"}):D?"Update":"Create"))))),e.createElement(ae,{striped:!0,hover:!0,responsive:!0},e.createElement(re,null,e.createElement(j,null,e.createElement(u,null,"#"),e.createElement(u,null,"Tracking ID"),e.createElement(u,null,"Shipper"),e.createElement(u,null,"Consignee"),e.createElement(u,null,"Description"),e.createElement(u,null,"Weight"),e.createElement(u,null,"Volume (cmÂ³)"),e.createElement(u,null,"Actions"))),e.createElement(se,null,p.map((n,i)=>{var m,l,h,q,A;return e.createElement(j,{key:n._id},e.createElement(g,null,i+1),e.createElement(g,null,n.tracking_id),e.createElement(g,null,(m=n.shipper)==null?void 0:m.shipper_company_name),e.createElement(g,null,(l=n.consignee)==null?void 0:l.consignee_company_name),e.createElement(g,null,(h=n.shipment)==null?void 0:h.shipment_description),e.createElement(g,null,(q=n.shipment)==null?void 0:q.shipment_weight),e.createElement(g,null,(A=n.shipment)==null?void 0:A.shipment_volume),e.createElement(g,null,e.createElement(y,{size:"sm",color:"info",className:"me-2",onClick:()=>Q(n)},"Edit"),e.createElement(y,{size:"sm",color:"danger",onClick:()=>X(n._id)},"Delete")))}))),e.createElement(ce,{position:"top-end"},_.visible&&e.createElement(me,{color:_.color},e.createElement(le,{closeButton:!0},_.color==="success"?"Success":"Error"),e.createElement(oe,null,_.message))))},he="https://backend-log2.axleshift.com",ue=`${he}/api/v1/shipment`,ge=()=>{const[p,b]=c.useState(""),[f,N]=c.useState(!1),[_,k]=c.useState(null),[x,d]=c.useState(null),D=async()=>{var E,F,w,t,C;if(!p.trim()){d("Please enter a tracking number");return}N(!0),d(null),k(null);try{const a=((await I.get(ue)).data.shipments||[]).find(T=>T.tracking_id===p);if(!a)d("Tracking number not found.");else{const T={status:((E=a.delivery)==null?void 0:E.status)||"N/A",expectedDelivery:(F=a.delivery)!=null&&F.deliveryDate?new Date(a.delivery.deliveryDate).toLocaleDateString():"Not provided",currentLocation:((C=(t=(w=a.shipping)==null?void 0:w.shipping_details)==null?void 0:t.land)==null?void 0:C.destination_address)||"â"};k(T)}}catch(v){console.error(v),d("Error fetching shipment data.")}finally{N(!1)}};return e.createElement(G,{className:"shadow-sm"},e.createElement(K,{className:"bg-primary text-white"},e.createElement("h5",{className:"mb-0"},"ð¦ Delivery Tracking ")),e.createElement(J,null,e.createElement(o,{className:"mb-3"},e.createElement(r,{md:8},e.createElement(s,{id:"trackingNumber",placeholder:"Enter tracking number (e.g. 12345)",value:p,onChange:E=>b(E.target.value)})),e.createElement(r,{md:4},e.createElement(y,{color:"primary",className:"w-100",onClick:D,disabled:f},f?e.createElement(O,{size:"sm"}):"Track"))),x&&e.createElement(pe,{color:"danger",className:"mt-2"},x),_&&e.createElement("div",{className:"mt-4 border-top pt-3"},e.createElement("h6",{className:"mb-3 text-success"},"â Delivery Details"),e.createElement("p",null,e.createElement("strong",null,"Status:")," ",_.status),e.createElement("p",null,e.createElement("strong",null,"Expected Delivery:")," ",_.expectedDelivery),e.createElement("p",null,e.createElement("strong",null,"Current Location:")," ",_.currentLocation))))},Fe=()=>{const[p,b]=c.useState("ShipmentDeliveryForm");return e.createElement(Y,null,e.createElement(o,{className:"mb-3"},e.createElement(r,null,e.createElement(G,null,e.createElement(K,null,e.createElement(y,{color:p==="ShipmentDeliveryForm"?"primary":"secondary",onClick:()=>b("ShipmentDeliveryForm"),className:"ms-2"},"ShipmentDeliveryForm"),e.createElement(y,{color:p==="deliveryTracking"?"primary":"secondary",onClick:()=>b("deliveryTracking"),className:"ms-2"},"Delivery Tracking")),e.createElement(J,null,p==="ShipmentDeliveryForm"?e.createElement(de,null):e.createElement(ge,null))))))};export{Fe as default};
