import{r as c,R as e,C as O}from"./index-DZfE5c-b.js";import{a as L}from"./index-t--hEgTQ.js";import{c as C,a as o,b as s,d as X}from"./CRow-DcJW25wv.js";import{b as Y,c as Z,m as ee,d as ne,f as te,g as ae,h as j,j as u,k as se,l as g}from"./CTable-C8VLslgc.js";import{C as re}from"./CForm-D8cqiWRb.js";import{a as r}from"./CFormInput-eY5Z5ntw.js";import{a as ie,b as ce,c as me,d as le}from"./DefaultLayout-BZ3SpNnn.js";import{C as G,a as J}from"./CCardBody-CJbgDnbm.js";import{C as K}from"./CCardHeader-Clixh7Cc.js";import{C as oe}from"./CAlert-CA819VF8.js";import"./CCloseButton-BehUEh2q.js";import"./CFormTextarea-FED7pE9Z.js";import"./CFormSelect-BH_FWxaD.js";import"./index.esm-Bvm-VaJ5.js";import"./cil-user-Ddrdy7PS.js";import"./index-Tvh2umWT.js";const pe="https://backend-log2.axleshift.com",F=`${pe}/api/v1/shipment`,_e=()=>{const[p,b]=c.useState([]),[v,S]=c.useState(!1),[_,f]=c.useState({visible:!1,message:"",color:""}),[A,d]=c.useState(!1),[N,E]=c.useState(!1),[I,k]=c.useState(null),[n,y]=c.useState({tracking_id:"",shipper_company_name:"",shipper_contact_name:"",shipper_contact_email_address:"",shipper_contact_phone_number:"",shipper_company_address:"",consignee_company_name:"",consignee_contact_name:"",consignee_contact_email_address:"",consignee_contact_phone_number:"",consignee_company_address:"",shipment_description:"",shipment_weight:"",shipment_dimension_length:"",shipment_dimension_width:"",shipment_dimension_height:"",receiveDate:"",isInWarehouse:!1,dispatch:"Pending",paid:"Unpaid",amount:"",type:"public"});c.useEffect(()=>{D()},[]);const D=async()=>{try{const t=await L.get(F);b(t.data.shipments||[])}catch(t){console.error("Failed to fetch shipments:",t)}},x=(t,i)=>{f({visible:!0,message:t,color:i}),setTimeout(()=>f({visible:!1,message:"",color:""}),4e3)},a=t=>{const{name:i,value:m}=t.target;y(l=>({...l,[i]:m}))},w=async t=>{t.preventDefault(),S(!0);try{const i=Number(n.shipment_dimension_length),m=Number(n.shipment_dimension_width),l=Number(n.shipment_dimension_height),h={tracking_id:n.tracking_id,shipper:{shipper_company_name:n.shipper_company_name,shipper_contact_name:n.shipper_contact_name,shipper_contact_email_address:n.shipper_contact_email_address,shipper_contact_phone_number:n.shipper_contact_phone_number,shipper_company_address:n.shipper_company_address},consignee:{consignee_company_name:n.consignee_company_name,consignee_contact_name:n.consignee_contact_name,consignee_contact_email_address:n.consignee_contact_email_address,consignee_contact_phone_number:n.consignee_contact_phone_number,consignee_company_address:n.consignee_company_address},shipment:{shipment_description:n.shipment_description,shipment_weight:Number(n.shipment_weight),shipment_dimension_length:i,shipment_dimension_width:m,shipment_dimension_height:l,shipment_volume:i*m*l,shipment_value:100,shipment_instructions:"N/A"},shipping:{shipping_type:"land",shipping_details:{land:{origin_address:"N/A",destination_address:"N/A"}}},receiveDate:n.receiveDate||null,isInWarehouse:n.isInWarehouse,dispatch:"Pending",paid:"Unpaid",amount:0,type:"public"};N?(await L.put(`${F}/${I}`,h),x("Shipment updated!","success")):(await L.post(F,h),x("Shipment created!","success")),D(),d(!1),P()}catch(i){console.error("Error:",i),x("Error occurred","danger")}finally{S(!1)}},P=()=>{y({tracking_id:"",shipper_company_name:"",shipper_contact_name:"",shipper_contact_email_address:"",shipper_contact_phone_number:"",shipper_company_address:"",consignee_company_name:"",consignee_contact_name:"",consignee_contact_email_address:"",consignee_contact_phone_number:"",consignee_company_address:"",shipment_description:"",shipment_weight:"",shipment_dimension_length:"",shipment_dimension_width:"",shipment_dimension_height:"",receiveDate:"",isInWarehouse:!1,dispatch:"Pending",paid:"Unpaid",amount:0,type:"public"})},Q=t=>{var i,m,l,h,T,q,M,R,U,B,H,W,$,z,V;E(!0),k(t._id),y({tracking_id:t.tracking_id,shipper_company_name:((i=t.shipper)==null?void 0:i.shipper_company_name)||"",shipper_contact_name:((m=t.shipper)==null?void 0:m.shipper_contact_name)||"",shipper_contact_email_address:((l=t.shipper)==null?void 0:l.shipper_contact_email_address)||"",shipper_contact_phone_number:((h=t.shipper)==null?void 0:h.shipper_contact_phone_number)||"",shipper_company_address:((T=t.shipper)==null?void 0:T.shipper_company_address)||"",consignee_company_name:((q=t.consignee)==null?void 0:q.consignee_company_name)||"",consignee_contact_name:((M=t.consignee)==null?void 0:M.consignee_contact_name)||"",consignee_contact_email_address:((R=t.consignee)==null?void 0:R.consignee_contact_email_address)||"",consignee_contact_phone_number:((U=t.consignee)==null?void 0:U.consignee_contact_phone_number)||"",consignee_company_address:((B=t.consignee)==null?void 0:B.consignee_company_address)||"",shipment_description:((H=t.shipment)==null?void 0:H.shipment_description)||"",shipment_weight:((W=t.shipment)==null?void 0:W.shipment_weight)||"",shipment_dimension_length:(($=t.shipment)==null?void 0:$.shipment_dimension_length)||"",shipment_dimension_width:((z=t.shipment)==null?void 0:z.shipment_dimension_width)||"",shipment_dimension_height:((V=t.shipment)==null?void 0:V.shipment_dimension_height)||""}),d(!0)};return e.createElement(e.Fragment,null,e.createElement("div",{className:"d-flex justify-content-between align-items-center mb-4"},e.createElement("h4",null,"Shipments"),e.createElement(C,{color:"primary",onClick:()=>{E(!1),k(null),P(),d(!0)}},"+ New Shipment")),e.createElement(Y,{visible:A,onClose:()=>d(!1),size:"lg"},e.createElement(Z,null,e.createElement(ee,null,N?"Edit Shipment":"Create Shipment")),e.createElement(ne,null,e.createElement(re,{onSubmit:w},e.createElement(o,{className:"mb-3"},e.createElement(s,{md:6},e.createElement(r,{label:"Tracking ID",name:"tracking_id",value:n.tracking_id,onChange:a,required:!0})),e.createElement(o,{className:"mb-3"},e.createElement(s,{md:6},e.createElement(r,{type:"date",label:"Received Date",name:"receiveDate",value:n.receiveDate,onChange:a}))),e.createElement(s,{md:6},e.createElement(r,{label:"Shipper Company",name:"shipper_company_name",value:n.shipper_company_name,onChange:a,required:!0}))),e.createElement(o,{className:"mb-3"},e.createElement(s,{md:4},e.createElement(r,{label:"Shipper Contact Name",name:"shipper_contact_name",value:n.shipper_contact_name,onChange:a,required:!0})),e.createElement(s,{md:4},e.createElement(r,{label:"Shipper Email",name:"shipper_contact_email_address",value:n.shipper_contact_email_address,onChange:a,required:!0})),e.createElement(s,{md:4},e.createElement(r,{label:"Shipper Phone",name:"shipper_contact_phone_number",value:n.shipper_contact_phone_number,onChange:a,required:!0}))),e.createElement(o,{className:"mb-3"},e.createElement(s,null,e.createElement(r,{label:"Shipper Address",name:"shipper_company_address",value:n.shipper_company_address,onChange:a,required:!0}))),e.createElement(o,{className:"mb-3"},e.createElement(s,{md:6},e.createElement(r,{label:"Consignee Company",name:"consignee_company_name",value:n.consignee_company_name,onChange:a,required:!0})),e.createElement(s,{md:6},e.createElement(r,{label:"Consignee Contact Name",name:"consignee_contact_name",value:n.consignee_contact_name,onChange:a,required:!0}))),e.createElement(o,{className:"mb-3"},e.createElement(s,{md:4},e.createElement(r,{label:"Consignee Email",name:"consignee_contact_email_address",value:n.consignee_contact_email_address,onChange:a,required:!0})),e.createElement(s,{md:4},e.createElement(r,{label:"Consignee Phone",name:"consignee_contact_phone_number",value:n.consignee_contact_phone_number,onChange:a,required:!0})),e.createElement(s,{md:4},e.createElement(r,{label:"Consignee Address",name:"consignee_company_address",value:n.consignee_company_address,onChange:a,required:!0}))),e.createElement(o,{className:"mb-3"},e.createElement(s,{md:6},e.createElement(r,{label:"Description",name:"shipment_description",value:n.shipment_description,onChange:a,required:!0})),e.createElement(s,{md:6},e.createElement(r,{label:"Weight (kg)",name:"shipment_weight",type:"number",value:n.shipment_weight,onChange:a,required:!0}))),e.createElement(o,{className:"mb-3"},e.createElement(s,{md:4},e.createElement(r,{label:"Length (cm)",name:"shipment_dimension_length",type:"number",value:n.shipment_dimension_length,onChange:a,required:!0})),e.createElement(s,{md:4},e.createElement(r,{label:"Width (cm)",name:"shipment_dimension_width",type:"number",value:n.shipment_dimension_width,onChange:a,required:!0})),e.createElement(s,{md:4},e.createElement(r,{label:"Height (cm)",name:"shipment_dimension_height",type:"number",value:n.shipment_dimension_height,onChange:a,required:!0}))),e.createElement("div",{className:"text-end"},e.createElement(C,{type:"submit",color:"success",disabled:v},v?e.createElement(O,{size:"sm"}):N?"Update":"Create"))))),e.createElement(te,{striped:!0,hover:!0,responsive:!0},e.createElement(ae,null,e.createElement(j,null,e.createElement(u,null,"#"),e.createElement(u,null,"Tracking ID"),e.createElement(u,null,"Shipper"),e.createElement(u,null,"Consignee"),e.createElement(u,null,"Description"),e.createElement(u,null,"Weight"),e.createElement(u,null,"Volume (cmÂ³)"),e.createElement(u,null,"Actions"))),e.createElement(se,null,p.map((t,i)=>{var m,l,h,T,q;return e.createElement(j,{key:t._id},e.createElement(g,null,i+1),e.createElement(g,null,t.tracking_id),e.createElement(g,null,(m=t.shipper)==null?void 0:m.shipper_company_name),e.createElement(g,null,(l=t.consignee)==null?void 0:l.consignee_company_name),e.createElement(g,null,(h=t.shipment)==null?void 0:h.shipment_description),e.createElement(g,null,(T=t.shipment)==null?void 0:T.shipment_weight),e.createElement(g,null,(q=t.shipment)==null?void 0:q.shipment_volume),e.createElement(g,null,e.createElement(C,{size:"sm",color:"info",className:"me-2",onClick:()=>Q(t)},"Edit")))}))),e.createElement(ie,{position:"top-end"},_.visible&&e.createElement(ce,{color:_.color},e.createElement(me,{closeButton:!0},_.color==="success"?"Success":"Error"),e.createElement(le,null,_.message))))},de="https://backend-log2.axleshift.com",he=`${de}/api/v1/shipment`,ue=()=>{const[p,b]=c.useState(""),[v,S]=c.useState(!1),[_,f]=c.useState(null),[A,d]=c.useState(null),N=async()=>{var E,I,k,n,y;if(!p.trim()){d("Please enter a tracking number");return}S(!0),d(null),f(null);try{const a=((await L.get(he)).data.shipments||[]).find(w=>w.tracking_id===p);if(!a)d("Tracking number not found.");else{const w={status:((E=a.delivery)==null?void 0:E.status)||"N/A",expectedDelivery:(I=a.delivery)!=null&&I.deliveryDate?new Date(a.delivery.deliveryDate).toLocaleDateString():"Not provided",currentLocation:((y=(n=(k=a.shipping)==null?void 0:k.shipping_details)==null?void 0:n.land)==null?void 0:y.destination_address)||"â€”"};f(w)}}catch(D){console.error(D),d("Error fetching shipment data.")}finally{S(!1)}};return e.createElement(G,{className:"shadow-sm"},e.createElement(K,{className:"bg-primary text-white"},e.createElement("h5",{className:"mb-0"},"ðŸ“¦ Delivery Tracking ")),e.createElement(J,null,e.createElement(o,{className:"mb-3"},e.createElement(s,{md:8},e.createElement(r,{id:"trackingNumber",placeholder:"Enter tracking number (e.g. 12345)",value:p,onChange:E=>b(E.target.value)})),e.createElement(s,{md:4},e.createElement(C,{color:"primary",className:"w-100",onClick:N,disabled:v},v?e.createElement(O,{size:"sm"}):"Track"))),A&&e.createElement(oe,{color:"danger",className:"mt-2"},A),_&&e.createElement("div",{className:"mt-4 border-top pt-3"},e.createElement("h6",{className:"mb-3 text-success"},"âœ… Delivery Details"),e.createElement("p",null,e.createElement("strong",null,"Status:")," ",_.status),e.createElement("p",null,e.createElement("strong",null,"Expected Delivery:")," ",_.expectedDelivery),e.createElement("p",null,e.createElement("strong",null,"Current Location:")," ",_.currentLocation))))},xe=()=>{const[p,b]=c.useState("ShipmentDeliveryForm");return e.createElement(X,null,e.createElement(o,{className:"mb-3"},e.createElement(s,null,e.createElement(G,null,e.createElement(K,null,e.createElement(C,{color:p==="ShipmentDeliveryForm"?"primary":"secondary",onClick:()=>b("ShipmentDeliveryForm"),className:"ms-2"},"ShipmentDeliveryForm"),e.createElement(C,{color:p==="deliveryTracking"?"primary":"secondary",onClick:()=>b("deliveryTracking"),className:"ms-2"},"Delivery Tracking")),e.createElement(J,null,p==="ShipmentDeliveryForm"?e.createElement(_e,null):e.createElement(ue,null))))))};export{xe as default};
