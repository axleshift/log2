import{h as O,i as F,r as s,j as e,L as u,p as y}from"./index-DEmdhtkv.js";import{u as U,c as V}from"./index.esm-DrYYHZ6f.js";import{C as w}from"./index.esm-PQ4dROIH.js";import{F as _,j as G,k as q}from"./index-Dkr2Hnkf.js";import{R as D,V as W}from"./config-b0sta0FD.js";import{a as z,b as o}from"./CContainer-l_OEV5c6.js";import{C as h,a as r}from"./CRow-fCwqIY5j.js";import{C as B}from"./CCardGroup-Cfpwbv_a.js";import{C as $,a as H}from"./CCardBody-D_V14yWh.js";import{C as J}from"./CAlert-DFda796J.js";import{C as K}from"./CForm-BvvF_kaV.js";import{C as S,a as N}from"./CInputGroupText-DGEqc-XL.js";import{c as M}from"./cil-user-Ddrdy7PS.js";import{C as b}from"./CFormInput-_fbGxJYO.js";import"./CCloseButton-B-4_Krdy.js";import"./CFormControlWrapper-CnvfyOx9.js";const pe=()=>{const R="https://backend-log2.axleshift.com/api/v1/auth",{register:x,handleSubmit:k,formState:{errors:t},reset:L}=U(),E=O(),{login:T}=F(),n=s.useRef(null),i=s.useRef(null),[c,f]=s.useState(!1),[l,a]=s.useState({message:"",type:""}),[m,v]=s.useState(!1);s.useEffect(()=>{n.current&&n.current.focus()},[]);const P=async A=>{f(!0),a({message:"",type:""});try{const d=await i.current.executeAsync();i.current.reset();const j=await fetch(`${R}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...A,recaptcha_ref:d})}),g=await j.json();if(!j.ok)throw new Error(g.message||"Login failed");const{accessToken:C,refreshToken:I,user:p}=g;T(p,C),y.set("token",C,{expires:1,secure:!0,sameSite:"Strict"}),y.set("refreshToken",I,{expires:30,secure:!0,sameSite:"Strict"}),a({message:"Welcome back! Redirecting...",type:"success"}),L(),p.role==="vendor"||p.role==="super admin"?E("/dashboard"):a({message:"Unauthorized. Access denied.",type:"danger"})}catch(d){a({message:d.message,type:"danger"})}finally{f(!1)}};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsxs(z,{children:[e.jsx(D,{ref:i,size:"invisible",sitekey:W}),e.jsxs(h,{className:"justify-content-center",children:[e.jsxs(r,{md:4,className:"d-flex flex-column align-items-center justify-content-center bg-primary text-white",children:[e.jsx("h2",{children:"VENDOR PORTAL"}),e.jsx("p",{children:"Logistic Management System"}),e.jsx(u,{to:"/login",className:"text-white",children:"Login Portal â†’"})]}),e.jsx(r,{md:5,children:e.jsx(B,{children:e.jsx($,{className:"p-4",children:e.jsxs(H,{children:[l.message&&e.jsx(J,{color:l.type,children:l.message}),e.jsxs(K,{onSubmit:k(P),children:[e.jsx("h1",{children:"Vendor Login"}),e.jsx("p",{className:"text-body-secondary",children:"Sign in to your vendor account"}),e.jsxs(S,{className:"mb-3",children:[e.jsx(N,{children:e.jsx(w,{icon:M})}),e.jsx(b,{ref:n,type:"text",placeholder:"Username",autoComplete:"username",...x("username",{required:"Username is required"})})]}),t.username&&e.jsx("p",{className:"text-danger",children:t.username.message}),e.jsxs(S,{className:"mb-4",children:[e.jsx(N,{children:e.jsx(w,{icon:V})}),e.jsx(b,{type:m?"text":"password",placeholder:"Password",autoComplete:"current-password",...x("password",{required:"Password is required"})}),e.jsx(o,{color:"secondary",variant:"outline",onClick:()=>v(!m),children:e.jsx(_,{icon:m?G:q})})]}),t.password&&e.jsx("p",{className:"text-danger",children:t.password.message}),e.jsxs(h,{children:[e.jsx(r,{sm:5,children:e.jsx(o,{color:"success",variant:"outline",type:"submit",disabled:c,children:c?"Logging in...":"LOGIN"})}),e.jsx(r,{xs:"auto",className:"me-auto",children:e.jsx(u,{to:"/forgotPass",children:e.jsx(o,{color:"danger",variant:"outline",disabled:c,children:"FORGOT PASSWORD"})})})]}),e.jsx(h,{className:"mt-3",children:e.jsx(r,{xs:12,className:"text-center",children:e.jsx(u,{to:"/VendorRegister",children:e.jsx(o,{color:"link",children:"Register Now!"})})})})]})]})})})})]})]})})};export{pe as default};
