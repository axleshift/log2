import{f as F,r,j as e,L as p}from"./index-B8kCwtGV.js";import{u as O,c as G}from"./index.esm-mFx59yxY.js";import{C as j}from"./index.esm-4b7MesSj.js";import{F as U,d as q,e as H}from"./index-BY-m-lGQ.js";import{a as C}from"./js.cookie-CjXG54Hc.js";import{C as B,a as c}from"./CContainer-v_4zzpW7.js";import{C as y,a as t}from"./CRow-C3rkp-Ap.js";import{C as D}from"./CCardGroup-Cj1pwTyl.js";import{C as V,a as W}from"./CCardBody-2rm0LrJz.js";import{C as _}from"./CAlert-OE-PsB_q.js";import{C as $}from"./CForm-ChgHawWX.js";import{C as w,a as N}from"./CInputGroupText-xMj50WpP.js";import{c as z}from"./cil-user-Ddrdy7PS.js";import{C as S}from"./CFormInput-DTfERUsz.js";import"./Transition-S4DeDhou.js";function ce(){const b="undefined/api/v1/auth",{register:u,handleSubmit:k,formState:{errors:o},reset:P}=O(),T=F(),x=r.useRef(null),[n,l]=r.useState(!1),[d,i]=r.useState({message:"",type:""}),[h,L]=r.useState(!1),[m,g]=r.useState(null),f=r.useCallback(async()=>{try{const s=await window.grecaptcha.execute(void 0,{action:"login"});g(s)}catch(s){console.error("Error executing reCAPTCHA:",s)}},[]);r.useEffect(()=>{var s;window.grecaptcha?window.grecaptcha.ready(f):console.error("reCAPTCHA is not loaded properly."),(s=x.current)==null||s.focus()},[f]);const v=async s=>{if(l(!0),i({message:"",type:""}),!m){i({message:"Please complete the reCAPTCHA",type:"danger"}),l(!1);return}try{const a=await fetch(`${b}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...s,recaptchaToken:m})});if(!a.ok){const I=await a.json();throw new Error(I.message||"Login failed")}const{accessToken:A,refreshToken:E}=await a.json();C.set("token",A,{expires:1,secure:!0}),C.set("refreshToken",E,{expires:1,secure:!0}),i({message:"Welcome back! Redirecting to your Supplier Page...",type:"success"}),P(),setTimeout(()=>T("/supplierspage"),2e3)}catch(a){i({message:a.message,type:"danger"})}finally{l(!1),g(null)}},R=()=>{L(s=>!s)};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsx(B,{children:e.jsxs(y,{className:"justify-content-center",children:[e.jsxs(t,{md:4,className:"d-flex flex-column align-items-center justify-content-center bg-primary text-white",children:[e.jsx("h2",{children:"Supplier Login"}),e.jsx("p",{children:"Logistic Management System"}),e.jsx(p,{to:"/login",className:"text-white",children:"Vendor Portal â†’"})]}),e.jsx(t,{md:5,children:e.jsx(D,{children:e.jsx(V,{className:"p-4",children:e.jsxs(W,{children:[d.message&&e.jsx(_,{color:d.type,dismissible:!0,children:d.message}),e.jsxs($,{onSubmit:k(v),children:[e.jsx("h1",{children:"Supplier Login"}),e.jsx("p",{className:"text-body-secondary",children:"Sign In to your account"}),e.jsxs(w,{className:"mb-3",children:[e.jsx(N,{children:e.jsx(j,{icon:z})}),e.jsx(S,{ref:x,type:"text",placeholder:"Username",autoComplete:"username",...u("username",{required:"Username is required"})})]}),o.username&&e.jsx("p",{className:"text-danger",children:o.username.message}),e.jsxs(w,{className:"mb-4",children:[e.jsx(N,{children:e.jsx(j,{icon:G})}),e.jsx(S,{type:h?"text":"password",placeholder:"Password",autoComplete:"current-password",...u("password",{required:"Password is required"})}),e.jsx(c,{color:"secondary",variant:"outline",onClick:R,type:"button",children:e.jsx(U,{icon:h?q:H})})]}),o.password&&e.jsx("p",{className:"text-danger",children:o.password.message}),e.jsx("div",{className:"mb-3",style:{display:"none"},children:e.jsx("div",{className:"g-recaptcha","data-sitekey":void 0,"data-size":"invisible"})}),e.jsxs(y,{children:[e.jsx(t,{sm:5,children:e.jsx(c,{color:"success",variant:"outline",className:"px-4",type:"submit",disabled:n||!m,children:n?"Logging in...":"LOGIN"})}),e.jsx(t,{xs:"auto",className:"me-auto",children:e.jsx(p,{to:"/forgotPass",children:e.jsx(c,{color:"danger",variant:"outline",className:"px-4",disabled:n,children:n?"Processing...":"FORGOT PASSWORD"})})}),e.jsx(t,{xs:4,children:e.jsx(p,{to:"/register",children:e.jsx(c,{color:"link",className:"px-0",children:"Register Now!"})})})]})]})]})})})})]})})})}export{ce as default};
