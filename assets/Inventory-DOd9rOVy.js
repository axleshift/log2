import{r as l,_ as me,a as o,j as Q,F as X,b as $,c as P,P as u,u as de,R as e,C as he}from"./index-4l8YDPMt.js";import{a as C}from"./index-t--hEgTQ.js";import{C as pe,a as fe}from"./CCardBody-DYN-5Bvl.js";import{C as ve}from"./CCardHeader-CF_x8B1s.js";import{C as Ee,a as ye}from"./CInputGroupText-B1u8TW26.js";import{C as p,c as ne,a as D}from"./CFormInput-5eZtoBd3.js";import{c as k}from"./CRow-Dstcvhhn.js";import{b as be,c as Ce,d as G,e as g,f as ke,g as E,h as Z,j as ee,k as te,l as ae}from"./CTable-BFf1LR0p.js";import{u as ge}from"./CCloseButton-CN5zlj3N.js";import{C as re}from"./CModalTitle-COm58w7q.js";import{C as Se}from"./CForm-BlATjbC-.js";import{C as q}from"./CFormSelect-Q2Zp1re3.js";var B=l.forwardRef(function(a,M){var S=a.className,c=a.button,N=a.feedback,A=a.feedbackInvalid,O=a.feedbackValid,R=a.floatingLabel,V=a.tooltipFeedback,I=a.hitArea,f=a.id,y=a.indeterminate,z=a.inline,v=a.invalid,b=a.label,W=a.reverse,w=a.type,T=w===void 0?"checkbox":w,s=a.valid,x=me(a,["className","button","feedback","feedbackInvalid","feedbackValid","floatingLabel","tooltipFeedback","hitArea","id","indeterminate","inline","invalid","label","reverse","type","valid"]),d=l.useRef(null),j=ge(M,d);l.useEffect(function(){d.current&&y&&(d.current.indeterminate=y)},[y,d.current]);var h=function(){return o("input",{...$({type:T,className:P(c?"btn-check":"form-check-input",{"is-invalid":v,"is-valid":s,"me-2":I}),id:f},x,{ref:j})})},r=function(){return o(ne,{describedby:x["aria-describedby"],feedback:N,feedbackInvalid:A,feedbackValid:O,floatingLabel:R,invalid:v,tooltipFeedback:V,valid:s})},i=function(){var _;return o(p,{...$({customClassName:P(c?P("btn",c.variant?"btn-".concat(c.variant,"-").concat(c.color):"btn-".concat(c.color),(_={},_["btn-".concat(c.size)]=c.size,_),"".concat(c.shape)):"form-check-label")},f&&{htmlFor:f}),children:b})},F=function(){return c?Q(X,{children:[o(h,{}),b&&o(i,{}),o(r,{})]}):b?I?Q(X,{children:[o(h,{}),o(p,{...$({customClassName:P("form-check-label stretched-link",S)},f&&{htmlFor:f}),children:b}),o(r,{})]}):Q("div",{className:P("form-check",{"form-check-inline":z,"form-check-reverse":W,"is-invalid":v,"is-valid":s},S),children:[o(h,{}),o(i,{}),o(r,{})]}):o(h,{})};return o(F,{})});B.propTypes=$({button:u.object,className:u.string,hitArea:u.oneOf(["full"]),id:u.string,indeterminate:u.bool,inline:u.bool,label:u.oneOfType([u.string,u.node]),reverse:u.bool,type:u.oneOf(["checkbox","radio"])},ne.propTypes);B.displayName="CFormCheck";const U="https://backend-log2.axleshift.com",K=`${U}/api/v1/inventory`,Ne=`${U}/api/v1/shipment`,Ae=`${U}/api/v1/product`,Ie=`${U}/api/v1/warehouse`,Ue=()=>{const{accessToken:a}=de(),[M,S]=l.useState(!1),[c,N]=l.useState(new Set),[A,O]=l.useState([]),[R,V]=l.useState([]),[I,f]=l.useState([]),[y,z]=l.useState([]),[v,b]=l.useState(""),[W,w]=l.useState(!1),[T,s]=l.useState(""),[x,d]=l.useState(!1),[j,h]=l.useState(!1),[r,i]=l.useState({shipment:"",warehouse_id:"",product:"",sku:"",quantity:"",stock_level:"",status:"In Stock"});l.useEffect(()=>{F(),_(),le(),ce()},[]);const F=async()=>{w(!0);try{const t=await C.get(K,{headers:{Authorization:`Bearer ${a}`}});O(Array.isArray(t.data)?t.data:[])}catch{s("Error fetching inventory data.")}finally{w(!1)}},_=async()=>{var t;try{const n=await C.get(Ne,{headers:{Authorization:`Bearer ${a}`}});V(((t=n.data)==null?void 0:t.shipments)||[])}catch{console.error("Failed to fetch shipments")}},le=async()=>{try{const t=await C.get(Ae,{headers:{Authorization:`Bearer ${a}`}});f(t.data||[])}catch{console.error("Failed to fetch products")}},ce=async()=>{try{const t=await C.get(Ie,{headers:{Authorization:`Bearer ${a}`}});z(t.data||[])}catch{console.error("Failed to fetch warehouses")}},Y=l.useMemo(()=>A.filter(t=>{var n;return(((n=t.shipment)==null?void 0:n.tracking_id)||"").toLowerCase().includes(v.toLowerCase())}),[A,v]),oe=t=>{const n=t.target.checked;S(n),N(n?new Set(A.map(m=>m._id)):new Set)},se=(t,n)=>{const m=new Set(c);t.target.checked?m.add(n):m.delete(n),N(m)},ie=async()=>{if(!c.size)return s("Please select items to delete.");try{await Promise.all(Array.from(c).map(t=>C.delete(`${K}/${t}`,{headers:{Authorization:`Bearer ${a}`}}))),s("Selected items deleted successfully."),N(new Set),S(!1),F()}catch{s("Error deleting selected items.")}finally{d(!1)}},ue=async t=>{var L,J;t.preventDefault();const n=H=>/^[a-f\d]{24}$/i.test(H);if(!n(r.shipment)||!n(r.product)||!n(r.warehouse_id))return s("Shipment, Product, and Warehouse must be valid ObjectIDs.");const m={...r,quantity:Number(r.quantity),stock_level:Number(r.stock_level)};try{await C.post(K,m,{headers:{Authorization:`Bearer ${a}`}}),s("New inventory item created."),i({shipment:"",warehouse_id:"",product:"",sku:"",quantity:"",stock_level:"",status:"In Stock"}),h(!1),F()}catch(H){s(((J=(L=H.response)==null?void 0:L.data)==null?void 0:J.error)||"Failed to create item.")}};return e.createElement(pe,null,e.createElement(ve,{className:"text-center py-3"},"Warehouse Inventory"),e.createElement(fe,null,T&&e.createElement("div",{className:"alert alert-info"},T),e.createElement("div",{className:"d-flex justify-content-between align-items-center mb-4"},e.createElement(Ee,{style:{maxWidth:"400px"}},e.createElement(ye,null,"Search"),e.createElement(D,{type:"text",placeholder:"Search by Tracking ID",value:v,onChange:t=>b(t.target.value)})),e.createElement("div",{className:"d-flex gap-2"},e.createElement(k,{color:"success",onClick:()=>h(!0)},"+ New Item"),e.createElement(k,{color:"danger",onClick:()=>d(!0)},"Delete"))),W?e.createElement("div",{className:"text-center py-5"},e.createElement(he,{color:"primary"})):e.createElement(be,{striped:!0,hover:!0,responsive:!0},e.createElement(Ce,null,e.createElement(G,null,e.createElement(g,null,e.createElement(B,{checked:M,onChange:oe})),e.createElement(g,null,"Tracking ID"),e.createElement(g,null,"Product"),e.createElement(g,null,"SKU"),e.createElement(g,null,"Quantity"),e.createElement(g,null,"Stock Level"))),e.createElement(ke,null,Y.length>0?Y.map(t=>{var n,m;return e.createElement(G,{key:t._id},e.createElement(E,null,e.createElement(B,{checked:c.has(t._id),onChange:L=>se(L,t._id)})),e.createElement(E,null,((n=t.shipment)==null?void 0:n.tracking_id)||"N/A"),e.createElement(E,null,((m=t.product)==null?void 0:m.name)||"N/A"),e.createElement(E,null,t.sku),e.createElement(E,null,t.quantity),e.createElement(E,null,t.stock_level))}):e.createElement(G,null,e.createElement(E,{colSpan:"6",className:"text-center"},"No inventory records found."))))),e.createElement(Z,{visible:j,onClose:()=>h(!1)},e.createElement(ee,null,e.createElement(re,null,"New Inventory Item")),e.createElement(Se,{onSubmit:ue},e.createElement(te,null,e.createElement("div",{className:"mb-3"},e.createElement(p,null,"Shipment"),e.createElement(q,{value:r.shipment,onChange:t=>i({...r,shipment:t.target.value}),required:!0},e.createElement("option",{value:""},"Select Shipment"),Array.isArray(R)&&R.map(t=>e.createElement("option",{key:t._id,value:t._id},t.tracking_id||"Unnamed Shipment")))),e.createElement("div",{className:"mb-3"},e.createElement(p,null,"Product"),e.createElement(q,{value:r.product,onChange:t=>i({...r,product:t.target.value}),required:!0},e.createElement("option",{value:""},"Select Product"),Array.isArray(I)&&I.map(t=>e.createElement("option",{key:t._id,value:t._id},t.name||"Unnamed Product")))),e.createElement("div",{className:"mb-3"},e.createElement(p,null,"Warehouse"),e.createElement(q,{value:r.warehouse_id,onChange:t=>i({...r,warehouse_id:t.target.value}),required:!0},e.createElement("option",{value:""},"Select Warehouse"),Array.isArray(y)&&y.map(t=>e.createElement("option",{key:t._id,value:t._id},t.location||"Unnamed Warehouse")))),e.createElement("div",{className:"mb-3"},e.createElement(p,null,"SKU"),e.createElement(D,{value:r.sku,onChange:t=>i({...r,sku:t.target.value}),required:!0})),e.createElement("div",{className:"mb-3"},e.createElement(p,null,"Quantity"),e.createElement(D,{type:"number",value:r.quantity,onChange:t=>i({...r,quantity:t.target.value}),required:!0})),e.createElement("div",{className:"mb-3"},e.createElement(p,null,"Stock Level"),e.createElement(D,{type:"number",value:r.stock_level,onChange:t=>i({...r,stock_level:t.target.value}),required:!0})),e.createElement("div",{className:"mb-3"},e.createElement(p,null,"Status"),e.createElement(q,{value:r.status,onChange:t=>i({...r,status:t.target.value})},e.createElement("option",{value:"In Stock"},"In Stock"),e.createElement("option",{value:"Out of Stock"},"Out of Stock"),e.createElement("option",{value:"Pending"},"Pending")))),e.createElement(ae,null,e.createElement(k,{color:"secondary",onClick:()=>h(!1)},"Cancel"),e.createElement(k,{color:"primary",type:"submit"},"Create")))),e.createElement(Z,{visible:x,onClose:()=>d(!1)},e.createElement(ee,null,e.createElement(re,null,"Confirm Delete")),e.createElement(te,null,"Are you sure you want to delete the selected item(s)?"),e.createElement(ae,null,e.createElement(k,{color:"secondary",onClick:()=>d(!1)},"Cancel"),e.createElement(k,{color:"danger",onClick:ie},"Delete"))))};export{Ue as default};
