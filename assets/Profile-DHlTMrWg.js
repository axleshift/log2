import{i as $,r as p,j as e}from"./index-B9rQ-kmE.js";import{a as y}from"./index-DW_MHI2K.js";import{C as A,a as I}from"./CCardBody-Dywmzwhl.js";import{C as L}from"./CCardHeader-C6ZKMTzh.js";import{C as x,a as t}from"./CRow-BN1XSdcy.js";import{o as E}from"./CNavItem-DMaIUZz7.js";import{b as P}from"./CContainer-DdWdpS7d.js";import{C as k}from"./CForm-Bi1jMJNo.js";import{C as n}from"./CFormControlWrapper-Bjgrupxp.js";import{C as d}from"./CFormInput-DeJQvQXs.js";import"./CCloseButton-r9Y6HIOX.js";const W=()=>{const C="https://backend-log2.axleshift.com/api/v1/profile",{accessToken:m,user:i,profile:s,setProfile:f}=$(),[j,u]=p.useState("https://placehold.co/150"),[g,h]=p.useState(!0),[v,c]=p.useState(null),[b,N]=p.useState(!1),S=async()=>{if(!(i!=null&&i._id)||!m)return c("User ID or Access Token is missing.");try{const r=(await y.get(`${C}/${i._id}`,{headers:{Authorization:`Bearer ${m}`},timeout:5e3})).data;r.email?(f(r),u(r.avatar||"https://placehold.co/150")):c("Email is required in profile data."),localStorage.setItem("profile",JSON.stringify(r)),h(!1)}catch{c("Error fetching profile."),h(!1)}};p.useEffect(()=>{i&&m&&!s?S():s&&(u(s.avatar||"https://placehold.co/150"),h(!1))},[i,m,s]);const l=a=>{const{name:r,value:o}=a.target;f(w=>({...w,[r]:o||""}))},F=async a=>{if(a.preventDefault(),!s.email){c("Email is required.");return}h(!0);try{const o=(await y.put(`${C}/${i._id}`,s,{headers:{Authorization:`Bearer ${m}`}})).data;localStorage.setItem("profile",JSON.stringify(o)),f(o),u(o.avatar||"https://placehold.co/150"),c(null)}catch{c("There was an issue updating your profile.")}finally{h(!1)}};return g?e.jsx("div",{children:"Loading..."}):s?e.jsx("div",{className:"profile-page",children:e.jsxs(A,{className:"mb-4",children:[e.jsx(L,{children:e.jsx("h5",{children:"User Profile"})}),e.jsxs(I,{children:[v&&e.jsx("div",{className:"alert alert-danger",children:v}),e.jsxs(x,{children:[e.jsxs(t,{md:3,className:"text-center",children:[e.jsx(E,{src:j.startsWith("http")?j:`/src/assets/images/${j}`,alt:"Profile Picture",className:"mb-3",rounded:!0,width:150}),e.jsx(P,{color:"primary",onClick:()=>N(!b),children:"Choose Avatar"}),b&&e.jsx("div",{className:"d-flex flex-wrap justify-content-center mt-3",children:avatarOptions.map((a,r)=>e.jsx(E,{src:`/src/assets/images/${a}`,alt:`Avatar ${r+1}`,width:60,height:60,className:`m-2 avatar-option ${s.avatar===a?"selected":""}`,onClick:()=>{f(o=>({...o,avatar:a})),u(a),N(!1)},style:{cursor:"pointer",borderRadius:"50%",border:s.avatar===a?"3px solid blue":"none"}},r))})]}),e.jsxs(t,{md:9,children:[e.jsx("h6",{className:"mb-4",children:"Personal Details"}),e.jsxs(k,{onSubmit:F,children:[e.jsxs(x,{className:"mb-3",children:[e.jsxs(t,{md:6,children:[e.jsx(n,{htmlFor:"firstName",children:"First Name"}),e.jsx(d,{id:"firstName",name:"firstName",value:s.firstName||"",onChange:l,placeholder:"Enter first name"})]}),e.jsxs(t,{md:6,children:[e.jsx(n,{htmlFor:"lastName",children:"Last Name"}),e.jsx(d,{id:"lastName",name:"lastName",value:s.lastName||"",onChange:l,placeholder:"Enter last name"})]})]}),e.jsxs(x,{className:"mb-3",children:[e.jsxs(t,{md:6,children:[e.jsx(n,{htmlFor:"email",children:"Email"}),e.jsx(d,{id:"email",name:"email",value:s.email||"",onChange:l,placeholder:"Enter email",disabled:!0})]}),e.jsxs(t,{md:6,children:[e.jsx(n,{htmlFor:"phone",children:"Phone"}),e.jsx(d,{id:"phone",name:"phone",value:s.phone||"",onChange:l,placeholder:"Enter phone number"})]})]}),e.jsxs(x,{className:"mb-3",children:[e.jsxs(t,{md:6,children:[e.jsx(n,{htmlFor:"address",children:"Address"}),e.jsx(d,{id:"address",name:"address",value:s.address||"",onChange:l,placeholder:"Enter address"})]}),e.jsxs(t,{md:6,children:[e.jsx(n,{htmlFor:"city",children:"City"}),e.jsx(d,{id:"city",name:"city",value:s.city||"",onChange:l,placeholder:"Enter city"})]}),e.jsxs(t,{md:6,children:[e.jsx(n,{htmlFor:"bio",children:"Bio"}),e.jsx(d,{id:"bio",name:"bio",value:s.bio||"",onChange:l,placeholder:"Enter bio"})]})]}),e.jsx(P,{type:"submit",color:"primary",disabled:g,children:g?"Submitting...":"Save Changes"})]})]})]})]})]})}):e.jsx("div",{children:"No profile found. Please log in."})};export{W as default};
