import{r as n,R as e,C as D}from"./index-CVXZKmLB.js";import{C as d,a as i}from"./CCardBody-Dgfl31BA.js";import{C as E}from"./CCardHeader-kl5Q3YQb.js";import{C as F}from"./CTable-CvbzxBxb.js";import{b as r}from"./CContainer-CUBQWJe-.js";import{f as h,g as v,j as b,k as g}from"./CNavItem-Di_elR9g.js";import{C as $}from"./CForm-CknhkglT.js";import{C as c}from"./CFormInput-Clsh0Ufx.js";import"./CCloseButton-Ep9ySGeW.js";import"./CFormControlWrapper-B3qIZ7fL.js";const U=()=>{const[P,p]=n.useState([]),[S,w]=n.useState(!0),[y,f]=n.useState(null),[N,u]=n.useState(!1),[k,s]=n.useState(!1),[a,o]=n.useState(null);n.useEffect(()=>{(async()=>{try{const l=await fetch("https://backend-log2.axleshift.com/api/v1/payments");if(!l.ok)throw new Error("Failed to fetch payments");const m=await l.json();p(m)}catch(l){f(l.message)}finally{w(!1)}})()},[]);const x=t=>{o(t),u(!0)},V=t=>{o(t),s(!0)},I=async t=>{t.preventDefault();try{const l=await fetch(`https://backend-log2.axleshift.com/api/v1/payments/${a._id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({paymentId:a.paymentId,amount:a.amount,status:a.status})});if(!l.ok)throw new Error("Failed to update payment");const m=await l.json();p(M=>M.map(C=>C._id===m._id?m:C)),s(!1)}catch(l){f(l.message)}};return S?e.createElement(d,null,e.createElement(E,null,"Payments"),e.createElement(i,{className:"text-center"},e.createElement(D,{color:"primary"}),e.createElement("p",null,"Loading payments..."))):y?e.createElement(d,null,e.createElement(E,null,"Payments"),e.createElement(i,{className:"text-center text-danger"},e.createElement("p",null,"Error: ",y))):e.createElement(d,null,e.createElement(E,null,"Payments"),e.createElement(i,null,e.createElement(F,{bordered:!0,hover:!0,responsive:!0},e.createElement("thead",null,e.createElement("tr",null,e.createElement("th",null,"#"),e.createElement("th",null,"Payment ID"),e.createElement("th",null,"Amount"),e.createElement("th",null,"Status"),e.createElement("th",null,"Vendor"),e.createElement("th",null,"Actions"))),e.createElement("tbody",null,P.map((t,l)=>e.createElement("tr",{key:t._id},e.createElement("td",null,l+1),e.createElement("td",null,t.paymentId),e.createElement("td",null,"$",t.amount),e.createElement("td",null,t.status),e.createElement("td",null,t.vendor?t.vendor.name:"No vendor assigned"),e.createElement("td",null,e.createElement(r,{color:"info",onClick:()=>x(t)},"View"),e.createElement(r,{color:"warning",className:"ms-2",onClick:()=>V(t)},"Edit"))))))),e.createElement(h,{visible:N,onClose:()=>u(!1)},e.createElement(v,null,"Payment Details"),e.createElement(b,null,a&&e.createElement("div",null,e.createElement("p",null,e.createElement("strong",null,"Payment ID:")," ",a.paymentId),e.createElement("p",null,e.createElement("strong",null,"Amount:")," $",a.amount),e.createElement("p",null,e.createElement("strong",null,"Status:")," ",a.status),e.createElement("p",null,e.createElement("strong",null,"Vendor:")," ",a.vendor?a.vendor.name:"No vendor assigned")," ")),e.createElement(g,null,e.createElement(r,{color:"secondary",onClick:()=>u(!1)},"Close"))),e.createElement(h,{visible:k,onClose:()=>s(!1)},e.createElement(v,null,"Edit Payment"),e.createElement(b,null,a&&e.createElement($,{onSubmit:I},e.createElement("div",{className:"mb-3"},e.createElement(c,{type:"text",label:"Payment ID",value:a.paymentId,disabled:!0})),e.createElement("div",{className:"mb-3"},e.createElement(c,{type:"number",label:"Amount",value:a.amount,onChange:t=>o({...a,amount:t.target.value})})),e.createElement("div",{className:"mb-3"},e.createElement(c,{type:"text",label:"Status",value:a.status,onChange:t=>o({...a,status:t.target.value})})),e.createElement("div",{className:"mb-3"},e.createElement(c,{type:"text",label:"Vendor",value:a.vendor?a.vendor.name:"No vendor assigned",disabled:!0})),e.createElement(g,null,e.createElement(r,{color:"secondary",onClick:()=>s(!1)},"Cancel"),e.createElement(r,{type:"submit",color:"primary"},"Save Changes"))))))};export{U as default};
