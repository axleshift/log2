import{y as B,r as o,R as e,C as D}from"./index-CBDYk9Ao.js";import{a as y}from"./index-C88pvD_q.js";import{C as Q,a as q,b as w,c as x}from"./CToaster-BQUAAx07.js";import{C as H,a as $}from"./CCardBody-E11mcyvL.js";import{C as k}from"./CCardHeader-BshgPxRz.js";import{C as L}from"./CForm-CVAKrr0v.js";import{C as i}from"./CFormInput-CYaNQEFx.js";import{C as N}from"./CFormTextarea-Cq-VIqwu.js";import{C as I}from"./CFormSelect-DrsQRXU_.js";import{C as U,a as V,b as h,c as u,d as z,e as d}from"./CTable-Di3XAasM.js";import{b as j}from"./CContainer-BVTxmlXV.js";import"./CCloseButton-DIWbhS5b.js";import"./CNavItem-BCds_oRM.js";import"./CFormControlWrapper-BjTevJ5s.js";const re=()=>{const{id:p}=B(),[t,C]=o.useState({title:"",description:"",department:"",deadline:"",budget:"",evaluationCriteria:"",procurementId:p,products:[]}),[E,b]=o.useState(!1),[g,T]=o.useState(null),[n,c]=o.useState({visible:!1,message:"",type:""});o.useEffect(()=>{(async()=>{try{const r=await y.get(`https://backend-log2.axleshift.com/api/v1/procurement/${p}`);C(l=>({...l,title:`RFQ for ${r.data.title}`,department:r.data.department,products:r.data.products.map(m=>({...m,unitPrice:m.unitPrice||""}))}))}catch{T("Failed to load procurement details.")}})()},[p]);const s=a=>{C({...t,[a.target.name]:a.target.value})},P=(a,r)=>{const{name:l,value:m}=r.target;C(f=>{const R=f.products.map((v,S)=>S===a?{...v,[l]:m}:v);return{...f,products:R}})},F=async a=>{a.preventDefault(),b(!0);try{const r={...t,budget:Number(t.budget)||0,products:t.products.map(l=>({...l,unitPrice:Number(l.unitPrice)||0}))};await y.post("https://backend-log2.axleshift.com/api/v1/rfq/create",r),c({visible:!0,message:"RFQ successfully created!",type:"success"}),setTimeout(()=>c({visible:!1,message:"",type:""}),3e3)}catch{c({visible:!0,message:"Failed to create RFQ.",type:"danger"}),setTimeout(()=>c({visible:!1,message:"",type:""}),3e3)}finally{b(!1)}};return e.createElement(e.Fragment,null,e.createElement(Q,null,n.visible&&e.createElement(q,{autohide:!0,delay:3e3,visible:n.visible,color:n.type},e.createElement(w,{closeButton:!0},n.type==="success"?"Success":"Error"),e.createElement(x,null,n.message))),e.createElement(H,null,e.createElement(k,null,"Create RFQ"),e.createElement($,null,g&&e.createElement("p",{style:{color:"red"}},g),e.createElement(L,{onSubmit:F},e.createElement(i,{label:"Title",name:"title",value:t.title,onChange:s,required:!0}),e.createElement(N,{label:"Description",name:"description",value:t.description,onChange:s}),e.createElement(i,{label:"Department",value:t.department,disabled:!0}),e.createElement(i,{type:"date",label:"Deadline",name:"deadline",value:t.deadline,onChange:s,required:!0}),e.createElement(i,{type:"number",label:"Budget",name:"budget",value:t.budget,onChange:s}),e.createElement(I,{label:"Evaluation Criteria",name:"evaluationCriteria",value:t.evaluationCriteria,onChange:s},e.createElement("option",{value:""},"Select Criteria"),e.createElement("option",{value:"Lowest Price"},"Lowest Price"),e.createElement("option",{value:"Best Value"},"Best Value"),e.createElement("option",{value:"Technical Compliance"},"Technical Compliance")),t.products.length>0&&e.createElement(e.Fragment,null,e.createElement("h5",null,"Products"),e.createElement(U,{striped:!0,bordered:!0,responsive:!0},e.createElement(V,null,e.createElement(h,null,e.createElement(u,null,"Product Name"),e.createElement(u,null,"Quantity"),e.createElement(u,null,"Unit"),e.createElement(u,null,"Unit Price"))),e.createElement(z,null,t.products.map((a,r)=>e.createElement(h,{key:r},e.createElement(d,null,a.name),e.createElement(d,null,a.quantity),e.createElement(d,null,a.unit),e.createElement(d,null,e.createElement(i,{type:"number",name:"unitPrice",value:a.unitPrice,onChange:l=>P(r,l)}))))))),e.createElement(j,{color:"primary",type:"submit",disabled:E},E?e.createElement(D,{size:"sm"}):"Create RFQ")))))};export{re as default};
