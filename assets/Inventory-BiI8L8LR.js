import{r as l,_ as ue,a as o,j as H,F as X,b as $,c as P,P as d,u as me,R as e,C as he}from"./index-CaeG1fis.js";import{a as C}from"./index-t--hEgTQ.js";import{C as pe,a as fe}from"./CCardBody-5iJwjPps.js";import{C as ve}from"./CCardHeader-CACMNc55.js";import{C as Ee,a as be}from"./CInputGroupText-CU9A1EYT.js";import{C as p,c as ne,a as D}from"./CFormInput-YJIkf5sQ.js";import{c as k}from"./CRow-0bSjJRSx.js";import{f as ye,g as Ce,h as Q,j as g,k as ke,l as E,b as Z,c as ee,m as te,d as ae,e as re}from"./CTable-DLg6VT4M.js";import{u as ge}from"./CCloseButton-oKv6rBAu.js";import{C as Se}from"./CForm-CH4J0Y6z.js";import{C as q}from"./CFormSelect-CqoA9wAZ.js";var B=l.forwardRef(function(r,M){var S=r.className,c=r.button,N=r.feedback,A=r.feedbackInvalid,O=r.feedbackValid,x=r.floatingLabel,U=r.tooltipFeedback,I=r.hitArea,f=r.id,b=r.indeterminate,V=r.inline,v=r.invalid,y=r.label,j=r.reverse,w=r.type,T=w===void 0?"checkbox":w,s=r.valid,R=ue(r,["className","button","feedback","feedbackInvalid","feedbackValid","floatingLabel","tooltipFeedback","hitArea","id","indeterminate","inline","invalid","label","reverse","type","valid"]),m=l.useRef(null),z=ge(M,m);l.useEffect(function(){m.current&&b&&(m.current.indeterminate=b)},[b,m.current]);var h=function(){return o("input",{...$({type:T,className:P(c?"btn-check":"form-check-input",{"is-invalid":v,"is-valid":s,"me-2":I}),id:f},R,{ref:z})})},a=function(){return o(ne,{describedby:R["aria-describedby"],feedback:N,feedbackInvalid:A,feedbackValid:O,floatingLabel:x,invalid:v,tooltipFeedback:U,valid:s})},i=function(){var _;return o(p,{...$({customClassName:P(c?P("btn",c.variant?"btn-".concat(c.variant,"-").concat(c.color):"btn-".concat(c.color),(_={},_["btn-".concat(c.size)]=c.size,_),"".concat(c.shape)):"form-check-label")},f&&{htmlFor:f}),children:y})},F=function(){return c?H(X,{children:[o(h,{}),y&&o(i,{}),o(a,{})]}):y?I?H(X,{children:[o(h,{}),o(p,{...$({customClassName:P("form-check-label stretched-link",S)},f&&{htmlFor:f}),children:y}),o(a,{})]}):H("div",{className:P("form-check",{"form-check-inline":V,"form-check-reverse":j,"is-invalid":v,"is-valid":s},S),children:[o(h,{}),o(i,{}),o(a,{})]}):o(h,{})};return o(F,{})});B.propTypes=$({button:d.object,className:d.string,hitArea:d.oneOf(["full"]),id:d.string,indeterminate:d.bool,inline:d.bool,label:d.oneOfType([d.string,d.node]),reverse:d.bool,type:d.oneOf(["checkbox","radio"])},ne.propTypes);B.displayName="CFormCheck";const K="https://backend-log2.axleshift.com",G=`${K}/api/v1/inventory`,Ne=`${K}/api/v1/shipment`,Ae=`${K}/api/v1/product`,Ie="https://backend-log1.axleshift.com/api/v1/warehouseLoc/locations",Be=()=>{const{accessToken:r}=me(),[M,S]=l.useState(!1),[c,N]=l.useState(new Set),[A,O]=l.useState([]),[x,U]=l.useState([]),[I,f]=l.useState([]),[b,V]=l.useState([]),[v,y]=l.useState(""),[j,w]=l.useState(!1),[T,s]=l.useState(""),[R,m]=l.useState(!1),[z,h]=l.useState(!1),[a,i]=l.useState({shipment:"",warehouse_id:"",product:"",sku:"",quantity:"",stock_level:"",status:"In Stock"});l.useEffect(()=>{F(),_(),le(),ce()},[]);const F=async()=>{w(!0);try{const t=await C.get(G,{headers:{Authorization:`Bearer ${r}`}});O(Array.isArray(t.data)?t.data:[])}catch{s("Error fetching inventory data.")}finally{w(!1)}},_=async()=>{var t;try{const n=await C.get(Ne,{headers:{Authorization:`Bearer ${r}`}});U(((t=n.data)==null?void 0:t.shipments)||[])}catch{console.error("Failed to fetch shipments")}},le=async()=>{try{const t=await C.get(Ae,{headers:{Authorization:`Bearer ${r}`}});f(t.data||[])}catch{console.error("Failed to fetch products")}},ce=async()=>{var t;try{const n=await C.get(Ie,{headers:{"Content-Type":"application/json","x-api-key":"0ad3f5c013c42d2d0537672a260978c71dcd5a7d508019d748f991deee3d65665a477e3523c6bbc83fd6a51a71dd5003"}});V(((t=n.data)==null?void 0:t.data)||[])}catch(n){console.error("Failed to fetch warehouses",n)}},Y=l.useMemo(()=>A.filter(t=>{var n;return(((n=t.shipment)==null?void 0:n.tracking_id)||"").toLowerCase().includes(v.toLowerCase())}),[A,v]),oe=t=>{const n=t.target.checked;S(n),N(n?new Set(A.map(u=>u._id)):new Set)},se=(t,n)=>{const u=new Set(c);t.target.checked?u.add(n):u.delete(n),N(u)},ie=async()=>{if(!c.size)return s("Please select items to delete.");try{await Promise.all(Array.from(c).map(t=>C.delete(`${G}/${t}`,{headers:{Authorization:`Bearer ${r}`}}))),s("Selected items deleted successfully."),N(new Set),S(!1),F()}catch{s("Error deleting selected items.")}finally{m(!1)}},de=async t=>{var L,J;t.preventDefault();const n=W=>/^[a-f\d]{24}$/i.test(W);if(!n(a.shipment)||!n(a.product)||!n(a.warehouse_id))return s("Shipment, Product, and Warehouse must be valid ObjectIDs.");const u={...a,quantity:Number(a.quantity),stock_level:Number(a.stock_level)};try{await C.post(G,u,{headers:{Authorization:`Bearer ${r}`}}),s("New inventory item created."),i({shipment:"",warehouse_id:"",product:"",sku:"",quantity:"",stock_level:"",status:"In Stock"}),h(!1),F()}catch(W){s(((J=(L=W.response)==null?void 0:L.data)==null?void 0:J.error)||"Failed to create item.")}};return e.createElement(pe,null,e.createElement(ve,{className:"text-center py-3"},"Warehouse Inventory"),e.createElement(fe,null,T&&e.createElement("div",{className:"alert alert-info"},T),e.createElement("div",{className:"d-flex justify-content-between align-items-center mb-4"},e.createElement(Ee,{style:{maxWidth:"400px"}},e.createElement(be,null,"Search"),e.createElement(D,{type:"text",placeholder:"Search by Tracking ID",value:v,onChange:t=>y(t.target.value)})),e.createElement("div",{className:"d-flex gap-2"},e.createElement(k,{color:"success",onClick:()=>h(!0)},"+ New Item"),e.createElement(k,{color:"danger",onClick:()=>m(!0)},"Delete"))),j?e.createElement("div",{className:"text-center py-5"},e.createElement(he,{color:"primary"})):e.createElement(ye,{striped:!0,hover:!0,responsive:!0},e.createElement(Ce,null,e.createElement(Q,null,e.createElement(g,null,e.createElement(B,{checked:M,onChange:oe})),e.createElement(g,null,"Tracking ID"),e.createElement(g,null,"Product"),e.createElement(g,null,"SKU"),e.createElement(g,null,"Quantity"),e.createElement(g,null,"Stock Level"))),e.createElement(ke,null,Y.length>0?Y.map(t=>{var n,u;return e.createElement(Q,{key:t._id},e.createElement(E,null,e.createElement(B,{checked:c.has(t._id),onChange:L=>se(L,t._id)})),e.createElement(E,null,((n=t.shipment)==null?void 0:n.tracking_id)||"N/A"),e.createElement(E,null,((u=t.product)==null?void 0:u.name)||"N/A"),e.createElement(E,null,t.sku),e.createElement(E,null,t.quantity),e.createElement(E,null,t.stock_level))}):e.createElement(Q,null,e.createElement(E,{colSpan:"6",className:"text-center"},"No inventory records found."))))),e.createElement(Z,{visible:z,onClose:()=>h(!1)},e.createElement(ee,null,e.createElement(te,null,"New Inventory Item")),e.createElement(Se,{onSubmit:de},e.createElement(ae,null,e.createElement("div",{className:"mb-3"},e.createElement(p,null,"Shipment"),e.createElement(q,{value:a.shipment,onChange:t=>i({...a,shipment:t.target.value}),required:!0},e.createElement("option",{value:""},"Select Shipment"),Array.isArray(x)&&x.map(t=>e.createElement("option",{key:t._id,value:t._id},t.tracking_id||"Unnamed Shipment")))),e.createElement("div",{className:"mb-3"},e.createElement(p,null,"Product"),e.createElement(q,{value:a.product,onChange:t=>i({...a,product:t.target.value}),required:!0},e.createElement("option",{value:""},"Select Product"),Array.isArray(I)&&I.map(t=>e.createElement("option",{key:t._id,value:t._id},t.name||"Unnamed Product")))),e.createElement("div",{className:"mb-3"},e.createElement(p,null,"Warehouse"),e.createElement(q,{value:a.warehouse_id,onChange:t=>i({...a,warehouse_id:t.target.value}),required:!0},e.createElement("option",{value:""},"Select Warehouse"),Array.isArray(b)&&b.map(t=>e.createElement("option",{key:t._id,value:t._id},t.warehouseName," - ",t.address," ")))),e.createElement("div",{className:"mb-3"},e.createElement(p,null,"SKU"),e.createElement(D,{value:a.sku,onChange:t=>i({...a,sku:t.target.value}),required:!0})),e.createElement("div",{className:"mb-3"},e.createElement(p,null,"Quantity"),e.createElement(D,{type:"number",value:a.quantity,onChange:t=>i({...a,quantity:t.target.value}),required:!0})),e.createElement("div",{className:"mb-3"},e.createElement(p,null,"Stock Level"),e.createElement(D,{type:"number",value:a.stock_level,onChange:t=>i({...a,stock_level:t.target.value}),required:!0})),e.createElement("div",{className:"mb-3"},e.createElement(p,null,"Status"),e.createElement(q,{value:a.status,onChange:t=>i({...a,status:t.target.value})},e.createElement("option",{value:"In Stock"},"In Stock"),e.createElement("option",{value:"Out of Stock"},"Out of Stock"),e.createElement("option",{value:"Pending"},"Pending")))),e.createElement(re,null,e.createElement(k,{color:"secondary",onClick:()=>h(!1)},"Cancel"),e.createElement(k,{color:"primary",type:"submit"},"Create")))),e.createElement(Z,{visible:R,onClose:()=>m(!1)},e.createElement(ee,null,e.createElement(te,null,"Confirm Delete")),e.createElement(ae,null,"Are you sure you want to delete the selected item(s)?"),e.createElement(re,null,e.createElement(k,{color:"secondary",onClick:()=>m(!1)},"Cancel"),e.createElement(k,{color:"danger",onClick:ie},"Delete"))))};export{Be as default};
