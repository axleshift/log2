import{u as z,r as a,R as e,C as E}from"./index-QHt0BNF-.js";import{a as g}from"./index-xsH4HHeE.js";import{C as D}from"./CFormSelect-BKzCe16h.js";import{a as M}from"./CFormInput-BdJGZwOp.js";import{e as H,f as U,g as v,h as p,j as W,k as i,l as O,m as G,n as J,o as K}from"./CTable-DhIoX8qk.js";import{c as d}from"./CRow-Ce6guADD.js";import{a as X,b as Y,c as Z,d as q}from"./DefaultLayout-B8VGAksF.js";import"./CCloseButton-DubpZP9d.js";import"./CFormTextarea-OgHKVdzt.js";import"./CForm-B7FIKFam.js";import"./index.esm-D1lQqmIc.js";import"./CCardBody-DTdIa86a.js";import"./CCardHeader-BvbB9qDc.js";import"./CAlert-ZjTU6H8E.js";import"./cil-user-Ddrdy7PS.js";import"./index-C0QOyGfk.js";const ee="https://backend-log2.axleshift.com",b=`${ee}/api/v1/vendor-quotes`,he=()=>{var F,w;const{accessToken:f}=z(),[y,N]=a.useState([]),[S,$]=a.useState([]),[n,I]=a.useState(null),[m,R]=a.useState("All"),[u,k]=a.useState(""),[B,C]=a.useState(!1),[P,A]=a.useState(!1),[r,h]=a.useState(null),[o,Q]=a.useState({visible:!1,message:"",color:""});a.useEffect(()=>{T()},[]),a.useEffect(()=>{V()},[y,m,u]);const T=async()=>{A(!0);try{const t=await g.get(b,{headers:{Authorization:`Bearer ${f}`}});N(t.data)}catch(t){console.error("Failed to fetch vendor quotes",t),c("Failed to fetch vendor quotes","danger")}finally{A(!1)}},V=()=>{let t=[...y];if(m!=="All"&&(t=t.filter(l=>l.status===m)),u.trim()){const l=u.toLowerCase();t=t.filter(s=>{var x,L;return(((x=s.vendorId)==null?void 0:x.businessName)||((L=s.vendorId)==null?void 0:L.fullName)||"").toLowerCase().includes(l)})}$(t)},c=(t,l="success")=>{Q({visible:!0,message:t,color:l})},_=async(t,l)=>{h(t);try{await g.put(`${b}/${t}/status`,{status:l},{headers:{Authorization:`Bearer ${f}`}}),await T(),c(`Quote ${l.toLowerCase()} successfully!`)}catch(s){console.error("Failed to update status",s),c("Failed to update status","danger")}finally{h(null)}},j=async t=>{try{await g.delete(`${b}/${t}`,{headers:{Authorization:`Bearer ${f}`}}),N(l=>l.filter(s=>s._id!==t)),c("Quote deleted successfully!")}catch(l){console.error("Failed to delete quote",l),c("Failed to delete quote","danger")}finally{h(null)}};return e.createElement("div",{className:"p-4 max-w-4xl mx-auto"},e.createElement("h1",{className:"mb-4 fw-bold"},"RFQ Details â€“ Submitted Quotes"),e.createElement("div",{className:"d-flex justify-content-between mb-3"},e.createElement(D,{value:m,onChange:t=>R(t.target.value),style:{maxWidth:200}},e.createElement("option",{value:"All"},"All"),e.createElement("option",{value:"Pending"},"Pending"),e.createElement("option",{value:"Accepted"},"Accepted"),e.createElement("option",{value:"Rejected"},"Rejected")),e.createElement(M,{placeholder:"Search Vendor",value:u,onChange:t=>k(t.target.value),style:{maxWidth:300}})),P?e.createElement("div",{className:"text-center my-5"},e.createElement(E,null),e.createElement("div",null,"Loading quotes...")):e.createElement(H,{striped:!0,hover:!0,responsive:!0},e.createElement(U,null,e.createElement(v,null,e.createElement(p,null,"Vendor Name"),e.createElement(p,null,"Price"),e.createElement(p,null,"Status"),e.createElement(p,null,"Actions"))),e.createElement(W,null,S.length===0?e.createElement(v,null,e.createElement(i,{colSpan:4,className:"text-center"},"No quotes found.")):S.map(t=>{var l,s;return e.createElement(v,{key:t._id},e.createElement(i,null,((l=t.vendorId)==null?void 0:l.businessName)||((s=t.vendorId)==null?void 0:s.fullName)||"N/A"),e.createElement(i,null,"$",Number(t.price).toLocaleString()),e.createElement(i,null,t.status),e.createElement(i,null,e.createElement(d,{color:"info",onClick:()=>{I(t),C(!0)},disabled:r===t._id},"View"),t.status==="Pending"&&e.createElement(e.Fragment,null,e.createElement(d,{color:"success",className:"ms-2",onClick:()=>_(t._id,"Accepted"),disabled:r===t._id},r===t._id?e.createElement(E,{size:"sm"}):"Accept"),e.createElement(d,{color:"danger",className:"ms-2",onClick:()=>_(t._id,"Rejected"),disabled:r===t._id},r===t._id?e.createElement(E,{size:"sm"}):"Reject")),e.createElement(d,{color:"danger",className:"ms-2",onClick:()=>j(t._id),disabled:r===t._id},r===t._id?e.createElement(E,{size:"sm"}):"Delete")))}))),e.createElement(O,{visible:B,onClose:()=>C(!1)},e.createElement(G,{closeButton:!0},"Quote Details"),e.createElement(J,null,n&&e.createElement(e.Fragment,null,e.createElement("p",null,e.createElement("strong",null,"Vendor:")," ",((F=n.vendorId)==null?void 0:F.businessName)||((w=n.vendorId)==null?void 0:w.fullName)||"N/A"),e.createElement("p",null,e.createElement("strong",null,"Price:")," $",Number(n.price).toLocaleString()),e.createElement("p",null,e.createElement("strong",null,"Details:")," ",n.details||"No details provided."))),e.createElement(K,null,e.createElement(d,{color:"secondary",onClick:()=>C(!1)},"Close"))),e.createElement(X,{placement:"top-end"},o.visible&&e.createElement(Y,{color:o.color,autohide:!0,delay:3e3,show:o.visible,fade:!0,onClose:()=>Q({visible:!1,message:"",color:""})},e.createElement(Z,null,o.color==="danger"?"Error":"Success"),e.createElement(q,null,o.message))))};export{he as default};
