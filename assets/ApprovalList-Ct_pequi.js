import{n as A,u as R,r as o,R as e,C as u}from"./index-Dbh7qAQo.js";import{a as d}from"./index-xsH4HHeE.js";import{C as $,a as b}from"./CCardBody-C_3c75SN.js";import{C as T}from"./CCardHeader-DvKbsVKd.js";import{e as k,f as B,g as p,h as s,j as P,k as a}from"./CTable-DPQMGb4T.js";import{c as E}from"./CRow-CKCNacdJ.js";import"./CCloseButton-Bf1kVb3D.js";const h="https://backend-log2.axleshift.com/api/v1/procurement",U=()=>{const f=A(),{accessToken:l}=R(),[C,i]=o.useState([]),[y,g]=o.useState(!0),[n,c]=o.useState(null);o.useEffect(()=>{(async()=>{try{const r=await d.get(`${h}?status=Pending`,{headers:{Authorization:`Bearer ${l}`}});i(r.data)}catch(r){console.error("Error fetching procurements:",r)}finally{g(!1)}})()},[l]);const _=async t=>{try{c(t),await d.patch(`${h}/${t}/approve`,{},{headers:{Authorization:`Bearer ${l}`}}),i(r=>r.filter(m=>m._id!==t))}catch(r){alert("Failed to approve procurement"),console.error(r)}finally{c(null)}},v=async t=>{try{c(t),await d.patch(`${h}/${t}/reject`,null,{headers:{Authorization:`Bearer ${l}`}}),i(r=>r.filter(m=>m._id!==t))}catch(r){alert("Failed to reject procurement"),console.error(r)}finally{c(null)}};return y?e.createElement(u,{color:"primary"}):e.createElement($,null,e.createElement(T,null,e.createElement("h5",null,"Approval List")),e.createElement(b,null,e.createElement(k,{hover:!0,responsive:!0},e.createElement(B,null,e.createElement(p,null,e.createElement(s,null,"Title"),e.createElement(s,null,"Department"),e.createElement(s,null,"Requested By"),e.createElement(s,null,"Actions"))),e.createElement(P,null,C.length>0?C.map(t=>{var r;return e.createElement(p,{key:t._id},e.createElement(a,null,t.title),e.createElement(a,null,t.department),e.createElement(a,null,((r=t.requestedBy)==null?void 0:r.email)||"Unknown"),e.createElement(a,null,e.createElement(E,{color:"primary",className:"me-2",onClick:()=>f(`/procurement/${t._id}`)},"View Details"),e.createElement(E,{color:"success",className:"me-2",onClick:()=>_(t._id),disabled:n===t._id},n===t._id?e.createElement(u,{size:"sm"}):"Approve"),e.createElement(E,{color:"danger",disabled:n===t._id,onClick:()=>v(t._id)},n===t._id?e.createElement(u,{size:"sm"}):"Reject")))}):e.createElement(p,null,e.createElement(a,{colSpan:"4"},"No pending Procurement Requests."))))))};export{U as default};
