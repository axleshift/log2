import{r as o,_ as z,R as r,a as F,c as C,P as c,j as e}from"./index-B9rQ-kmE.js";import{a as w}from"./index-DW_MHI2K.js";import{C as W,a as G}from"./CCardBody-Dywmzwhl.js";import{C as Q}from"./CCardHeader-C6ZKMTzh.js";import{C as U,a as Y}from"./CInputGroupText-D3-pjqlF.js";import{C as q}from"./CFormInput-DeJQvQXs.js";import{b as V}from"./CContainer-DdWdpS7d.js";import{C as J,a as K,b as $,c as E,d as X,e as k}from"./CTable-DFh1XnVU.js";import{C as H,b as O}from"./CFormControlWrapper-Bjgrupxp.js";import{u as Z}from"./CCloseButton-r9Y6HIOX.js";import{f as _,g as ee,h as te,j as ae,k as re}from"./CNavItem-DMaIUZz7.js";var I=o.forwardRef(function(a,x){var m=a.className,l=a.button,b=a.feedback,g=a.feedbackInvalid,f=a.feedbackValid,N=a.floatingLabel,R=a.tooltipFeedback,v=a.hitArea,d=a.id,i=a.indeterminate,T=a.inline,h=a.invalid,u=a.label,A=a.reverse,y=a.type,D=y===void 0?"checkbox":y,t=a.valid,n=z(a,["className","button","feedback","feedbackInvalid","feedbackValid","floatingLabel","tooltipFeedback","hitArea","id","indeterminate","inline","invalid","label","reverse","type","valid"]),s=o.useRef(null),j=Z(x,s);o.useEffect(function(){s.current&&i&&(s.current.indeterminate=i)},[i,s.current]);var p=function(){return r.createElement("input",F({type:D,className:C(l?"btn-check":"form-check-input",{"is-invalid":h,"is-valid":t,"me-2":v}),id:d},n,{ref:j}))},L=function(){return r.createElement(O,{describedby:n["aria-describedby"],feedback:b,feedbackInvalid:g,feedbackValid:f,floatingLabel:N,invalid:h,tooltipFeedback:R,valid:t})},B=function(){var M;return r.createElement(H,F({customClassName:C(l?C("btn",l.variant?"btn-".concat(l.variant,"-").concat(l.color):"btn-".concat(l.color),(M={},M["btn-".concat(l.size)]=l.size,M),"".concat(l.shape)):"form-check-label")},d&&{htmlFor:d}),u)},P=function(){return l?r.createElement(r.Fragment,null,r.createElement(p,null),u&&r.createElement(B,null),r.createElement(L,null)):u?v?r.createElement(r.Fragment,null,r.createElement(p,null),r.createElement(H,F({customClassName:C("form-check-label stretched-link",m)},d&&{htmlFor:d}),u),r.createElement(L,null)):r.createElement("div",{className:C("form-check",{"form-check-inline":T,"form-check-reverse":A,"is-invalid":h,"is-valid":t},m)},r.createElement(p,null),r.createElement(B,null),r.createElement(L,null)):r.createElement(p,null)};return r.createElement(P,null)});I.propTypes=F({button:c.object,className:c.string,hitArea:c.oneOf(["full"]),id:c.string,indeterminate:c.bool,inline:c.bool,label:c.oneOfType([c.string,c.node]),reverse:c.bool,type:c.oneOf(["checkbox","radio"])},O.propTypes);I.displayName="CFormCheck";const S="https://backend-log2.axleshift.com/api/v1/inventory",pe=()=>{const[a,x]=o.useState(!1),[m,l]=o.useState(new Set),[b,g]=o.useState([]),[f,N]=o.useState(""),[R,v]=o.useState(!1),[d,i]=o.useState(""),[T,h]=o.useState(!1);o.useEffect(()=>{(async()=>{v(!0);try{const n=await w.get(S,{params:{search:f}});Array.isArray(n.data)?g(n.data):i("Unexpected data format received from the server.")}catch(n){i("Error fetching inventory data."),console.error("Error fetching inventory data:",n)}finally{v(!1)}})()},[f]);const u=o.useMemo(()=>b.filter(t=>t.tracking_id.toLowerCase().includes(f.toLowerCase())),[b,f]),A=t=>{const n=t.target.checked;x(n),l(n?new Set(b.map(s=>s.tracking_id)):new Set)},y=(t,n)=>{const s=new Set(m);t.target.checked?s.add(n):s.delete(n),l(s)},D=async()=>{if(m.size===0){i("Please select at least one item to delete.");return}const t=Array.from(m);try{if(t.length===1){const s=t[0];await w.delete(`${S}/${s}`)}else await w.delete(`${S}/bulk-delete`,{data:{ids:t}});i("Selected items deleted successfully."),l(new Set),x(!1);const n=await w.get(S);g(n.data),h(!1)}catch{i("Error deleting selected items.")}};return e.jsxs(W,{children:[e.jsx(Q,{as:"h5",style:{textAlign:"center",padding:"1rem"},children:"Warehouse Inventory"}),e.jsxs(G,{children:[d&&e.jsx("div",{className:"alert alert-info",children:d}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[e.jsxs(U,{style:{maxWidth:"400px",width:"100%"},children:[e.jsx(Y,{children:"Search"}),e.jsx(q,{type:"text",placeholder:"Search by Tracking ID",value:f,onChange:t=>N(t.target.value)})]}),e.jsx("div",{className:"d-flex",children:e.jsx(V,{color:"danger",shape:"rounded-0",onClick:()=>h(!0),children:"Delete"})})]}),R?e.jsx("div",{children:"Loading..."}):e.jsxs(J,{striped:!0,hover:!0,responsive:!0,children:[e.jsx(K,{children:e.jsxs($,{children:[e.jsx(E,{scope:"col",children:e.jsx(I,{id:"selectAll",checked:a,onChange:A})}),e.jsx(E,{scope:"col",children:"Tracking ID"}),e.jsx(E,{scope:"col",children:"Description"}),e.jsx(E,{scope:"col",children:"Warehouse Location"})]})}),e.jsx(X,{children:u.length>0?u.map((t,n)=>{var s,j;return e.jsxs($,{children:[e.jsx(k,{children:e.jsx(I,{id:`row${t.tracking_id}`,checked:m.has(t.tracking_id),onChange:p=>y(p,t.tracking_id)})}),e.jsx(k,{children:t.tracking_id}),e.jsx(k,{children:((s=t.shipment)==null?void 0:s.shipment_description)||"No description"}),e.jsx(k,{children:((j=t.warehouse)==null?void 0:j.warehouse)||"No warehouse location available"})]},`${t.tracking_id}-${n}`)}):e.jsx($,{children:e.jsx(k,{colSpan:"4",style:{textAlign:"center"},children:"No inventory records found."})})})]})]}),e.jsxs(_,{visible:T,onClose:()=>h(!1),children:[e.jsx(ee,{children:e.jsx(te,{children:"Confirm Delete"})}),e.jsx(ae,{children:"Are you sure you want to delete the selected item(s)?"}),e.jsxs(re,{children:[e.jsx(V,{color:"secondary",onClick:()=>h(!1),children:"Cancel"}),e.jsx(V,{color:"danger",onClick:D,children:"Delete"})]})]})]})};export{pe as default};
