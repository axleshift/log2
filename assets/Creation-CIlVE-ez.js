import{R as t,C as U,P as e,k as x,r as c,i as z}from"./index-BymYdVf9.js";import{C as L}from"./CForm-DqAir1ih.js";import{C as M}from"./CAlert-BMldUZU9.js";import{C as b,a as d}from"./CRow-DBpbnMc3.js";import{C as h}from"./CFormInput-iYJg6Lcv.js";import{C as $}from"./CFormSelect-CY0d7-J5.js";import{C as B}from"./CFormTextarea-BL88QNNQ.js";import{b as D,a as I}from"./CContainer-BW6RyZoO.js";import{a as W}from"./index-C88pvD_q.js";import{C as j,a as K}from"./CCardBody-DKAj1_EX.js";import{C as Q}from"./CCardHeader-C8qsqDXX.js";import"./CCloseButton-CoMusDxn.js";import"./CFormControlWrapper-Dr-zH9-Z.js";function N({formData:o,handleChange:a,handleFileChange:i,handleSubmit:C,loading:l,error:f}){return t.createElement(L,{onSubmit:C},f&&t.createElement(M,{color:"danger"},f),t.createElement(b,null,t.createElement(d,{md:6},t.createElement(h,{name:"itemName",label:"Item Name",value:o.itemName||"",onChange:a,required:!0})),t.createElement(d,{md:6},t.createElement(h,{name:"sku",label:"SKU",value:o.sku||"",onChange:a,disabled:!0}))),t.createElement(b,null,t.createElement(d,{md:6},t.createElement(h,{name:"price",type:"number",label:"Price",value:o.price||"",onChange:a,required:!0})),t.createElement(d,{md:6},t.createElement($,{name:"category",label:"Category",value:o.category||"",onChange:a,required:!0},t.createElement("option",{value:""},"Select Category"),t.createElement("option",{value:"Electronics"},"Electronics"),t.createElement("option",{value:"Clothing"},"Clothing"),t.createElement("option",{value:"Furniture"},"Furniture"),t.createElement("option",{value:"Logistics"},"Logistics"),t.createElement("option",{value:"Office Supplies"},"Office Supplies")))),t.createElement(B,{name:"description",label:"Description",value:o.description||"",onChange:a,required:!0}),t.createElement(h,{name:"images",type:"file",label:"Product Images",multiple:!0,onChange:i}),t.createElement(D,{color:"success",type:"submit",disabled:l},l?t.createElement(U,{size:"sm"}):"Create Product"))}N.propTypes={formData:e.shape({itemName:e.string,sku:e.string,price:e.oneOfType([e.string,e.number]),category:e.string,stockQuantity:e.oneOfType([e.string,e.number]),weight:e.oneOfType([e.string,e.number]),length:e.oneOfType([e.string,e.number]),width:e.oneOfType([e.string,e.number]),height:e.oneOfType([e.string,e.number]),color:e.string,manufacturer:e.string,tags:e.string,size:e.string,status:e.string,description:e.string}).isRequired,handleChange:e.func.isRequired,handleFileChange:e.func.isRequired,handleSubmit:e.func.isRequired,loading:e.bool.isRequired,error:e.string};N.defaultProps={error:""};const X="https://backend-log2.axleshift.com/api/v1/product/create";function oe(){const{accessToken:o}=x(),[a,i]=c.useState({itemName:"",description:"",price:"",category:"",stockQuantity:"",images:[],status:"Available",sku:"",weight:"",length:"",width:"",height:"",manufacturer:"",tags:"",color:"",size:""}),[C,l]=c.useState(!1),[f,S]=c.useState(null),[T,E]=c.useState(""),[w,y]=c.useState("success"),[P,m]=c.useState(!1),k=z(),F=()=>{const r=a.itemName?a.itemName.substring(0,3).toUpperCase():"XXX",s=Math.floor(Math.random()*1e4);return`${r}${s}`},O=()=>{const r=a.itemName?a.itemName.split(" "):[],s=a.category?a.category.split(" "):[];return[...new Set([...r,...s])].map(u=>u.toLowerCase()).join(", ")};c.useEffect(()=>{if(a.itemName&&!a.sku){const r=F();i(s=>({...s,sku:r}))}if(a.itemName||a.category){const r=O();i(s=>({...s,tags:r}))}},[a.itemName,a.category]);const R=r=>{const{name:s,value:p}=r.target;i(u=>({...u,[s]:p!==void 0?p:""}))},q=r=>{i({...a,images:r.target.files?Array.from(r.target.files):[]})},A=async r=>{var u,v;if(r.preventDefault(),l(!0),S(null),!o){E("Authentication error. Please log in again."),y("danger"),m(!0),setTimeout(()=>m(!1),5e3),l(!1);return}const s=new FormData;Object.keys(a).forEach(n=>{n==="images"&&a.images.length>0?a.images.forEach(g=>s.append("images",g)):a[n]&&s.append(n,a[n])});const p=JSON.stringify({length:a.length||0,width:a.width||0,height:a.height||0});s.append("dimensions",p);try{const n={Authorization:`Bearer ${o}`},g=await W.post(X,s,{headers:n});console.log(g.data),i({itemName:"",description:"",price:"",category:"",stockQuantity:"",images:[],status:"Available",sku:"",weight:"",length:"",width:"",height:"",manufacturer:"",tags:"",color:"",size:""}),E("Product created successfully!"),y("success"),m(!0),setTimeout(()=>{m(!1),k("/procurement/product-catalog")},2e3)}catch(n){const g=((v=(u=n.response)==null?void 0:u.data)==null?void 0:v.message)||n.message||"Failed to create product";console.error(g),E(g),y("danger"),m(!0),setTimeout(()=>m(!1),5e3)}finally{l(!1)}};return t.createElement(I,{className:"py-4"},t.createElement(b,{className:"justify-content-center"},t.createElement(d,{md:10,lg:8},t.createElement(j,null,t.createElement(Q,{className:"fw-bold"},"Create New Product"),t.createElement(K,null,t.createElement(N,{formData:a,handleChange:R,handleFileChange:q,handleSubmit:A,loading:C,error:f}),P&&t.createElement("div",{className:`alert alert-${w}`,role:"alert"},T))))))}export{oe as default};
