import{f as F,r as s,j as e,L as n,g as y}from"./index-CG5cXGW0.js";import{u as O,c as U}from"./index.esm-xGuvYLOc.js";import{C}from"./index.esm-DBs-EpJf.js";import{F as _,d as G,e as q}from"./index-DCFH6BHU.js";import{R as V,V as D}from"./config-wfiosbPZ.js";import{C as W,a as i}from"./CContainer-DZvKed_E.js";import{C as x,a as r}from"./CRow-BVAaJJJw.js";import{C as z}from"./CCardGroup-DeHWj0P7.js";import{C as B,a as Y}from"./CCardBody-BuyTEJM8.js";import{C as $}from"./CAlert-TWNuonwF.js";import{C as H}from"./CForm-BCrxAxUr.js";import{C as w,a as N}from"./CInputGroupText-ChCmPa4a.js";import{c as J}from"./cil-user-Ddrdy7PS.js";import{C as b}from"./CFormInput-WRbFKXpa.js";import"./CCloseButton-viBWZYHx.js";import"./Transition-DONipWBO.js";const de=()=>{const S="https://backend-log2.axleshift.com/api/v1/auth",{register:h,handleSubmit:R,formState:{errors:a},reset:k}=O(),P=F(),c=s.useRef(null),l=s.useRef(null),[t,f]=s.useState(!1),[m,o]=s.useState({message:"",type:""}),[g,L]=s.useState(!1);s.useEffect(()=>{c.current&&c.current.focus()},[]);const E=async d=>{f(!0),o({message:"",type:""});try{const p=await l.current.executeAsync();l.current.reset();const j=await fetch(`${S}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...d,recaptcha_ref:p})}),u=await j.json();if(console.log("Response Data:",u),!j.ok)throw new Error(u.message||"Login failed");const{accessToken:v,refreshToken:I,user:A}=u;y.set("token",v,{expires:1,secure:!0,sameSite:"Strict"}),y.set("refreshToken",I,{expires:30,secure:!0}),o({message:"Welcome back! Redirecting to your dashboard...",type:"success"}),k(),A.role==="admin"?P("/dashboard"):o({message:"Unauthorized. You do not have admin access.",type:"danger"})}catch(p){o({message:p.message,type:"danger"})}finally{f(!1)}},T=()=>{L(d=>!d)};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center",children:e.jsxs(W,{children:[e.jsx(V,{ref:l,size:"invisible",sitekey:D}),e.jsxs(x,{className:"justify-content-center",children:[e.jsxs(r,{md:4,className:"d-flex flex-column align-items-center justify-content-center bg-primary text-white",children:[e.jsx("h2",{children:"Vendor Portal"}),e.jsx("p",{children:"Logistic Management System"}),e.jsx(n,{to:"/supplierslogin",className:"text-white",children:"Supplier Page →"}),e.jsx(n,{to:"/",className:"text-white",children:"Landing Page →"})]}),e.jsx(r,{md:5,children:e.jsx(z,{children:e.jsx(B,{className:"p-4",children:e.jsxs(Y,{children:[m.message&&e.jsx($,{color:m.type,dismissible:!0,children:m.message}),e.jsxs(H,{onSubmit:R(E),children:[e.jsx("h1",{children:"Login"}),e.jsx("p",{className:"text-body-secondary",children:"Sign In to your account"}),e.jsxs(w,{className:"mb-3",children:[e.jsx(N,{children:e.jsx(C,{icon:J})}),e.jsx(b,{ref:c,type:"text",placeholder:"Username",autoComplete:"username",...h("username",{required:"Username is required"})})]}),a.username&&e.jsx("p",{className:"text-danger",children:a.username.message}),e.jsxs(w,{className:"mb-4",children:[e.jsx(N,{children:e.jsx(C,{icon:U})}),e.jsx(b,{type:g?"text":"password",placeholder:"Password",autoComplete:"current-password",...h("password",{required:"Password is required"})}),e.jsx(i,{color:"secondary",variant:"outline",onClick:T,type:"button",children:e.jsx(_,{icon:g?G:q})})]}),a.password&&e.jsx("p",{className:"text-danger",children:a.password.message}),e.jsxs(x,{children:[e.jsx(r,{sm:5,children:e.jsx(i,{color:"success",variant:"outline",className:"px-4",type:"submit",disabled:t,children:t?"Logging in...":"LOGIN"})}),e.jsx(r,{xs:"auto",className:"me-auto",children:e.jsx(n,{to:"/forgotPass",children:e.jsx(i,{color:"danger",variant:"outline",className:"px-4",disabled:t,children:t?"Processing...":"FORGOT PASSWORD"})})})]}),e.jsx(x,{className:"mt-3",children:e.jsx(r,{xs:12,className:"text-center",children:e.jsx(n,{to:"/register",children:e.jsx(i,{color:"link",className:"px-0",children:"Register Now!"})})})})]})]})})})})]})]})})};export{de as default};
