import{u as $,r as l,R as e,C as B}from"./index-T5XWHBzK.js";import{a as D,b as V,c}from"./CRow-Dc32PVYS.js";import{C as j,a as z}from"./CCardBody-Bw6ZitW4.js";import{g as M,h as L,j as E,k as s,l as H,m as o,c as F,d as O,n as G,e as I,f as q}from"./CTable-Bu3CExYn.js";import"./CCloseButton-ZDYmxsSm.js";const J="https://backend-log2.axleshift.com/api/v1/vendor",k="https://backend-log2.axleshift.com/api/v1/auth",Z=()=>{var h,v,P,b,w,y;const{accessToken:a}=$(),[f,m]=l.useState([]),[N,T]=l.useState(!0),[_,u]=l.useState(!1),[r,A]=l.useState(null),[C,i]=l.useState(null);l.useEffect(()=>{if(!a)return;(async()=>{try{const n=await fetch(`${J}/with-users`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`}});if(!n.ok)throw new Error(`HTTP error! Status: ${n.status}`);const d=await n.json();m(d.vendors)}catch(n){console.error("Error fetching vendors:",n),m([])}finally{T(!1)}})()},[a]);const g=(t,n)=>{m(d=>d.map(p=>p._id===t?{...p,status:n}:p))},S=async t=>{if(a){i(t);try{const n=await fetch(`${k}/approve/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`}});n.ok?g(t,"Approved"):console.error("Error approving user",n.statusText)}catch(n){console.error("Error approving user:",n)}finally{i(null)}}},x=async t=>{if(a){i(t);try{const n=await fetch(`${k}/cancel-approval/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`}});n.ok?g(t,"Pending"):console.error("Error canceling approval:",n.statusText)}catch(n){console.error("Error canceling approval:",n)}finally{i(null)}}},R=t=>{A(t),u(!0)},U=t=>{switch(t){case"Approved":return"success";case"Pending":return"warning";default:return"secondary"}};return e.createElement(e.Fragment,null,e.createElement(D,null,e.createElement(V,{xs:"12"},e.createElement(j,{className:"shadow-lg"},e.createElement(z,null,N?e.createElement("div",{className:"d-flex justify-content-center"},e.createElement(B,{color:"primary"})):e.createElement(M,{striped:!0,bordered:!0,hover:!0,responsive:!0},e.createElement(L,{className:"bg-light"},e.createElement(E,null,e.createElement(s,null,"User ID"),e.createElement(s,null,"Email"),e.createElement(s,null,"Status"),e.createElement(s,null,"Role"),e.createElement(s,null,"Actions"))),e.createElement(H,null,f.length>0?f.map(t=>e.createElement(E,{key:t._id,className:"text-center"},e.createElement(o,null,t._id),e.createElement(o,null,t.email),e.createElement(o,null,e.createElement(c,{color:U(t.status),className:"mr-2"},t.status)),e.createElement(o,null,t.role),e.createElement(o,null,e.createElement(c,{color:"info",onClick:()=>R(t),className:"mr-2"},"View Details"),t.status==="Approved"?e.createElement(c,{color:"warning",onClick:()=>x(t._id),className:"ml-2",disabled:C===t._id},"Cancel Approval"):e.createElement(c,{color:"success",onClick:()=>S(t._id),className:"ml-2",disabled:C===t._id},"Approve")))):e.createElement(E,null,e.createElement(o,{colSpan:"5",className:"text-center"},"No vendors found.")))))))),e.createElement(F,{visible:_,onClose:()=>u(!1)},e.createElement(O,{closeButton:!0,className:"bg-dark text-white"},e.createElement(G,null,"Vendor Profile")),e.createElement(I,{className:"bg-dark text-white"},r&&e.createElement("div",{className:"p-2"},e.createElement("p",null,e.createElement("strong",null,"User ID:")," ",r._id),e.createElement("p",null,e.createElement("strong",null,"Email:")," ",r.email),e.createElement("p",null,e.createElement("strong",null,"Status:")," ",r.status),e.createElement("p",null,e.createElement("strong",null,"Role:")," ",r.role),r.vendorProfile?e.createElement(e.Fragment,null,e.createElement("p",null,e.createElement("strong",null,"Business Name:")," ",r.vendorProfile.businessName),e.createElement("p",null,e.createElement("strong",null,"Contact Number:")," ",r.vendorProfile.contactNumber),((h=r.vendorProfile.documents)==null?void 0:h.businessRegistrationCertificate)&&e.createElement("p",null,e.createElement("strong",null,"Business Registration Certificate:"),e.createElement("a",{href:r.vendorProfile.documents.businessRegistrationCertificate,target:"_blank",rel:"noopener noreferrer"},"Preview")),((v=r.vendorProfile.documents)==null?void 0:v.companyProfile)&&e.createElement("p",null,e.createElement("strong",null,"Company Profile:"),e.createElement("a",{href:r.vendorProfile.documents.companyProfile,target:"_blank",rel:"noopener noreferrer"},"Preview")),((P=r.vendorProfile.documents)==null?void 0:P.isoCertification)&&e.createElement("p",null,e.createElement("strong",null,"ISO Certification:"),e.createElement("a",{href:r.vendorProfile.documents.isoCertification,target:"_blank",rel:"noopener noreferrer"},"Preview")),((b=r.vendorProfile.documents)==null?void 0:b.authorizationCertificate)&&e.createElement("p",null,e.createElement("strong",null,"Authorization Certificate:"),e.createElement("a",{href:r.vendorProfile.documents.authorizationCertificate,target:"_blank",rel:"noopener noreferrer"},"Preview")),((w=r.vendorProfile.documents)==null?void 0:w.complianceDeclaration)&&e.createElement("p",null,e.createElement("strong",null,"Compliance Declaration:"),e.createElement("a",{href:r.vendorProfile.documents.complianceDeclaration,target:"_blank",rel:"noopener noreferrer"},"Preview")),((y=r.vendorProfile.documents)==null?void 0:y.productCatalog)&&e.createElement("p",null,e.createElement("strong",null,"Product Catalog:"),e.createElement("a",{href:r.vendorProfile.documents.productCatalog,target:"_blank",rel:"noopener noreferrer"},"Preview"))):e.createElement("p",{className:"text-muted"},"No vendor profile attached."))),e.createElement(q,{className:"bg-dark"},e.createElement(c,{color:"secondary",onClick:()=>u(!1)},"Close"))))};export{Z as default};
