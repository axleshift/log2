import{l as F,u as U,r as t,R as e,L as d,v as w}from"./index-CaeG1fis.js";import{u as V,c as _}from"./index.esm-C0MtmeA8.js";import{C as x}from"./index.esm-XKXMJivp.js";import{F as G,o as j,p as q}from"./index-BDvmDYZ7.js";import{R as D,V as W}from"./config-BlBFnvC1.js";import{d as z,a as f,b as a,c as n}from"./CRow-0bSjJRSx.js";import{C as B}from"./CCardGroup-DabBTKuI.js";import{C as $,a as H}from"./CCardBody-5iJwjPps.js";import{C as J}from"./CAlert-COI-S0A-.js";import{C as K}from"./CForm-CH4J0Y6z.js";import{C as S,a as N}from"./CInputGroupText-CU9A1EYT.js";import{c as M}from"./cil-user-Ddrdy7PS.js";import{a as R}from"./CFormInput-YJIkf5sQ.js";import"./hoist-non-react-statics.cjs-DNf2rn-d.js";import"./CCloseButton-oKv6rBAu.js";const ue=()=>{const b="https://backend-log2.axleshift.com/api/v1/auth",{register:E,handleSubmit:k,formState:{errors:r},reset:L}=V(),v=F(),{login:T}=U(),o=t.useRef(null),c=t.useRef(null),[m,g]=t.useState(!1),[l,s]=t.useState({message:"",type:""}),[i,P]=t.useState(!1);t.useEffect(()=>{o.current&&o.current.focus()},[]);const A=async I=>{g(!0),s({message:"",type:""});try{const u=await c.current.executeAsync();c.current.reset();const y=await fetch(`${b}/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...I,recaptcha_ref:u})}),C=await y.json();if(!y.ok)throw new Error(C.message||"Login failed");const{accessToken:h,refreshToken:O,user:p}=C;T(p,h),w.set("token",h,{expires:1,secure:!0,sameSite:"Strict"}),w.set("refreshToken",O,{expires:30,secure:!0,sameSite:"Strict"}),s({message:"Welcome back! Redirecting...",type:"success"}),L(),p.role==="vendor"||p.role==="super admin"?v("/dashboard"):s({message:"Unauthorized. Access denied.",type:"danger"})}catch(u){s({message:u.message,type:"danger"})}finally{g(!1)}};return e.createElement("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row align-items-center"},e.createElement(z,null,e.createElement(D,{ref:c,size:"invisible",sitekey:W}),e.createElement(f,{className:"justify-content-center"},e.createElement(a,{md:4,className:"d-flex flex-column align-items-center justify-content-center bg-primary text-white"},e.createElement("h2",null,"VENDOR PORTAL"),e.createElement("p",null,"Logistic Management System"),e.createElement(d,{to:"/login",className:"text-white"},"Login Portal â†’")),e.createElement(a,{md:5},e.createElement(B,null,e.createElement($,{className:"p-4"},e.createElement(H,null,l.message&&e.createElement(J,{color:l.type},l.message),e.createElement(K,{onSubmit:k(A)},e.createElement("h1",null,"Vendor Login"),e.createElement("p",{className:"text-body-secondary"},"Sign in to your vendor account"),e.createElement(S,{className:"mb-3"},e.createElement(N,null,e.createElement(x,{icon:M})),e.createElement(R,{ref:o,type:"text",placeholder:"Username",autoComplete:"username",...E("username",{required:"Username is required"})})),r.username&&e.createElement("p",{className:"text-danger"},r.username.message),e.createElement(S,{className:"mb-4"},e.createElement(N,null,e.createElement(x,{icon:_})),e.createElement(R,{type:i?"text":"password",placeholder:"Password",autoComplete:"current-password",...E("password",{required:"Password is required"})}),e.createElement(n,{color:"secondary",variant:"outline",onClick:()=>P(!i)},e.createElement(G,{icon:i?j:q}))),r.password&&e.createElement("p",{className:"text-danger"},r.password.message),e.createElement(f,null,e.createElement(a,{sm:5},e.createElement(n,{color:"success",variant:"outline",type:"submit",disabled:m},m?"Logging in...":"LOGIN")),e.createElement(a,{xs:"auto",className:"me-auto"},e.createElement(d,{to:"/forgotPass"},e.createElement(n,{color:"danger",variant:"outline",disabled:m},"FORGOT PASSWORD")))),e.createElement(f,{className:"mt-3"},e.createElement(a,{xs:12,className:"text-center"},e.createElement(d,{to:"/VendorRegister"},e.createElement(n,{color:"link"},"Register Now!"))))))))))))};export{ue as default};
