import{R as e,P as n,k,r as o}from"./index-DQP8N3_v.js";import{C as w,a as _,b as x,c as $}from"./CModalHeader-Dvi2NdUX.js";import{C as B}from"./CModalTitle-BsPjcxN8.js";import{b as p}from"./CContainer-B5X986nK.js";import{C as M,a as D}from"./CRow-DRxYPhhI.js";import{C as P,a as q}from"./CCardBody-DhxhUCKr.js";import{C as L,a as j,b as g,c as i,d as F,e as c}from"./CTable-BMBWZ6R4.js";import"./CCloseButton-B0Lgjfr_.js";import"./CNavItem-BP7P-adU.js";const A=({visible:r,onClose:s,user:l})=>{var m;return console.log(l),e.createElement(w,{visible:r,onClose:s},e.createElement(_,{onClose:s},e.createElement(B,null,"User Details")),e.createElement(x,null,l?e.createElement("div",null,e.createElement("p",null,e.createElement("strong",null,"User ID:")," ",l._id),e.createElement("p",null,e.createElement("strong",null,"Name:")," ",l.name||"N/A"),e.createElement("p",null,e.createElement("strong",null,"Email:")," ",l.email),e.createElement("p",null,e.createElement("strong",null,"Status:")," ",l.status),l.role==="vendor"&&l.details?e.createElement(e.Fragment,null,e.createElement("p",null,e.createElement("strong",null,"Business Name:")," ",l.details.businessName||"N/A"),e.createElement("p",null,e.createElement("strong",null,"Full Name:")," ",l.details.fullName||"N/A"),e.createElement("p",null,e.createElement("strong",null,"Business Address:")," ",l.details.businessAddress||"N/A"),e.createElement("p",null,e.createElement("strong",null,"Contact Number:")," ",l.details.contactNumber||"N/A"),e.createElement("p",null,e.createElement("strong",null,"Tax ID:")," ",l.details.taxId||"N/A"),e.createElement("p",null,e.createElement("strong",null,"Certifications:")," ",((m=l.details.certifications)==null?void 0:m.join(", "))||"N/A")):e.createElement("p",null,"No vendor details available.")):e.createElement("div",null,"Loading details...")),e.createElement($,null,e.createElement(p,{color:"secondary",onClick:s},"Close")))};A.propTypes={visible:n.bool.isRequired,onClose:n.func.isRequired,user:n.shape({_id:n.string.isRequired,name:n.string,email:n.string.isRequired,status:n.string.isRequired,role:n.string.isRequired,details:n.shape({businessName:n.string,fullName:n.string,businessAddress:n.string,contactNumber:n.string,taxId:n.string,certifications:n.arrayOf(n.string)})})};const f="https://backend-log2.axleshift.com/api/v1/auth",W=()=>{const{accessToken:r}=k(),[s,l]=o.useState([]),[m,N]=o.useState(!0),[v,C]=o.useState(!1),[y,T]=o.useState(null),[h,u]=o.useState(null);o.useEffect(()=>{if(!r)return;(async()=>{try{const a=await fetch(`${f}/users`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}});if(!a.ok)throw new Error(`HTTP error! Status: ${a.status}`);const d=await a.json();l(Array.isArray(d.users)?d.users:[])}catch(a){console.error("Error fetching users:",a),l([])}finally{N(!1)}})()},[r]);const b=(t,a)=>{l(d=>d.map(E=>E._id===t?{...E,status:a}:E))},U=async t=>{if(r){u(t);try{const a=await fetch(`${f}/approve/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}});a.ok?b(t,"Approved"):console.error("Error approving user",a.statusText)}catch(a){console.error("Error approving user:",a)}finally{u(null)}}},R=async t=>{if(r){u(t);try{const a=await fetch(`${f}/cancel-approval/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`}});a.ok?b(t,"Pending"):console.error("Error canceling approval:",a.statusText)}catch(a){console.error("Error canceling approval:",a)}finally{u(null)}}},S=t=>{T(t),C(!0)};return e.createElement(e.Fragment,null,e.createElement(M,null,e.createElement(D,{xs:"12"},e.createElement(P,null,e.createElement(q,null,e.createElement("h4",null,"User Management"),m?e.createElement("div",null,"Loading..."):e.createElement(L,{striped:!0,bordered:!0,hover:!0,responsive:!0},e.createElement(j,null,e.createElement(g,null,e.createElement(i,null,"User ID"),e.createElement(i,null,"Name"),e.createElement(i,null,"Email"),e.createElement(i,null,"Status"),e.createElement(i,null,"Actions"))),e.createElement(F,null,s.length>0?s.map(t=>e.createElement(g,{key:t._id},e.createElement(c,null,t._id),e.createElement(c,null,(t==null?void 0:t.name)||"N/A"),e.createElement(c,null,t.email),e.createElement(c,null,t.status),e.createElement(c,null,e.createElement(p,{color:"info",onClick:()=>S(t)},"View Details"),t.status==="Approved"?e.createElement(p,{color:"warning",onClick:()=>R(t._id),className:"ml-2",disabled:h===t._id},"Cancel Approval"):e.createElement(p,{color:"success",onClick:()=>U(t._id),className:"ml-2",disabled:h===t._id},"Approve")))):e.createElement(g,null,e.createElement(c,{colSpan:"5",className:"text-center"},"No users found.")))))))),e.createElement(A,{visible:v,onClose:()=>C(!1),user:y}))};export{W as default};
