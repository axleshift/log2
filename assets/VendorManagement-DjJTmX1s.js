import{u as k,r as o,R as e,C as D}from"./index-BuyPBthV.js";import{a as B,b as V,c as d}from"./CRow-DtAWSn5d.js";import{C as j,a as R}from"./CCardBody-DIlEFv7M.js";import{g as M,h as P,j as f,k as i,l as L,m as c,c as z,d as H,n as F,e as O,f as I}from"./CTable-JDSNWlXE.js";import{C as G}from"./DefaultLayout-CV3HAylT.js";import"./CCloseButton-CxYk9sGR.js";import"./index-xsH4HHeE.js";import"./CFormInput-CSoJADs1.js";import"./CFormTextarea-DPO3OWN6.js";import"./CFormSelect-QU3Ik6FC.js";import"./CForm-Dno9JkwL.js";import"./index.esm-DJigi3oJ.js";import"./CCardHeader-2ZxsisFQ.js";import"./CAlert-84ht7EJA.js";import"./cil-user-Ddrdy7PS.js";import"./index-LnCWbWn0.js";const h="https://backend-log2.axleshift.com/api/v1/auth",Z="https://backend-log2.axleshift.com/api/v1/vendor",me=()=>{const{accessToken:n}=k(),[C,E]=o.useState([]),[b,y]=o.useState(!0),[N,u]=o.useState(!1),[r,T]=o.useState(null),[l,A]=o.useState(null),[g,p]=o.useState(null);o.useEffect(()=>{if(!n)return;(async()=>{try{const a=await fetch(`${h}/users`,{method:"GET",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}});if(!a.ok)throw new Error(`HTTP error! Status: ${a.status}`);const m=(await a.json()).users.filter(_=>_.role==="vendor");E(m)}catch(a){console.error("Error fetching users:",a),E([])}finally{y(!1)}})()},[n]);const w=async t=>{try{const a=await fetch(`${Z}/user/${t}`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}});if(a.ok){const s=await a.json();A(s)}else console.error("Error fetching vendor details:",a.statusText)}catch(a){console.error("Error fetching vendor details:",a)}},v=(t,a)=>{E(s=>s.map(m=>m._id===t?{...m,status:a}:m))},S=async t=>{if(n){p(t);try{const a=await fetch(`${h}/approve/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}});a.ok?v(t,"Approved"):console.error("Error approving user",a.statusText)}catch(a){console.error("Error approving user:",a)}finally{p(null)}}},$=async t=>{if(n){p(t);try{const a=await fetch(`${h}/cancel-approval/${t}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n}`}});a.ok?v(t,"Pending"):console.error("Error canceling approval:",a.statusText)}catch(a){console.error("Error canceling approval:",a)}finally{p(null)}}},x=t=>{T(t),w(t._id),u(!0)},U=t=>{switch(t){case"Approved":return"success";case"Pending":return"warning";default:return"secondary"}};return e.createElement(e.Fragment,null,e.createElement(B,null,e.createElement(V,{xs:"12"},e.createElement(j,{className:"shadow-lg"},e.createElement(R,null,e.createElement("h4",{className:"text-primary"},"Vendor Management"),b?e.createElement("div",{className:"d-flex justify-content-center"},e.createElement(D,{color:"primary"})):e.createElement(M,{striped:!0,bordered:!0,hover:!0,responsive:!0},e.createElement(P,{className:"bg-transparent"},e.createElement(f,null,e.createElement(i,null,"User ID"),e.createElement(i,null,"Email"),e.createElement(i,null,"Status"),e.createElement(i,null,"Role"),e.createElement(i,null,"Actions"))),e.createElement(L,null,C.length>0?C.map(t=>e.createElement(f,{key:t._id,className:"text-center"},e.createElement(c,null,t._id),e.createElement(c,null,t.email),e.createElement(c,null,e.createElement(G,{color:U(t.status)},t.status)),e.createElement(c,null,t.role),e.createElement(c,null,e.createElement(d,{color:"info",onClick:()=>x(t),className:"mr-2"},"View Details"),t.status==="Approved"?e.createElement(d,{color:"warning",onClick:()=>$(t._id),className:"ml-2",disabled:g===t._id},"Cancel Approval"):e.createElement(d,{color:"success",onClick:()=>S(t._id),className:"ml-2",disabled:g===t._id},"Approve")))):e.createElement(f,null,e.createElement(c,{colSpan:"5",className:"text-center"},"No vendors found.")))))))),e.createElement(z,{visible:N,onClose:()=>u(!1)},e.createElement(H,{onClose:()=>u(!1)},e.createElement(F,null,"User Details")),e.createElement(O,null,r&&l&&e.createElement("div",null,e.createElement("p",null,e.createElement("strong",null,"User ID:")," ",r._id),e.createElement("p",null,e.createElement("strong",null,"Username:")," ",(r==null?void 0:r.username)||"N/A"),e.createElement("p",null,e.createElement("strong",null,"Email:")," ",r.email),e.createElement("p",null,e.createElement("strong",null,"Status:")," ",r.status),e.createElement("p",null,e.createElement("strong",null,"Role:")," ",r.role),e.createElement("h5",{className:"mt-3"},"Vendor Profile"),e.createElement("p",null,e.createElement("strong",null,"Business Name:")," ",l.businessName),e.createElement("p",null,e.createElement("strong",null,"Full Name:")," ",l.fullName),e.createElement("p",null,e.createElement("strong",null,"Business Address:")," ",l.businessAddress),e.createElement("p",null,e.createElement("strong",null,"Contact Number:")," ",l.contactNumber),e.createElement("p",null,e.createElement("strong",null,"Tax ID:")," ",l.taxId),e.createElement("h5",{className:"mt-3"},"Documents"),l.documents&&Object.values(l.documents).some(t=>t)?e.createElement("ul",null,Object.entries(l.documents).map(([t,a])=>a?e.createElement("li",{key:t},e.createElement("a",{href:a,target:"_blank",rel:"noopener noreferrer"},t.replace(/([A-Z])/g," $1").replace(/^./,s=>s.toUpperCase()))):null)):e.createElement("p",null,"No uploaded documents."))),e.createElement(I,null,e.createElement(d,{color:"secondary",onClick:()=>u(!1)},"Close"))))};export{me as default};
